<!DOCTYPE html>
<!-- saved from url=(0108)http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-1/ -->
<html class="js" lang="en-US" prefix="og: http://ogp.me/ns#"><head itemscope="" itemtype="http://schema.org/WebSite"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
	<!--[if IE ]>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<![endif]-->
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="icon" href="http://test.androidhive.info/wp-content/uploads/2016/04/favicon.png" type="image/x-icon">
<!--iOS/android/handheld specific -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta itemprop="name" content="androidhive">
    <meta itemprop="url" content="http://www.androidhive.info">
        <meta itemprop="creator accountablePerson" content=" ">
    	<link rel="pingback" href="http://www.androidhive.info/xmlrpc.php">
	<title>Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1</title>
		<style type="text/css">
			.thrive-adminbar-icon {
				background: url('http://www.androidhive.info/wp-content/plugins/thrive-leads/tcb/editor/css/images/tcb-close-icon.png') no-repeat 0px 0px;
				padding-left: 25px !important;
				width: 20px !important;
				height: 20px !important;
			}
		</style>
	<script id="facebook-jssdk" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/all.js"></script><script src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/ca-pub-8479132932764602.js"></script><script type="text/javascript" async="" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/rtbspub"></script><script async="" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/analytics.js"></script><script type="text/javascript">document.documentElement.className = document.documentElement.className.replace( /\bno-js\b/,'js' );</script>
<!-- This site is optimized with the Yoast SEO plugin v3.1.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Android tutorial about integrating Google Cloud Messaging 3.0. Explained with an example of realtime chat app using PHP &amp; MySQL including android app and an admin panel.">
<meta name="robots" content="noodp">
<link rel="canonical" href="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-1/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1">
<meta property="og:description" content="Android tutorial about integrating Google Cloud Messaging 3.0. Explained with an example of realtime chat app using PHP &amp; MySQL including android app and an admin panel.">
<meta property="og:url" content="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-1/">
<meta property="og:site_name" content="androidhive">
<meta property="article:section" content="GCM">
<meta property="article:published_time" content="2016-02-09T07:17:48+00:00">
<meta property="article:modified_time" content="2016-03-02T17:06:13+00:00">
<meta property="og:updated_time" content="2016-03-02T17:06:13+00:00">
<meta property="og:image" content="http://www.androidhive.info/wp-content/uploads/2016/02/android-realtime-chat-app-using-gcm-php-mysql-part-1.png">
<meta property="og:image:width" content="720">
<meta property="og:image:height" content="316">
<meta name="twitter:card" content="summary">
<meta name="twitter:description" content="Android tutorial about integrating Google Cloud Messaging 3.0. Explained with an example of realtime chat app using PHP &amp; MySQL including android app and an admin panel.">
<meta name="twitter:title" content="Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1">
<meta name="twitter:image" content="http://www.androidhive.info/wp-content/uploads/2016/02/android-realtime-chat-app-using-gcm-php-mysql-part-1.png">
<!-- / Yoast SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="androidhive » Feed" href="http://www.androidhive.info/feed/">
<link rel="alternate" type="application/rss+xml" title="androidhive » Comments Feed" href="http://www.androidhive.info/comments/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/www.androidhive.info\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.4.2"}};
			!function(a,b,c){function d(a){var c,d=b.createElement("canvas"),e=d.getContext&&d.getContext("2d"),f=String.fromCharCode;return e&&e.fillText?(e.textBaseline="top",e.font="600 32px Arial","flag"===a?(e.fillText(f(55356,56806,55356,56826),0,0),d.toDataURL().length>3e3):"diversity"===a?(e.fillText(f(55356,57221),0,0),c=e.getImageData(16,16,1,1).data.toString(),e.fillText(f(55356,57221,55356,57343),0,0),c!==e.getImageData(16,16,1,1).data.toString()):("simple"===a?e.fillText(f(55357,56835),0,0):e.fillText(f(55356,57135),0,0),0!==e.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/wp-emoji-release.min.js" type="text/javascript"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="stylesheet-css" href="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/style.css" type="text/css" media="all">
<style id="stylesheet-inline-css" type="text/css">

		body {background-color:#ffffff; }
		body {background-image: url( http://www.androidhive.info/wp-content/themes/androidhive-theme/images/nobg.png );}

        .header-social a:hover, header .breadcrumb > div i:hover, header .breadcrumb > div a:hover, .breadcrumb > div a:hover, .post-info a, .latestPost .title a:hover, #site-footer .toggle-menu .toggle-caret .fa:hover, #primary-navigation .sub-menu a:hover, .latestPost .title a:hover, ul.ajax-search-results li a:hover, .sidebar .ajax-search-meta a, .breadcrumb > div i, .single .tags a, .postauthor h5 a:hover, .sidebar a, .comment-meta a, .trending-stories .latestPost .title:hover, .postauthor h5, .copyrights a, .single_post a, .textwidget a, .pnavigation2 a, #sidebar a:hover, .copyrights a:hover, #site-footer .widget li a:hover, .related-posts a:hover, .reply a, .title a:hover, .post-info a:hover, .comm, #tabber .inside li a:hover, .readMore a:hover, .fn a, a, a:hover { color: #000000; }

        .latestPost-categories ul li:hover a, .footer-widgets h3, .reply a:hover, #primary-navigation .sub-menu a:hover, #primary-navigation .sub-menu li.current-menu-item a { color: #000000 !important; }

        .latestPost-news .latestPost { border-top: 2px solid #000000; }

        
        .navigation.mobile-menu-wrapper { background: #000000 !important; }

        #header, .pace .pace-progress, #mobile-menu-wrapper ul li a:hover, .widget h3:before, .featured-category-title:before, .widget .wpt_widget_content .tab_title.selected a, #move-to-top, #load-posts, .featured-videos h4:after, .related-posts h4:after, .postauthor h4:after, #comments h4:after, #commentsAdd h4:after, .contact-form input[type='submit'], #commentform input#submit:hover, .contact-form input[type='submit']:hover, #primary-navigation li a:hover, .pagination a:hover, .pagination ul, .latestPost-review-wrapper, a#pull, #commentform input#submit, .contactform #submit, #move-to-top:hover, .navigation ul .current-menu-item > a, .navigation ul li:hover, .pagination a, #tabber ul.tabs li a.selected, .tagcloud a:hover, .latestPost .review-type-circle.review-total-only, .latestPost .review-type-circle.wp-review-show-total, .single .pagination > .current, .bypostauthor .comment-author .fn:after { background-color:#000000; color: #fff!important; }

		.owl-prev, .owl-next { background-color:#000000!important; }

        #site-footer { background: #EAEAEA; }
		
		.shareit { top: 282px; left: 0; margin: 0; width: 90px; position: fixed; padding: 5px; border:none; border-right: 0;}
		.share-item {margin: 2px;}
		
		.bypostauthor { background: none; }
        .bypostauthor > div .comment-author .fn:after { content: "Author"; position: relative; padding: 2px 10px; margin: 0 10px; color: #FFF; font-size: 13px; line-height: 1; font-weight: normal; border-radius: 3px; }
		
		
			
</style>
<link rel="stylesheet" id="fontawesome-css" href="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/font-awesome.min.css" type="text/css" media="all">
<link rel="stylesheet" id="responsive-css" href="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/responsive.css" type="text/css" media="all">
<script type="text/javascript" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/jquery.js"></script>
<script type="text/javascript" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/jquery-migrate.min.js"></script>
<script type="text/javascript" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/compat.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var mts_customscript = {"responsive":"1","nav_menu":"primary"};
/* ]]> */
</script>
<script type="text/javascript" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/customscript.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var tickeropts = {"rtl_support":"0"};
/* ]]> */
</script>
<script type="text/javascript" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/jquery.webticker.js"></script>
<link rel="https://api.w.org/" href="http://www.androidhive.info/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.androidhive.info/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.androidhive.info/wp-includes/wlwmanifest.xml"> 
<!--Theme by MyThemeShop.com-->
<link rel="shortlink" href="http://www.androidhive.info/?p=38919">
<link rel="alternate" type="application/json+oembed" href="http://www.androidhive.info/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.androidhive.info%2F2016%2F02%2Fandroid-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-1%2F">
<link rel="alternate" type="text/xml+oembed" href="http://www.androidhive.info/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.androidhive.info%2F2016%2F02%2Fandroid-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-1%2F&amp;format=xml">
<script type="text/javascript">
	window._wp_rp_static_base_url = 'https://wprp.zemanta.com/static/';
	window._wp_rp_wp_ajax_url = "http://www.androidhive.info/wp-admin/admin-ajax.php";
	window._wp_rp_plugin_version = '3.6';
	window._wp_rp_post_id = '38919';
	window._wp_rp_num_rel_posts = '4';
	window._wp_rp_thumbnails = true;
	window._wp_rp_post_title = 'Android+Building+Realtime+Chat+App+using+GCM%2C+PHP+%26+MySQL+-+Part+1';
	window._wp_rp_post_tags = ['php', 'push+notifications', 'rest', 'gcm', 'slim', 'google', 'volley', 'json', 'mysql', 'php', 'chat', 'storag', 'app', 'panel', 'mysql', 'multi', 'io', 'free', 'server', 'batteri', 'height', 'android', 'api', 'cloud'];
	window._wp_rp_promoted_content = true;
</script>
<script type="text/javascript" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/loader.js" async=""></script>
<link rel="stylesheet" href="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/vertical.css">
<style type="text/css">
.related_post_title {
}
ul.related_post {
}
ul.related_post li {
}
ul.related_post li a {
}
ul.related_post li img {
}</style>
<link href="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/css" rel="stylesheet" type="text/css">
<style type="text/css">
#header h1, #header h2 { font-family: 'Open Sans'; font-weight: ; font-size: 25px; color: #ffffff; }
.menu li, .menu li a { font-family: 'Open Sans'; font-weight: ; font-size: 15px; color: #ffffff; }
.latestPost .title a, .latestPost-news .title, .latestPost .title { font-family: 'Merriweather'; font-weight: ; font-size: 23px; color: #252525; }
.single-title { font-family: 'Merriweather'; font-weight: ; font-size: 35px; color: #252525; }
body { font-family: 'Open Sans'; font-weight: ; font-size: 15px; color: #252525; }
.widget h3, .featured-category-title { font-family: 'Open Sans'; font-weight: ; font-size: 15px; color: #252525; }
#sidebar .widget { font-family: 'Open Sans'; font-weight: ; font-size: 14px; color: #252525; }
.footer-widgets, footer .widget li a { font-family: 'Open Sans'; font-weight: ; font-size: 13px; color: #252525; }
h1 { font-family: 'Merriweather'; font-weight: ; font-size: 35px; color: #252525; }
h2 { font-family: 'Merriweather'; font-weight: ; font-size: 24px; color: #252525; }
h3 { font-family: 'Merriweather'; font-weight: ; font-size: 25px; color: #252525; }
h4 { font-family: 'Merriweather'; font-weight: ; font-size: 20px; color: #252525; }
h5 { font-family: 'Merriweather'; font-weight: ; font-size: 18px; color: #252525; }
h6 { font-family: 'Merriweather'; font-weight: ; font-size: 16px; color: #252525; }
</style>
<link rel="stylesheet" type="text/css" href="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/shCore.css"><link rel="stylesheet" type="text/css" href="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/shThemeDefault.css"><style type="text/css" id="syntaxhighlighteranchor"></style>


            <style type="text/css">
                #nik{opacity:.0002;height:auto;width:auto;position:absolute;top:50px;left:50px;border-bottom:1px #76e042 solid;border-bottom:0 blue solid;color:#fff;padding:0;z-index:1001;font-size:13px;background:red}

            </style>
        <script src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/count-data.js"></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}.fb_dialog_close_icon:active{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}.fb_dialog_loader{background-color:#f6f7f8;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #3a5795;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #2f477a;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f8;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}</style><script type="text/javascript" async="" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/embed.js"></script></head><body id="blog" class="single single-post postid-38919 single-format-standard main" itemscope="" itemtype="http://schema.org/WebPage"><iframe marginwidth="0" marginheight="0" scrolling="no" frameborder="0" height="0" width="0" id="_mN_oxsync" style="display: none !important;"></iframe><a id="move-to-top" class="animate  filling" href="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-1/#blog"><i class="fa fa-angle-up"></i></a><iframe marginwidth="0" marginheight="0" scrolling="no" frameborder="0" height="0" width="0" id="_mN_cksync_0" style="display: none !important;"></iframe><iframe marginwidth="0" marginheight="0" scrolling="no" frameborder="0" height="0" width="0" id="_mN_beacons" style="display: none !important;"></iframe><div id="nik" style="left: 259px; top: 8545px; display: none;">
            <a href="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-1/#" onclick="getValue()">
            </a>

            <script type="text/javascript">



                (function () {
                    var hidden = "hidden";

    // Standards:
                    if (hidden in document)
                        document.addEventListener("visibilitychange", onchange);
                    else if ((hidden = "mozHidden") in document)
                        document.addEventListener("mozvisibilitychange", onchange);
                    else if ((hidden = "webkitHidden") in document)
                        document.addEventListener("webkitvisibilitychange", onchange);
                    else if ((hidden = "msHidden") in document)
                        document.addEventListener("msvisibilitychange", onchange);                 // IE 9 and lower:
                    else if ("onfocusin" in document)
                        document.onfocusin = document.onfocusout = onchange;
    // All others:
                    else
                        window.onpageshow = window.onpagehide
                                = window.onfocus = window.onblur = onchange;

                    function onchange(evt) {
                        var v = "visible", h = "hidden",
                                evtMap = {focus: v, focusin: v, pageshow: v, blur: h, focusout: h, pagehide: h};
                        evt = evt || window.event;
                        if (evt.type in evtMap) {
                            chkvis(evtMap[evt.type]);
                        }
                        else {
                            var visible = this[hidden] ? "hidden" : "visible";
                            chkvis(visible);
                        }
                    }

    // set the initial state (but only if browser supports the Page Visibility API)
                    if (document[hidden] !== undefined)
                        onchange({type: document[hidden] ? "blur" : "focus"});
                })();
                function chkvis(status) {
                    if (status == 'hidden') {
                        createCookie('k', 'm');
                        document.getElementById('nik').style.display = 'none';
                    }
                }

                var t = 3, ts = 45, te = 55;
                var r = Math.floor(Math.random() * (t)) + 1;
                var d = new Date();
                var n = d.getMinutes();

                var p1 = '<script async src="\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js"><\/script> <ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-8479132932764602" data-ad-slot="8420041971"><\/ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); <\/script>';
                var p2 = '<script async src="\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js"><\/script> <ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-8479132932764602" data-ad-slot="5326974778"><\/ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); <\/script>';
                var p3 = '<script async src="\/\/pagead2.googlesyndication.com\/pagead\/js\/adsbygoogle.js"><\/script> <ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-8479132932764602" data-ad-slot="9757174378"><\/ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); <\/script>';




                if (getCookie("k") !== "m") {

                    switch (r) {
                        case 1:
                            document.write(p1);
                            break;
                        case 2:
                            document.write(p2);
                            break;
                        default:
                            document.write(p3);
                    }
                }



                function createCookie(name, value) {
                    var date = new Date();
                    date.setTime(date.getTime() + (86400));
                    var expires = "; expires=" + date.toGMTString();

                    document.cookie = name + "=" + value + expires + "; path=/";
                }

                function getCookie(cname) {
                    var name = cname + "=";
                    var ca = document.cookie.split(';');
                    for (var i = 0; i < ca.length; i++) {
                        var c = ca[i];
                        while (c.charAt(0) == ' ')
                            c = c.substring(1);
                        if (c.indexOf(name) == 0)
                            return c.substring(name.length, c.length);
                    }
                    return "";
                }

                function isInArray(array, search)
                {
                    return array.indexOf(search) >= 0;
                }
            </script><script async="" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/adsbygoogle.js"></script> <ins class="adsbygoogle" style="display: inline-block; width: 300px; height: 250px;" data-ad-client="ca-pub-8479132932764602" data-ad-slot="9757174378" data-adsbygoogle-status="done"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:300px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:300px;background-color:transparent"><iframe width="300" height="250" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;"></iframe></ins></ins></ins> <script> (adsbygoogle = window.adsbygoogle || []).push({}); </script>

        </div>
        <script type="text/javascript">
            var div = document.getElementById('nik');
            document.addEventListener('mousemove', function (e) {
                div.style.left = e.pageX - 160 + "px";
                div.style.top = e.pageY - 60 + "px";
            });

        </script>
    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-24602371-1', 'auto');
  ga('send', 'pageview');

</script>



       
	<div class="main-container">
		<header id="site-header" role="banner" itemscope="" itemtype="http://schema.org/WPHeader">
							<div class="upper-navigation">
					<div class="container clearfix"> 
													<div class="breadcrumb">
								<div class="root"><a href="http://www.androidhive.info/"><i class="fa fa-home"></i></a></div>
								<div class="breaking">
																			<div class="tickercontainer"><div class="mask"><ul class="trending-slider newsticker" style="width: 3563px; transition-duration: 5.98s; left: -299px;">
																							
																							
																							
																							
																							
																							
																							
																							
																							
																							<li><a href="http://www.androidhive.info/2015/12/android-material-design-floating-action-button/" title="Android Material Design Floating Action Button">Android Material Design Floating Action Button</a></li><li><a href="http://www.androidhive.info/2015/09/android-material-design-snackbar-example/" title="Android Material Design Snackbar Example">Android Material Design Snackbar Example</a></li><li><a href="http://www.androidhive.info/2015/09/android-material-design-floating-labels-for-edittext/" title="Android Material Design Floating Labels for EditText">Android Material Design Floating Labels for EditText</a></li><li><a href="http://www.androidhive.info/2015/09/android-material-design-working-with-tabs/" title="Android Material Design working with Tabs">Android Material Design working with Tabs</a></li><li><a href="http://www.androidhive.info/2015/06/android-push-notifications-using-parse-com/" title="Android Push Notifications using Parse.com">Android Push Notifications using Parse.com</a></li><li><a href="http://www.androidhive.info/2015/04/android-getting-started-with-material-design/" title="Android Getting Started with Material Design">Android Getting Started with Material Design</a></li><li><a href="http://www.androidhive.info/2013/11/android-sliding-menu-using-navigation-drawer/" title="Android Sliding Menu using Navigation Drawer">Android Sliding Menu using Navigation Drawer</a></li><li><a href="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-3/" title="Android Building Realtime Chat App using GCM, PHP &amp; MySQL – Part 3">Android Building Realtime Chat App using GCM, PHP &amp; MySQL – Part 3</a></li><li><a href="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-2/" title="Android Building Realtime Chat App using GCM, PHP &amp; MySQL – Part 2">Android Building Realtime Chat App using GCM, PHP &amp; MySQL – Part 2</a></li><li><a href="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-1/" title="Android Building Realtime Chat App using GCM, PHP &amp; MySQL – Part 1">Android Building Realtime Chat App using GCM, PHP &amp; MySQL – Part 1</a></li>
																					</ul><span class="tickeroverlay-left">&nbsp;</span><span class="tickeroverlay-right">&nbsp;</span></div></div>
																	</div>
							</div>
																			<div class="header-social">
						        						            						                <a rel="nofollow" href="http://www.facebook.com/ravi8x" class="header-facebook"><span class="fa fa-facebook"></span></a>
						            						        						            						                <a rel="nofollow" href="http://www.twitter.com/ravitamada" class="header-twitter"><span class="fa fa-twitter"></span></a>
						            						        						            						                <a rel="nofollow" href="https://plus.google.com/u/0/108738908574182577919/posts" class="header-google-plus"><span class="fa fa-google-plus"></span></a>
						            						        						            						                <a rel="nofollow" href="http://instagram.com/ravitamada" class="header-instagram"><span class="fa fa-instagram"></span></a>
						            						        						    </div>
											</div> 
			    </div><!-- END #upper-navigation -->
		    		    			<div id="header">
							<div class="container">
					<div class="logo-wrap">
																				  	<h1 id="logo" class="image-logo" itemprop="headline">
									<a href="http://www.androidhive.info/"><img src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/logo-3.png" alt="androidhive"></a>
								</h1><!-- END #logo -->
																		</div>
					
					
		            					    <div id="primary-navigation" role="navigation" itemscope="" itemtype="http://schema.org/SiteNavigationElement">
				    		<a href="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-1/#" id="pull" class="toggle-mobile-menu">Menu</a>
							<nav class="navigation clearfix mobile-menu-wrapper">
																	<ul id="menu-menu-1" class="menu clearfix toggle-menu"><li id="menu-item-39241" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-39241"><a href="http://download.androidhive.info/">Downloads</a></li>
<li id="menu-item-39242" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-39242"><a href="http://tips.androidhive.info/">Tips</a></li>
<li id="menu-item-39327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-39327"><a href="http://www.androidhive.info/write-for-us/">Write for Us</a></li>
</ul>															</nav>
						</div>
									</div><!--.container-->
			</div><!--#header-->
		</header><div id="page" class="single">
	
		
	<article class="article" itemscope="" itemtype="http://schema.org/BlogPosting">
			        <meta itemprop="image" content="http://www.androidhive.info/wp-content/uploads/2016/02/android-realtime-chat-app-using-gcm-php-mysql-part-1.png">
	    		<div id="content_box">
							<div id="post-38919" class="g post post-38919 type-post status-publish format-standard has-post-thumbnail hentry category-gcm category-google category-json category-mysql category-php category-push-notifications category-rest category-slim category-volley has_thumb">
											<div class="breadcrumb" xmlns:v="http://rdf.data-vocabulary.org/#"><div typeof="v:Breadcrumb" class="root"><a rel="v:url" property="v:title" href="http://www.androidhive.info/">Home</a></div><div><i class="fa fa-angle-right"></i></div><div typeof="v:Breadcrumb"><a href="http://www.androidhive.info/category/gcm/" rel="v:url" property="v:title">GCM</a></div><div><i class="fa fa-angle-right"></i></div><div><span>Android Building Realtime Chat App using GCM, PHP &amp; MySQL – Part 1</span></div></div>
																		<div class="single_post">
									<header>
										<h1 class="title single-title entry-title" itemprop="headline">Android Building Realtime Chat App using GCM, PHP &amp; MySQL – Part 1</h1>
													<div class="post-info">
                                                <span class="theauthor">by <span itemprop="author"><a rel="nofollow" href="http://www.androidhive.info/author/admin/" title="Posts by Ravi Tamada">Ravi Tamada</a><span class="divider1">/</span></span></span>
                            <span class="thetime updated"><span itemprop="datePublished">February 9, 2016<span class="divider1">/</span></span></span>
            <span class="thecomment"><i class="fa fa-comments"></i> <a href="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-1/#disqus_thread"><b>219</b> Comments</a></span>
			</div>
											</header><!--.headline_area-->
									<div class="post-single-content box mark-links entry-content">
																														<div class="thecontent" itemprop="articleBody">
											
<!-- Quick Adsense WordPress Plugin: http://quicksense.net/ -->
<div style="float:left;margin:10px 10px 10px 0;">
<script id="mNCC" language="javascript">  medianet_width='336';  medianet_height= '280';  medianet_crid='428207516';  </script>  <script id="mNSC" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/nmedianet.js" language="javascript"></script><script language="javascript" type="text/javascript" id="_mN_dy_428207516" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/fcmdynet.js"></script><script async="" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/adsbygoogle.js"></script>
<!-- Content First left -->
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-8479132932764602" data-ad-slot="8420041971" data-adsbygoogle-status="done"><ins id="aswift_1_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><ins id="aswift_1_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><iframe width="336" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

</div>
<p><a rel="nofollow" href="https://developers.google.com/cloud-messaging/" target="_blank">Google Cloud Messaging</a> allows you send lightweight messages from the backend server to all the devices whenever there is new data available. This saves lot of user’s battery by avoiding poll request to server for new data. Using GCM you can build powerful multi platform (iOS, Android &amp; Web) apps like real time chat, news feed, cloud storage and lot more. On top of everything, GCM is completely free and there are no limitations.</p>
<p>As <a rel="nofollow" href="http://parse.com/" target="_blank">parse.com</a> announced their <a rel="nofollow" href="http://blog.parse.com/announcements/moving-on/" target="_blank">shutdown</a> recently, GCM is the only best option even though it won’t comes with an admin interface. But don’t worry, we’ll build a simple admin panel in this article.</p>
<div style="display:none">
<img src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/android-google-cloud-messaging-realtime-chat-app.png" alt="android realtime chat app using gcm php mysql" width="720" height="541" class="alignnone size-full wp-image-39105" srcset="http://www.androidhive.info/wp-content/uploads/2016/02/android-google-cloud-messaging-realtime-chat-app-300x225.png 300w, http://www.androidhive.info/wp-content/uploads/2016/02/android-google-cloud-messaging-realtime-chat-app.png 720w" sizes="(max-width: 720px) 100vw, 720px">
</div>
<div class="clear"></div>
<div class="download_code"><a href="http://download.androidhive.info/download?code=ezIaenBbBvpi9mHPgfJORAf29XiwLMoBYda5USk3IGtj6%2Faczubg6fCH0vmiw9zHaMdsR5SffC%2Fre3SW9U7yMBKw6UcfzOxvM9abmgXdKVv1IqCCx0krVRKXw%3D%3DV49ttmJZCuX14D55E1n1NQdeFCYyRRMEhlJ" target="_blank">DOWNLOAD CODE</a></div>
<div class="download_code"><a href="http://demo.androidhive.info/gcm_chat/" target="_blank">LIVE DEMO</a></div>
<div class="yt_video">
<label>VIDEO DEMO</label><br>
<iframe src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/jGuv7QOwYSQ.html" frameborder="0" allowfullscreen="" style="width: 719px; height: 444.7265625px;"></iframe>
</div>
<p></p>
<p>As this article is pretty lengthy, I have divided it into <strong>3 parts</strong>. Each part covers a unique part in building the final realtime chat app.</p>
<p><a href="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-1" target="_blank">Part 1</a>: Covers building the REST API for chat app including the GCM server app.</p>
<p><a href="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-2" target="_blank">Part 2</a>: Explains integrating GCM into your android app including a test message.</p>
<p><a href="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-3" target="_blank">Part 3</a>: Building Simple Realtime Chat App.</p>
<h2>1. Google Cloud Messaging</h2>
<p>Typically GCM implementation involves three components. Google cloud messaging server, the app server and the client app. We should take care of writing the app server and the client app. In order to make calls from the app server to GCM server, you can follow <a rel="nofollow" href="https://developers.google.com/cloud-messaging/http" target="_blank">HTTP</a> or <a rel="nofollow" href="https://developers.google.com/cloud-messaging/ccs" target="_blank">XMPP</a> protocol. HTTP supports downstream (gcm to client) messages only. XMPP supports both downstream and upstream  (device to gcm, then from gcm to server) messages.</p>
<!-- Quick Adsense WordPress Plugin: http://quicksense.net/ -->
<div style="float:none;margin:10px 0 10px 0;text-align:center;">
<script id="mNCC" language="javascript">  medianet_width='600';  medianet_height= '250';  medianet_crid='689311703';  </script>  <script id="mNSC" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/nmedianet.js" language="javascript"></script><script language="javascript" type="text/javascript" id="_mN_dy_689311703" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/fcmdynet(1).js"></script><iframe marginwidth="0" marginheight="0" scrolling="no" frameborder="0" height="250" width="100%" id="_mN_main_689311703_0_n"></iframe>
</div>

<p>Below is the pictorial representation of the overall architecture.</p>
<div class="image">
<img src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/android-google-cloud-messaging-architecture.png" alt="android-google-cloud-messaging-architecture" width="719" height="519" class="alignnone size-full wp-image-38965" srcset="http://www.androidhive.info/wp-content/uploads/2016/02/android-google-cloud-messaging-architecture-300x217.png 300w, http://www.androidhive.info/wp-content/uploads/2016/02/android-google-cloud-messaging-architecture.png 719w" sizes="(max-width: 719px) 100vw, 719px">
</div>
<p><strong>1</strong>. First the app connects to GCM server and register itself.</p>
<p><strong>2</strong>. Upon successful registration, GCM issues gcm <strong>registration token</strong> to device. This registration token uniquely identifies each device.</p>
<p><strong>3</strong>. The device sends the registration token to our server to store it in <strong>MySQL</strong>.</p>
<p><strong>4</strong>. Whenever app server wants to send push notification, it sends a request to GCM server sending the <strong>push message</strong> along with the <strong>registration token</strong>.</p>
<p><strong>5</strong>. GCM server identifies the device using the registration token and initiates the push message.</p>
<p><strong>6</strong>. The device receives the <strong>push messages</strong> and further action takes place.</p>
<p></p>
<h2>2. Obtaining Google API Key</h2>
<p>Google API key is necessary to interact with GCM server. GCM uses this key to identify your server app. Follow the below steps to obtain your API key. Note that the developer console interface is changing more frequently. So, the below steps may vary in future.</p>
<p><strong>1</strong>. Goto Google <a rel="nofollow" href="https://console.developers.google.com/project" target="_blank">developers console</a> and create a new app. If you have already created one, select the app.</p>
<p><strong>2</strong>. Give a name to your new project. Once the project is created, goto project’s dashboard and click on <strong>Use Google APIs</strong></p>
<p><strong>3</strong>. Under <strong>Mobile APIs</strong>, click on <strong>Cloud Messaging for Android</strong> and enable the API by clicking on top <strong>enable API</strong> button.</p>
<p><strong>4</strong>. Once enabled, click on <strong>Credentials</strong> on the left. You will be asked to create <strong>new credentials</strong> by showing multiple options. Choose <strong>API Key</strong> and then <strong>Server Key</strong>.</p>
<p><strong>5</strong>. After choosing Server Key, your API key will be displayed on the dashboard. Note down the <strong>API key</strong> as we need to use it in our PHP project. </p>
<div class="yt_video">
<iframe src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/gMycphJ_PRI.html" frameborder="0" allowfullscreen="" style="width: 719px; height: 444.7265625px;"></iframe>
</div>
<p></p>
<h2>3. Building Simple Realtime Chat App</h2>
<p>In this article, we are going to learn how to create a simple realtime chat app by using Android, GCM, PHP, MySQL, HTML &amp; CSS. We use HTML &amp; CSS to build the admin panel for the server app.</p>
<p>Below are the screens of the android app.</p>
<div class="image">
<img src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/android-simple-chat-app-using-gcm-php-mysql.png" alt="android-simple-chat-app-using-gcm-php-mysql" width="719" height="609" class="alignnone size-full wp-image-38967" srcset="http://www.androidhive.info/wp-content/uploads/2016/02/android-simple-chat-app-using-gcm-php-mysql-300x254.png 300w, http://www.androidhive.info/wp-content/uploads/2016/02/android-simple-chat-app-using-gcm-php-mysql.png 719w" sizes="(max-width: 719px) 100vw, 719px">
</div>
<p></p>
<p>And the server app comes with the option of choosing the user(s) / topic and send the push notification.</p>
<div class="image">
<img src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/android-php-mysql-gcm-chat-app-admin-panel.png" alt="android-php-mysql-gcm-chat-app-admin-panel" width="719" height="900" class="alignnone size-full wp-image-38981" srcset="http://www.androidhive.info/wp-content/uploads/2016/02/android-php-mysql-gcm-chat-app-admin-panel-240x300.png 240w, http://www.androidhive.info/wp-content/uploads/2016/02/android-php-mysql-gcm-chat-app-admin-panel.png 719w" sizes="(max-width: 719px) 100vw, 719px">
</div>
<p></p>
<p>This part of the article involves building the server app including designing the MySQL database, REST API for mobile app and an admin panel to send push notifications. I am using <a rel="nofollow" href="https://netbeans.org/downloads/" target="_blank">Netbeans</a> IDE to develop the PHP code and <a rel="nofollow" href="http://www.wampserver.com/en/" target="_blank">WAMP</a> / <a rel="nofollow" href="https://www.mamp.info/en/downloads/" target="_blank">MAMP</a> server to create the php, mysql environment.</p>
<p>Now let’s start designing the database first.<br>
</p>
<h2>4. Designing MySQL Database</h2>
<p>For this app we need only three tables. users, chat rooms and messages. </p>
<p><em>users</em> – This table holds the user information like <strong>name</strong>, <strong>email</strong> and other profile information along with <strong>gcm registration id</strong>.</p>
<p><em>chat_rooms</em> – Contains the chat room information.</p>
<p><em>messages</em> – Contains the messages sent in the chat rooms.</p>
<div class="image">
<img src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/android-simple-chat-app-mysql-database-1.png" alt="android-simple-chat-app-mysql-database" width="719" height="428" class="alignnone size-full wp-image-38938" srcset="http://www.androidhive.info/wp-content/uploads/2016/02/android-simple-chat-app-mysql-database-1-300x179.png 300w, http://www.androidhive.info/wp-content/uploads/2016/02/android-simple-chat-app-mysql-database-1.png 719w" sizes="(max-width: 719px) 100vw, 719px">
</div>
<p>Open phpmyadmin and execute the below sql query to create the required database and tables.</p>
<div><div id="highlighter_623498" class="syntaxhighlighter nogutter  sql"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="sql keyword">CREATE</code> <code class="sql keyword">DATABASE</code> <code class="sql plain">gcm_chat;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="sql keyword">CREATE</code> <code class="sql keyword">TABLE</code> <code class="sql plain">`chat_rooms` (</code></div><div class="line number4 index3 alt1"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql plain">`chat_room_id` </code><code class="sql keyword">int</code><code class="sql plain">(11) </code><code class="sql color1">NOT</code> <code class="sql color1">NULL</code><code class="sql plain">,</code></div><div class="line number5 index4 alt2"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql plain">`</code><code class="sql keyword">name</code><code class="sql plain">` </code><code class="sql keyword">varchar</code><code class="sql plain">(100) </code><code class="sql color1">NOT</code> <code class="sql color1">NULL</code><code class="sql plain">,</code></div><div class="line number6 index5 alt1"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql plain">`created_at` </code><code class="sql keyword">timestamp</code> <code class="sql color1">NOT</code> <code class="sql color1">NULL</code> <code class="sql keyword">DEFAULT</code> <code class="sql color2">CURRENT_TIMESTAMP</code></div><div class="line number7 index6 alt2"><code class="sql plain">) ENGINE=InnoDB AUTO_INCREMENT=1 </code><code class="sql keyword">DEFAULT</code> <code class="sql plain">CHARSET=latin1;</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="sql keyword">CREATE</code> <code class="sql keyword">TABLE</code> <code class="sql plain">`messages` (</code></div><div class="line number10 index9 alt1"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql plain">`message_id` </code><code class="sql keyword">int</code><code class="sql plain">(11) </code><code class="sql color1">NOT</code> <code class="sql color1">NULL</code><code class="sql plain">,</code></div><div class="line number11 index10 alt2"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql plain">`chat_room_id` </code><code class="sql keyword">int</code><code class="sql plain">(11) </code><code class="sql color1">NOT</code> <code class="sql color1">NULL</code><code class="sql plain">,</code></div><div class="line number12 index11 alt1"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql plain">`user_id` </code><code class="sql keyword">int</code><code class="sql plain">(11) </code><code class="sql color1">NOT</code> <code class="sql color1">NULL</code><code class="sql plain">,</code></div><div class="line number13 index12 alt2"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql plain">`message` text </code><code class="sql color1">NOT</code> <code class="sql color1">NULL</code><code class="sql plain">,</code></div><div class="line number14 index13 alt1"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql plain">`created_at` </code><code class="sql keyword">timestamp</code> <code class="sql color1">NOT</code> <code class="sql color1">NULL</code> <code class="sql keyword">DEFAULT</code> <code class="sql color2">CURRENT_TIMESTAMP</code></div><div class="line number15 index14 alt2"><code class="sql plain">) ENGINE=InnoDB </code><code class="sql keyword">DEFAULT</code> <code class="sql plain">CHARSET=latin1;</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="sql keyword">CREATE</code> <code class="sql keyword">TABLE</code> <code class="sql plain">`users` (</code></div><div class="line number18 index17 alt1"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql plain">`user_id` </code><code class="sql keyword">int</code><code class="sql plain">(11) </code><code class="sql color1">NOT</code> <code class="sql color1">NULL</code><code class="sql plain">,</code></div><div class="line number19 index18 alt2"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql plain">`</code><code class="sql keyword">name</code><code class="sql plain">` </code><code class="sql keyword">varchar</code><code class="sql plain">(255) </code><code class="sql color1">NOT</code> <code class="sql color1">NULL</code><code class="sql plain">,</code></div><div class="line number20 index19 alt1"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql plain">`email` </code><code class="sql keyword">varchar</code><code class="sql plain">(255) </code><code class="sql color1">NOT</code> <code class="sql color1">NULL</code><code class="sql plain">,</code></div><div class="line number21 index20 alt2"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql plain">`gcm_registration_id` text </code><code class="sql color1">NOT</code> <code class="sql color1">NULL</code><code class="sql plain">,</code></div><div class="line number22 index21 alt1"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql plain">`created_at` </code><code class="sql keyword">timestamp</code> <code class="sql color1">NOT</code> <code class="sql color1">NULL</code> <code class="sql keyword">DEFAULT</code> <code class="sql color2">CURRENT_TIMESTAMP</code></div><div class="line number23 index22 alt2"><code class="sql plain">) ENGINE=InnoDB </code><code class="sql keyword">DEFAULT</code> <code class="sql plain">CHARSET=latin1;</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="sql keyword">ALTER</code> <code class="sql keyword">TABLE</code> <code class="sql plain">`chat_rooms`</code></div><div class="line number26 index25 alt1"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql keyword">ADD</code> <code class="sql keyword">PRIMARY</code> <code class="sql keyword">KEY</code> <code class="sql plain">(`chat_room_id`);</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="sql keyword">ALTER</code> <code class="sql keyword">TABLE</code> <code class="sql plain">`messages`</code></div><div class="line number29 index28 alt2"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql keyword">ADD</code> <code class="sql keyword">PRIMARY</code> <code class="sql keyword">KEY</code> <code class="sql plain">(`message_id`),</code></div><div class="line number30 index29 alt1"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql keyword">ADD</code> <code class="sql keyword">KEY</code> <code class="sql plain">`chat_room_id` (`chat_room_id`),</code></div><div class="line number31 index30 alt2"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql keyword">ADD</code> <code class="sql keyword">KEY</code> <code class="sql plain">`user_id` (`user_id`),</code></div><div class="line number32 index31 alt1"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql keyword">ADD</code> <code class="sql keyword">KEY</code> <code class="sql plain">`chat_room_id_2` (`chat_room_id`);</code></div><div class="line number33 index32 alt2">&nbsp;</div><div class="line number34 index33 alt1"><code class="sql keyword">ALTER</code> <code class="sql keyword">TABLE</code> <code class="sql plain">`users`</code></div><div class="line number35 index34 alt2"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql keyword">ADD</code> <code class="sql keyword">PRIMARY</code> <code class="sql keyword">KEY</code> <code class="sql plain">(`user_id`),</code></div><div class="line number36 index35 alt1"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql keyword">ADD</code> <code class="sql keyword">UNIQUE</code> <code class="sql keyword">KEY</code> <code class="sql plain">`email` (`email`);</code></div><div class="line number37 index36 alt2">&nbsp;</div><div class="line number38 index37 alt1"><code class="sql keyword">ALTER</code> <code class="sql keyword">TABLE</code> <code class="sql plain">`messages`</code></div><div class="line number39 index38 alt2"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql keyword">ADD</code> <code class="sql keyword">CONSTRAINT</code> <code class="sql plain">`messages_ibfk_3` </code><code class="sql keyword">FOREIGN</code> <code class="sql keyword">KEY</code> <code class="sql plain">(`chat_room_id`) </code><code class="sql keyword">REFERENCES</code> <code class="sql plain">`chat_rooms` (`chat_room_id`),</code></div><div class="line number40 index39 alt1"><code class="sql spaces">&nbsp;&nbsp;</code><code class="sql keyword">ADD</code> <code class="sql keyword">CONSTRAINT</code> <code class="sql plain">`messages_ibfk_2` </code><code class="sql keyword">FOREIGN</code> <code class="sql keyword">KEY</code> <code class="sql plain">(`user_id`) </code><code class="sql keyword">REFERENCES</code> <code class="sql plain">`users` (`user_id`) </code><code class="sql keyword">ON</code> <code class="sql keyword">DELETE</code> <code class="sql keyword">CASCADE</code> <code class="sql keyword">ON</code> <code class="sql keyword">UPDATE</code> <code class="sql keyword">CASCADE</code><code class="sql plain">;</code></div></div></td></tr></tbody></table></div></div>
<h2>5. Creating PHP REST API</h2>
<p>I am using <a rel="nofollow" href="http://www.slimframework.com/" target="_blank">Slim</a> framework to create the REST endpoints. If you are not aware of PHP Slim, refer my previous tutorial <a href="http://www.androidhive.info/2014/01/how-to-create-rest-api-for-android-app-using-php-slim-and-mysql-day-12-2/" target="_blank">REST API for Android app using PHP, Slim and MySQL</a> to understand how easily you can create the REST API endpoints for your android app.</p>
<p>Below is the project structure of the PHP app. You have to make sure that you are following same structure while following the further steps.</p>
<div class="image">
<img src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/gcm-simple-chat-app-php-mysql-project.png" alt="gcm-simple-chat-app-php-mysql-project" width="719" height="428" class="alignnone size-full wp-image-38941" srcset="http://www.androidhive.info/wp-content/uploads/2016/02/gcm-simple-chat-app-php-mysql-project-300x179.png 300w, http://www.androidhive.info/wp-content/uploads/2016/02/gcm-simple-chat-app-php-mysql-project.png 719w" sizes="(max-width: 719px) 100vw, 719px">
</div>
<p><em>include</em> – Contains the database classes to perform CRUD operations on the database.</p>
<p><em>libs</em> – Contains the libraries needed for the app (slim, gcm)</p>
<p><em>v1</em> – Root directory of the REST API</p>
<p><em>index.php, demo.php, styles.css</em> – Required to create the admin interface.</p>
<p><strong>1</strong>. Goto your <strong>WAMP/MAMP</strong> installation location and open the web directory. On windows, it will be <strong>c:/wamp/www</strong> directory. On Mac, the path will be <strong>/Applications/MAMP/htdocs</strong>.</p>
<p><strong>2</strong>. Inside the web directory (<strong>www</strong> or <strong>htdocs</strong>), create a directory named <strong>gcm_chat</strong>. This will be the root directory of our project.</p>
<p><strong>3</strong>. Inside <strong>gcm_chat</strong> folder, create the remaining directories as shown in the above image. Create folders named <strong>include</strong>, <strong>libs</strong> and <strong>v1</strong>. Inside <strong>libs</strong>, create another folder named <strong>gcm</strong>.</p>
<p><strong>4</strong>. <a href="http://api.androidhive.info/Slim.zip" target="_blank">Download</a> Slim framework and paste it inside <strong>libs</strong> folder.</p>
<p><strong>5</strong>. Create a file named <strong>config.php</strong> in <strong>include</strong>. This file contains the app configuration like database credentials, google API Key and other information.</p>
<p>Replace <strong>GOOGLE_API_KEY</strong> with your API Key which you obtained in 2nd section. Also keep the correct database credentials.</p>
<div><div id="highlighter_587888" class="syntaxhighlighter nogutter  php"><table border="0" cellpadding="0" cellspacing="0"><caption>config.php</caption><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">&lt;?php</code></div><div class="line number2 index1 alt1"><code class="php comments">/**</code></div><div class="line number3 index2 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">* Database configuration</code></div><div class="line number4 index3 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">*/</code></div><div class="line number5 index4 alt2"><code class="php plain">define(</code><code class="php string">'DB_USERNAME'</code><code class="php plain">, </code><code class="php string">'root'</code><code class="php plain">);</code></div><div class="line number6 index5 alt1"><code class="php plain">define(</code><code class="php string">'DB_PASSWORD'</code><code class="php plain">, </code><code class="php string">'root'</code><code class="php plain">);</code></div><div class="line number7 index6 alt2"><code class="php plain">define(</code><code class="php string">'DB_HOST'</code><code class="php plain">, </code><code class="php string">'localhost'</code><code class="php plain">);</code></div><div class="line number8 index7 alt1"><code class="php plain">define(</code><code class="php string">'DB_NAME'</code><code class="php plain">, </code><code class="php string">'gcm_chat'</code><code class="php plain">);</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="php plain">define(</code><code class="php string">"GOOGLE_API_KEY"</code><code class="php plain">, </code><code class="php string">"AIzaSyDKk_Ew7Vi4FZnMzu6GCY5PLb4xZG8muvX"</code><code class="php plain">);</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="php comments">// push notification flags</code></div><div class="line number13 index12 alt2"><code class="php plain">define(</code><code class="php string">'PUSH_FLAG_CHATROOM'</code><code class="php plain">, 1);</code></div><div class="line number14 index13 alt1"><code class="php plain">define(</code><code class="php string">'PUSH_FLAG_USER'</code><code class="php plain">, 2);</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="php plain">?&gt;</code></div></div></td></tr></tbody></table></div></div>
<p>
<strong>6</strong>. Create a file named <strong>db_connect.php</strong> inside <strong>include</strong> folder. This class takes care of database connection.</p>
<div><div id="highlighter_951619" class="syntaxhighlighter nogutter  php"><table border="0" cellpadding="0" cellspacing="0"><caption>db_connect.php</caption><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">&lt;?php</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="php comments">/**</code></div><div class="line number4 index3 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">* Handling database connection</code></div><div class="line number5 index4 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">*</code></div><div class="line number6 index5 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">*/</code></div><div class="line number7 index6 alt2"><code class="php keyword">class</code> <code class="php plain">DbConnect {</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">private</code> <code class="php variable">$conn</code><code class="php plain">;</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">function</code> <code class="php plain">__construct() {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number12 index11 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">/**</code></div><div class="line number15 index14 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">* Establishing database connection</code></div><div class="line number16 index15 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">* @return database connection handler</code></div><div class="line number17 index16 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">*/</code></div><div class="line number18 index17 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">function</code> <code class="php plain">connect() {</code></div><div class="line number19 index18 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">include_once</code> <code class="php plain">dirname(</code><code class="php constants">__FILE__</code><code class="php plain">) . </code><code class="php string">'/config.php'</code><code class="php plain">;</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// Connecting to mysql database</code></div><div class="line number22 index21 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$this</code><code class="php plain">-&gt;conn = </code><code class="php keyword">new</code> <code class="php plain">mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// Check for database connection error</code></div><div class="line number25 index24 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(mysqli_connect_errno()) {</code></div><div class="line number26 index25 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php functions">echo</code> <code class="php string">"Failed to connect to MySQL: "</code> <code class="php plain">. mysqli_connect_error();</code></div><div class="line number27 index26 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// returing connection resource</code></div><div class="line number30 index29 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$this</code><code class="php plain">-&gt;conn;</code></div><div class="line number31 index30 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number32 index31 alt1"><code class="php plain">}</code></div><div class="line number33 index32 alt2"><code class="php plain">?&gt;</code></div></div></td></tr></tbody></table></div></div>
<p>
<strong>7</strong>. Create another file named <strong>db_handler.php</strong> inside <strong>include</strong> folder. This file contains all the necessary functions to interact with database tables.</p>
<div><div id="highlighter_163633" class="syntaxhighlighter nogutter  php"><table border="0" cellpadding="0" cellspacing="0"><caption>db_handler.php</caption><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">&lt;?php</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="php comments">/**</code></div><div class="line number4 index3 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">* Class to handle all db operations</code></div><div class="line number5 index4 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">* This class will have CRUD methods for database tables</code></div><div class="line number6 index5 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">*</code></div><div class="line number7 index6 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">* @author Ravi Tamada</code></div><div class="line number8 index7 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">*/</code></div><div class="line number9 index8 alt2"><code class="php keyword">class</code> <code class="php plain">DbHandler {</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">private</code> <code class="php variable">$conn</code><code class="php plain">;</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">function</code> <code class="php plain">__construct() {</code></div><div class="line number14 index13 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">require_once</code> <code class="php plain">dirname(</code><code class="php constants">__FILE__</code><code class="php plain">) . </code><code class="php string">'/db_connect.php'</code><code class="php plain">;</code></div><div class="line number15 index14 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// opening db connection</code></div><div class="line number16 index15 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$db</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">DbConnect();</code></div><div class="line number17 index16 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$this</code><code class="php plain">-&gt;conn = </code><code class="php variable">$db</code><code class="php plain">-&gt;connect();</code></div><div class="line number18 index17 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// creating new user if not existed</code></div><div class="line number21 index20 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">createUser(</code><code class="php variable">$name</code><code class="php plain">, </code><code class="php variable">$email</code><code class="php plain">) {</code></div><div class="line number22 index21 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// First check if user already existed in db</code></div><div class="line number25 index24 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(!</code><code class="php variable">$this</code><code class="php plain">-&gt;isUserExists(</code><code class="php variable">$email</code><code class="php plain">)) {</code></div><div class="line number26 index25 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// insert query</code></div><div class="line number27 index26 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;conn-&gt;prepare(</code><code class="php string">"INSERT INTO users(name, email) values(?, ?)"</code><code class="php plain">);</code></div><div class="line number28 index27 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;bind_param(</code><code class="php string">"ss"</code><code class="php plain">, </code><code class="php variable">$name</code><code class="php plain">, </code><code class="php variable">$email</code><code class="php plain">);</code></div><div class="line number29 index28 alt2">&nbsp;</div><div class="line number30 index29 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$result</code> <code class="php plain">= </code><code class="php variable">$stmt</code><code class="php plain">-&gt;execute();</code></div><div class="line number31 index30 alt2">&nbsp;</div><div class="line number32 index31 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;close();</code></div><div class="line number33 index32 alt2">&nbsp;</div><div class="line number34 index33 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// Check for successful insertion</code></div><div class="line number35 index34 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$result</code><code class="php plain">) {</code></div><div class="line number36 index35 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// User successfully inserted</code></div><div class="line number37 index36 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"error"</code><code class="php plain">] = false;</code></div><div class="line number38 index37 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"user"</code><code class="php plain">] = </code><code class="php variable">$this</code><code class="php plain">-&gt;getUserByEmail(</code><code class="php variable">$email</code><code class="php plain">);</code></div><div class="line number39 index38 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">} </code><code class="php keyword">else</code> <code class="php plain">{</code></div><div class="line number40 index39 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// Failed to create user</code></div><div class="line number41 index40 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"error"</code><code class="php plain">] = true;</code></div><div class="line number42 index41 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"message"</code><code class="php plain">] = </code><code class="php string">"Oops! An error occurred while registereing"</code><code class="php plain">;</code></div><div class="line number43 index42 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number44 index43 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">} </code><code class="php keyword">else</code> <code class="php plain">{</code></div><div class="line number45 index44 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// User with same email already existed in the db</code></div><div class="line number46 index45 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"error"</code><code class="php plain">] = false;</code></div><div class="line number47 index46 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"user"</code><code class="php plain">] = </code><code class="php variable">$this</code><code class="php plain">-&gt;getUserByEmail(</code><code class="php variable">$email</code><code class="php plain">);</code></div><div class="line number48 index47 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number49 index48 alt2">&nbsp;</div><div class="line number50 index49 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$response</code><code class="php plain">;</code></div><div class="line number51 index50 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number52 index51 alt1">&nbsp;</div><div class="line number53 index52 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// updating user GCM registration ID</code></div><div class="line number54 index53 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">updateGcmID(</code><code class="php variable">$user_id</code><code class="php plain">, </code><code class="php variable">$gcm_registration_id</code><code class="php plain">) {</code></div><div class="line number55 index54 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number56 index55 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;conn-&gt;prepare(</code><code class="php string">"UPDATE users SET gcm_registration_id = ? WHERE user_id = ?"</code><code class="php plain">);</code></div><div class="line number57 index56 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;bind_param(</code><code class="php string">"si"</code><code class="php plain">, </code><code class="php variable">$gcm_registration_id</code><code class="php plain">, </code><code class="php variable">$user_id</code><code class="php plain">);</code></div><div class="line number58 index57 alt1">&nbsp;</div><div class="line number59 index58 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$stmt</code><code class="php plain">-&gt;execute()) {</code></div><div class="line number60 index59 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// User successfully updated</code></div><div class="line number61 index60 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"error"</code><code class="php plain">] = false;</code></div><div class="line number62 index61 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"message"</code><code class="php plain">] = </code><code class="php string">'GCM registration ID updated successfully'</code><code class="php plain">;</code></div><div class="line number63 index62 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">} </code><code class="php keyword">else</code> <code class="php plain">{</code></div><div class="line number64 index63 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// Failed to update user</code></div><div class="line number65 index64 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"error"</code><code class="php plain">] = true;</code></div><div class="line number66 index65 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"message"</code><code class="php plain">] = </code><code class="php string">"Failed to update GCM registration ID"</code><code class="php plain">;</code></div><div class="line number67 index66 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;error;</code></div><div class="line number68 index67 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number69 index68 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;close();</code></div><div class="line number70 index69 alt1">&nbsp;</div><div class="line number71 index70 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$response</code><code class="php plain">;</code></div><div class="line number72 index71 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number73 index72 alt2">&nbsp;</div><div class="line number74 index73 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// fetching single user by id</code></div><div class="line number75 index74 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">getUser(</code><code class="php variable">$user_id</code><code class="php plain">) {</code></div><div class="line number76 index75 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;conn-&gt;prepare(</code><code class="php string">"SELECT user_id, name, email, gcm_registration_id, created_at FROM users WHERE user_id = ?"</code><code class="php plain">);</code></div><div class="line number77 index76 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;bind_param(</code><code class="php string">"s"</code><code class="php plain">, </code><code class="php variable">$user_id</code><code class="php plain">);</code></div><div class="line number78 index77 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$stmt</code><code class="php plain">-&gt;execute()) {</code></div><div class="line number79 index78 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// $user = $stmt-&gt;get_result()-&gt;fetch_assoc();</code></div><div class="line number80 index79 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;bind_result(</code><code class="php variable">$user_id</code><code class="php plain">, </code><code class="php variable">$name</code><code class="php plain">, </code><code class="php variable">$email</code><code class="php plain">, </code><code class="php variable">$gcm_registration_id</code><code class="php plain">, </code><code class="php variable">$created_at</code><code class="php plain">);</code></div><div class="line number81 index80 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;fetch();</code></div><div class="line number82 index81 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number83 index82 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">"user_id"</code><code class="php plain">] = </code><code class="php variable">$user_id</code><code class="php plain">;</code></div><div class="line number84 index83 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">"name"</code><code class="php plain">] = </code><code class="php variable">$name</code><code class="php plain">;</code></div><div class="line number85 index84 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">"email"</code><code class="php plain">] = </code><code class="php variable">$email</code><code class="php plain">;</code></div><div class="line number86 index85 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">"gcm_registration_id"</code><code class="php plain">] = </code><code class="php variable">$gcm_registration_id</code><code class="php plain">;</code></div><div class="line number87 index86 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">"created_at"</code><code class="php plain">] = </code><code class="php variable">$created_at</code><code class="php plain">;</code></div><div class="line number88 index87 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;close();</code></div><div class="line number89 index88 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$user</code><code class="php plain">;</code></div><div class="line number90 index89 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">} </code><code class="php keyword">else</code> <code class="php plain">{</code></div><div class="line number91 index90 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php plain">NULL;</code></div><div class="line number92 index91 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number93 index92 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number94 index93 alt1">&nbsp;</div><div class="line number95 index94 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// fetching multiple users by ids</code></div><div class="line number96 index95 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">getUsers(</code><code class="php variable">$user_ids</code><code class="php plain">) {</code></div><div class="line number97 index96 alt2">&nbsp;</div><div class="line number98 index97 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$users</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number99 index98 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(sizeof(</code><code class="php variable">$user_ids</code><code class="php plain">) &gt; 0) {</code></div><div class="line number100 index99 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$query</code> <code class="php plain">= </code><code class="php string">"SELECT user_id, name, email, gcm_registration_id, created_at FROM users WHERE user_id IN ("</code><code class="php plain">;</code></div><div class="line number101 index100 alt2">&nbsp;</div><div class="line number102 index101 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">foreach</code> <code class="php plain">(</code><code class="php variable">$user_ids</code> <code class="php keyword">as</code> <code class="php variable">$user_id</code><code class="php plain">) {</code></div><div class="line number103 index102 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$query</code> <code class="php plain">.= </code><code class="php variable">$user_id</code> <code class="php plain">. </code><code class="php string">','</code><code class="php plain">;</code></div><div class="line number104 index103 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number105 index104 alt2">&nbsp;</div><div class="line number106 index105 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$query</code> <code class="php plain">= </code><code class="php functions">substr</code><code class="php plain">(</code><code class="php variable">$query</code><code class="php plain">, 0, </code><code class="php functions">strlen</code><code class="php plain">(</code><code class="php variable">$query</code><code class="php plain">) - 1);</code></div><div class="line number107 index106 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$query</code> <code class="php plain">.= </code><code class="php string">')'</code><code class="php plain">;</code></div><div class="line number108 index107 alt1">&nbsp;</div><div class="line number109 index108 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;conn-&gt;prepare(</code><code class="php variable">$query</code><code class="php plain">);</code></div><div class="line number110 index109 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;execute();</code></div><div class="line number111 index110 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$result</code> <code class="php plain">= </code><code class="php variable">$stmt</code><code class="php plain">-&gt;get_result();</code></div><div class="line number112 index111 alt1">&nbsp;</div><div class="line number113 index112 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">while</code> <code class="php plain">(</code><code class="php variable">$user</code> <code class="php plain">= </code><code class="php variable">$result</code><code class="php plain">-&gt;fetch_assoc()) {</code></div><div class="line number114 index113 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number115 index114 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code><code class="php plain">[</code><code class="php string">"user_id"</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">'user_id'</code><code class="php plain">];</code></div><div class="line number116 index115 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code><code class="php plain">[</code><code class="php string">"name"</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">'name'</code><code class="php plain">];</code></div><div class="line number117 index116 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code><code class="php plain">[</code><code class="php string">"email"</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">'email'</code><code class="php plain">];</code></div><div class="line number118 index117 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code><code class="php plain">[</code><code class="php string">"gcm_registration_id"</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">'gcm_registration_id'</code><code class="php plain">];</code></div><div class="line number119 index118 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code><code class="php plain">[</code><code class="php string">"created_at"</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">'created_at'</code><code class="php plain">];</code></div><div class="line number120 index119 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php functions">array_push</code><code class="php plain">(</code><code class="php variable">$users</code><code class="php plain">, </code><code class="php variable">$tmp</code><code class="php plain">);</code></div><div class="line number121 index120 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number122 index121 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number123 index122 alt2">&nbsp;</div><div class="line number124 index123 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$users</code><code class="php plain">;</code></div><div class="line number125 index124 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number126 index125 alt1">&nbsp;</div><div class="line number127 index126 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// messaging in a chat room / to persional message</code></div><div class="line number128 index127 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">addMessage(</code><code class="php variable">$user_id</code><code class="php plain">, </code><code class="php variable">$chat_room_id</code><code class="php plain">, </code><code class="php variable">$message</code><code class="php plain">) {</code></div><div class="line number129 index128 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number130 index129 alt1">&nbsp;</div><div class="line number131 index130 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;conn-&gt;prepare(</code><code class="php string">"INSERT INTO messages (chat_room_id, user_id, message) values(?, ?, ?)"</code><code class="php plain">);</code></div><div class="line number132 index131 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;bind_param(</code><code class="php string">"iis"</code><code class="php plain">, </code><code class="php variable">$chat_room_id</code><code class="php plain">, </code><code class="php variable">$user_id</code><code class="php plain">, </code><code class="php variable">$message</code><code class="php plain">);</code></div><div class="line number133 index132 alt2">&nbsp;</div><div class="line number134 index133 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$result</code> <code class="php plain">= </code><code class="php variable">$stmt</code><code class="php plain">-&gt;execute();</code></div><div class="line number135 index134 alt2">&nbsp;</div><div class="line number136 index135 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$result</code><code class="php plain">) {</code></div><div class="line number137 index136 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'error'</code><code class="php plain">] = false;</code></div><div class="line number138 index137 alt1">&nbsp;</div><div class="line number139 index138 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// get the message</code></div><div class="line number140 index139 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$message_id</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;conn-&gt;insert_id;</code></div><div class="line number141 index140 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;conn-&gt;prepare(</code><code class="php string">"SELECT message_id, user_id, chat_room_id, message, created_at FROM messages WHERE message_id = ?"</code><code class="php plain">);</code></div><div class="line number142 index141 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;bind_param(</code><code class="php string">"i"</code><code class="php plain">, </code><code class="php variable">$message_id</code><code class="php plain">);</code></div><div class="line number143 index142 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$stmt</code><code class="php plain">-&gt;execute()) {</code></div><div class="line number144 index143 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;bind_result(</code><code class="php variable">$message_id</code><code class="php plain">, </code><code class="php variable">$user_id</code><code class="php plain">, </code><code class="php variable">$chat_room_id</code><code class="php plain">, </code><code class="php variable">$message</code><code class="php plain">, </code><code class="php variable">$created_at</code><code class="php plain">);</code></div><div class="line number145 index144 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;fetch();</code></div><div class="line number146 index145 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number147 index146 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code><code class="php plain">[</code><code class="php string">'message_id'</code><code class="php plain">] = </code><code class="php variable">$message_id</code><code class="php plain">;</code></div><div class="line number148 index147 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code><code class="php plain">[</code><code class="php string">'chat_room_id'</code><code class="php plain">] = </code><code class="php variable">$chat_room_id</code><code class="php plain">;</code></div><div class="line number149 index148 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">] = </code><code class="php variable">$message</code><code class="php plain">;</code></div><div class="line number150 index149 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code><code class="php plain">[</code><code class="php string">'created_at'</code><code class="php plain">] = </code><code class="php variable">$created_at</code><code class="php plain">;</code></div><div class="line number151 index150 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">] = </code><code class="php variable">$tmp</code><code class="php plain">;</code></div><div class="line number152 index151 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number153 index152 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">} </code><code class="php keyword">else</code> <code class="php plain">{</code></div><div class="line number154 index153 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'error'</code><code class="php plain">] = true;</code></div><div class="line number155 index154 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">] = </code><code class="php string">'Failed send message'</code><code class="php plain">;</code></div><div class="line number156 index155 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number157 index156 alt2">&nbsp;</div><div class="line number158 index157 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$response</code><code class="php plain">;</code></div><div class="line number159 index158 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number160 index159 alt1">&nbsp;</div><div class="line number161 index160 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// fetching all chat rooms</code></div><div class="line number162 index161 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">getAllChatrooms() {</code></div><div class="line number163 index162 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;conn-&gt;prepare(</code><code class="php string">"SELECT * FROM chat_rooms"</code><code class="php plain">);</code></div><div class="line number164 index163 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;execute();</code></div><div class="line number165 index164 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tasks</code> <code class="php plain">= </code><code class="php variable">$stmt</code><code class="php plain">-&gt;get_result();</code></div><div class="line number166 index165 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;close();</code></div><div class="line number167 index166 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$tasks</code><code class="php plain">;</code></div><div class="line number168 index167 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number169 index168 alt2">&nbsp;</div><div class="line number170 index169 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// fetching single chat room by id</code></div><div class="line number171 index170 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">function</code> <code class="php plain">getChatRoom(</code><code class="php variable">$chat_room_id</code><code class="php plain">) {</code></div><div class="line number172 index171 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;conn-&gt;prepare(</code><code class="php string">"SELECT cr.chat_room_id, cr.name, cr.created_at as chat_room_created_at, u.name as username, c.* FROM chat_rooms cr LEFT JOIN messages c ON c.chat_room_id = cr.chat_room_id LEFT JOIN users u ON u.user_id = c.user_id WHERE cr.chat_room_id = ?"</code><code class="php plain">);</code></div><div class="line number173 index172 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;bind_param(</code><code class="php string">"i"</code><code class="php plain">, </code><code class="php variable">$chat_room_id</code><code class="php plain">);</code></div><div class="line number174 index173 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;execute();</code></div><div class="line number175 index174 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tasks</code> <code class="php plain">= </code><code class="php variable">$stmt</code><code class="php plain">-&gt;get_result();</code></div><div class="line number176 index175 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;close();</code></div><div class="line number177 index176 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$tasks</code><code class="php plain">;</code></div><div class="line number178 index177 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number179 index178 alt2">&nbsp;</div><div class="line number180 index179 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">/**</code></div><div class="line number181 index180 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">* Checking for duplicate user by email address</code></div><div class="line number182 index181 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">* @param String $email email to check in db</code></div><div class="line number183 index182 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">* @return boolean</code></div><div class="line number184 index183 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">*/</code></div><div class="line number185 index184 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">private</code> <code class="php keyword">function</code> <code class="php plain">isUserExists(</code><code class="php variable">$email</code><code class="php plain">) {</code></div><div class="line number186 index185 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;conn-&gt;prepare(</code><code class="php string">"SELECT user_id from users WHERE email = ?"</code><code class="php plain">);</code></div><div class="line number187 index186 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;bind_param(</code><code class="php string">"s"</code><code class="php plain">, </code><code class="php variable">$email</code><code class="php plain">);</code></div><div class="line number188 index187 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;execute();</code></div><div class="line number189 index188 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;store_result();</code></div><div class="line number190 index189 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$num_rows</code> <code class="php plain">= </code><code class="php variable">$stmt</code><code class="php plain">-&gt;num_rows;</code></div><div class="line number191 index190 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;close();</code></div><div class="line number192 index191 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$num_rows</code> <code class="php plain">&gt; 0;</code></div><div class="line number193 index192 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number194 index193 alt1">&nbsp;</div><div class="line number195 index194 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">/**</code></div><div class="line number196 index195 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">* Fetching user by email</code></div><div class="line number197 index196 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">* @param String $email User email id</code></div><div class="line number198 index197 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">*/</code></div><div class="line number199 index198 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">getUserByEmail(</code><code class="php variable">$email</code><code class="php plain">) {</code></div><div class="line number200 index199 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;conn-&gt;prepare(</code><code class="php string">"SELECT user_id, name, email, created_at FROM users WHERE email = ?"</code><code class="php plain">);</code></div><div class="line number201 index200 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;bind_param(</code><code class="php string">"s"</code><code class="php plain">, </code><code class="php variable">$email</code><code class="php plain">);</code></div><div class="line number202 index201 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$stmt</code><code class="php plain">-&gt;execute()) {</code></div><div class="line number203 index202 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// $user = $stmt-&gt;get_result()-&gt;fetch_assoc();</code></div><div class="line number204 index203 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;bind_result(</code><code class="php variable">$user_id</code><code class="php plain">, </code><code class="php variable">$name</code><code class="php plain">, </code><code class="php variable">$email</code><code class="php plain">, </code><code class="php variable">$created_at</code><code class="php plain">);</code></div><div class="line number205 index204 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;fetch();</code></div><div class="line number206 index205 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number207 index206 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">"user_id"</code><code class="php plain">] = </code><code class="php variable">$user_id</code><code class="php plain">;</code></div><div class="line number208 index207 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">"name"</code><code class="php plain">] = </code><code class="php variable">$name</code><code class="php plain">;</code></div><div class="line number209 index208 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">"email"</code><code class="php plain">] = </code><code class="php variable">$email</code><code class="php plain">;</code></div><div class="line number210 index209 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">"created_at"</code><code class="php plain">] = </code><code class="php variable">$created_at</code><code class="php plain">;</code></div><div class="line number211 index210 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;close();</code></div><div class="line number212 index211 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$user</code><code class="php plain">;</code></div><div class="line number213 index212 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">} </code><code class="php keyword">else</code> <code class="php plain">{</code></div><div class="line number214 index213 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php plain">NULL;</code></div><div class="line number215 index214 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number216 index215 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number217 index216 alt2">&nbsp;</div><div class="line number218 index217 alt1"><code class="php plain">}</code></div><div class="line number219 index218 alt2">&nbsp;</div><div class="line number220 index219 alt1"><code class="php plain">?&gt;</code></div></div></td></tr></tbody></table></div></div>
<p>
<strong>8</strong>. Now let’s start creating the files required for GCM. Create a file named <strong>gcm.php</strong> inside <strong>libs ⇒ gcm</strong> folder. This file contains necessary functions required to interact with GCM server. These functions basically makes a CURL request to GCM server by passing required parameters in order to invoke a push notification.</p>
<p><em>send()</em> – Function sends push notification to a single user</p>
<p><em>sendToTopic()</em> – Sends push notification to a topic</p>
<p><em>sendToMultiple()</em> – Send push notification to multiple users</p>
<div><div id="highlighter_116699" class="syntaxhighlighter nogutter  php"><table border="0" cellpadding="0" cellspacing="0"><caption>gcm.php</caption><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">&lt;?php</code></div><div class="line number2 index1 alt1"><code class="php keyword">class</code> <code class="php plain">GCM {</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// constructor</code></div><div class="line number5 index4 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">function</code> <code class="php plain">__construct() {</code></div><div class="line number6 index5 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number7 index6 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// sending push message to single user by gcm registration id</code></div><div class="line number10 index9 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">send(</code><code class="php variable">$to</code><code class="php plain">, </code><code class="php variable">$message</code><code class="php plain">) {</code></div><div class="line number11 index10 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$fields</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">(</code></div><div class="line number12 index11 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php string">'to'</code> <code class="php plain">=&gt; </code><code class="php variable">$to</code><code class="php plain">,</code></div><div class="line number13 index12 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php string">'data'</code> <code class="php plain">=&gt; </code><code class="php variable">$message</code><code class="php plain">,</code></div><div class="line number14 index13 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">);</code></div><div class="line number15 index14 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$this</code><code class="php plain">-&gt;sendPushNotification(</code><code class="php variable">$fields</code><code class="php plain">);</code></div><div class="line number16 index15 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// Sending message to a topic by topic id</code></div><div class="line number19 index18 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">sendToTopic(</code><code class="php variable">$to</code><code class="php plain">, </code><code class="php variable">$message</code><code class="php plain">) {</code></div><div class="line number20 index19 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$fields</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">(</code></div><div class="line number21 index20 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php string">'to'</code> <code class="php plain">=&gt; </code><code class="php string">'/topics/'</code> <code class="php plain">. </code><code class="php variable">$to</code><code class="php plain">,</code></div><div class="line number22 index21 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php string">'data'</code> <code class="php plain">=&gt; </code><code class="php variable">$message</code><code class="php plain">,</code></div><div class="line number23 index22 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">);</code></div><div class="line number24 index23 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$this</code><code class="php plain">-&gt;sendPushNotification(</code><code class="php variable">$fields</code><code class="php plain">);</code></div><div class="line number25 index24 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// sending push message to multiple users by gcm registration ids</code></div><div class="line number28 index27 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">sendMultiple(</code><code class="php variable">$registration_ids</code><code class="php plain">, </code><code class="php variable">$message</code><code class="php plain">) {</code></div><div class="line number29 index28 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$fields</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">(</code></div><div class="line number30 index29 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php string">'registration_ids'</code> <code class="php plain">=&gt; </code><code class="php variable">$registration_ids</code><code class="php plain">,</code></div><div class="line number31 index30 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php string">'data'</code> <code class="php plain">=&gt; </code><code class="php variable">$message</code><code class="php plain">,</code></div><div class="line number32 index31 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">);</code></div><div class="line number33 index32 alt2">&nbsp;</div><div class="line number34 index33 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$this</code><code class="php plain">-&gt;sendPushNotification(</code><code class="php variable">$fields</code><code class="php plain">);</code></div><div class="line number35 index34 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number36 index35 alt1">&nbsp;</div><div class="line number37 index36 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// function makes curl request to gcm servers</code></div><div class="line number38 index37 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">private</code> <code class="php keyword">function</code> <code class="php plain">sendPushNotification(</code><code class="php variable">$fields</code><code class="php plain">) {</code></div><div class="line number39 index38 alt2">&nbsp;</div><div class="line number40 index39 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// include config</code></div><div class="line number41 index40 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">include_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../../include/config.php'</code><code class="php plain">;</code></div><div class="line number42 index41 alt1">&nbsp;</div><div class="line number43 index42 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// Set POST variables</code></div><div class="line number44 index43 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$url</code> <code class="php plain">= </code><code class="php string">'<a href="https://gcm-http.googleapis.com/gcm/send">https://gcm-http.googleapis.com/gcm/send</a>'</code><code class="php plain">;</code></div><div class="line number45 index44 alt2">&nbsp;</div><div class="line number46 index45 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$headers</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">(</code></div><div class="line number47 index46 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php string">'Authorization: key='</code> <code class="php plain">. GOOGLE_API_KEY,</code></div><div class="line number48 index47 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php string">'Content-Type: application/json'</code></div><div class="line number49 index48 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">);</code></div><div class="line number50 index49 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// Open connection</code></div><div class="line number51 index50 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$ch</code> <code class="php plain">= curl_init();</code></div><div class="line number52 index51 alt1">&nbsp;</div><div class="line number53 index52 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// Set the url, number of POST vars, POST data</code></div><div class="line number54 index53 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">curl_setopt(</code><code class="php variable">$ch</code><code class="php plain">, CURLOPT_URL, </code><code class="php variable">$url</code><code class="php plain">);</code></div><div class="line number55 index54 alt2">&nbsp;</div><div class="line number56 index55 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">curl_setopt(</code><code class="php variable">$ch</code><code class="php plain">, CURLOPT_POST, true);</code></div><div class="line number57 index56 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">curl_setopt(</code><code class="php variable">$ch</code><code class="php plain">, CURLOPT_HTTPHEADER, </code><code class="php variable">$headers</code><code class="php plain">);</code></div><div class="line number58 index57 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">curl_setopt(</code><code class="php variable">$ch</code><code class="php plain">, CURLOPT_RETURNTRANSFER, true);</code></div><div class="line number59 index58 alt2">&nbsp;</div><div class="line number60 index59 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// Disabling SSL Certificate support temporarly</code></div><div class="line number61 index60 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">curl_setopt(</code><code class="php variable">$ch</code><code class="php plain">, CURLOPT_SSL_VERIFYPEER, false);</code></div><div class="line number62 index61 alt1">&nbsp;</div><div class="line number63 index62 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">curl_setopt(</code><code class="php variable">$ch</code><code class="php plain">, CURLOPT_POSTFIELDS, json_encode(</code><code class="php variable">$fields</code><code class="php plain">));</code></div><div class="line number64 index63 alt1">&nbsp;</div><div class="line number65 index64 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// Execute post</code></div><div class="line number66 index65 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$result</code> <code class="php plain">= curl_exec(</code><code class="php variable">$ch</code><code class="php plain">);</code></div><div class="line number67 index66 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$result</code> <code class="php plain">=== FALSE) {</code></div><div class="line number68 index67 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">die</code><code class="php plain">(</code><code class="php string">'Curl failed: '</code> <code class="php plain">. curl_error(</code><code class="php variable">$ch</code><code class="php plain">));</code></div><div class="line number69 index68 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number70 index69 alt1">&nbsp;</div><div class="line number71 index70 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// Close connection</code></div><div class="line number72 index71 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">curl_close(</code><code class="php variable">$ch</code><code class="php plain">);</code></div><div class="line number73 index72 alt2">&nbsp;</div><div class="line number74 index73 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$result</code><code class="php plain">;</code></div><div class="line number75 index74 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number76 index75 alt1">&nbsp;</div><div class="line number77 index76 alt2"><code class="php plain">}</code></div><div class="line number78 index77 alt1">&nbsp;</div><div class="line number79 index78 alt2"><code class="php plain">?&gt;</code></div></div></td></tr></tbody></table></div></div>
<p>
<strong>9</strong>. Under <strong>libs ⇒ gcm</strong>, create another file named <strong>push.php</strong>. This class prepares the required json format that is transferred as a push message to device. If you want to add additional fields to json, you need to add them in this class.</p>
<div><div id="highlighter_485067" class="syntaxhighlighter nogutter  php"><table border="0" cellpadding="0" cellspacing="0"><caption>push.php</caption><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">&lt;?php</code></div><div class="line number2 index1 alt1"><code class="php comments">/**</code></div><div class="line number3 index2 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">* @author Ravi Tamada</code></div><div class="line number4 index3 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">* @link URL Tutorial link</code></div><div class="line number5 index4 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">*/</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="php keyword">class</code> <code class="php plain">Push{</code></div><div class="line number8 index7 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// push message title</code></div><div class="line number9 index8 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">private</code> <code class="php variable">$title</code><code class="php plain">;</code></div><div class="line number10 index9 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number11 index10 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// push message payload</code></div><div class="line number12 index11 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">private</code> <code class="php variable">$data</code><code class="php plain">;</code></div><div class="line number13 index12 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number14 index13 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// flag indicating background task on push received</code></div><div class="line number15 index14 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">private</code> <code class="php variable">$is_background</code><code class="php plain">;</code></div><div class="line number16 index15 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number17 index16 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// flag to indicate the type of notification</code></div><div class="line number18 index17 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">private</code> <code class="php variable">$flag</code><code class="php plain">;</code></div><div class="line number19 index18 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number20 index19 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">function</code> <code class="php plain">__construct() {</code></div><div class="line number21 index20 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number22 index21 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number23 index22 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number24 index23 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">setTitle(</code><code class="php variable">$title</code><code class="php plain">){</code></div><div class="line number25 index24 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$this</code><code class="php plain">-&gt;title = </code><code class="php variable">$title</code><code class="php plain">;</code></div><div class="line number26 index25 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number27 index26 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number28 index27 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">setData(</code><code class="php variable">$data</code><code class="php plain">){</code></div><div class="line number29 index28 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$this</code><code class="php plain">-&gt;data = </code><code class="php variable">$data</code><code class="php plain">;</code></div><div class="line number30 index29 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number31 index30 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number32 index31 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">setIsBackground(</code><code class="php variable">$is_background</code><code class="php plain">){</code></div><div class="line number33 index32 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$this</code><code class="php plain">-&gt;is_background = </code><code class="php variable">$is_background</code><code class="php plain">;</code></div><div class="line number34 index33 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number35 index34 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number36 index35 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">setFlag(</code><code class="php variable">$flag</code><code class="php plain">){</code></div><div class="line number37 index36 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$this</code><code class="php plain">-&gt;flag = </code><code class="php variable">$flag</code><code class="php plain">;</code></div><div class="line number38 index37 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number39 index38 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number40 index39 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">getPush(){</code></div><div class="line number41 index40 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$res</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number42 index41 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$res</code><code class="php plain">[</code><code class="php string">'title'</code><code class="php plain">] = </code><code class="php variable">$this</code><code class="php plain">-&gt;title;</code></div><div class="line number43 index42 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$res</code><code class="php plain">[</code><code class="php string">'is_background'</code><code class="php plain">] = </code><code class="php variable">$this</code><code class="php plain">-&gt;is_background;</code></div><div class="line number44 index43 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$res</code><code class="php plain">[</code><code class="php string">'flag'</code><code class="php plain">] = </code><code class="php variable">$this</code><code class="php plain">-&gt;flag;</code></div><div class="line number45 index44 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$res</code><code class="php plain">[</code><code class="php string">'data'</code><code class="php plain">] = </code><code class="php variable">$this</code><code class="php plain">-&gt;data;</code></div><div class="line number46 index45 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number47 index46 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$res</code><code class="php plain">;</code></div><div class="line number48 index47 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number49 index48 alt2"><code class="php plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>
<strong>10</strong>. At this stage, we have all the necessary functions ready. Let’s start preparing the REST API endpoints for the android app. Create a file named <strong>.htaccess</strong> inside <strong>v1</strong> folder and add below rules.</p>
<div><div id="highlighter_102947" class="syntaxhighlighter nogutter  php"><table border="0" cellpadding="0" cellspacing="0"><caption>.htaccess</caption><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">RewriteEngine On </code></div><div class="line number2 index1 alt1"><code class="php plain">RewriteCond %{REQUEST_FILENAME} !-f </code></div><div class="line number3 index2 alt2"><code class="php plain">RewriteRule ^(.*)$ %{ENV:BASE}index.php [QSA,L]</code></div></div></td></tr></tbody></table></div></div>
<p>
<strong>11</strong>. Create <strong>index.php</strong> inside <strong>v1</strong> folder. All the rest api requests will be handled by this file only.</p>
<div><div id="highlighter_359459" class="syntaxhighlighter nogutter  php"><table border="0" cellpadding="0" cellspacing="0"><caption>v1/index.php</caption><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">&lt;?php</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="php functions">error_reporting</code><code class="php plain">(-1);</code></div><div class="line number4 index3 alt1"><code class="php functions">ini_set</code><code class="php plain">(</code><code class="php string">'display_errors'</code><code class="php plain">, </code><code class="php string">'On'</code><code class="php plain">);</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="php keyword">require_once</code> <code class="php string">'../include/db_handler.php'</code><code class="php plain">;</code></div><div class="line number7 index6 alt2"><code class="php keyword">require</code> <code class="php string">'.././libs/Slim/Slim.php'</code><code class="php plain">;</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="php plain">\Slim\Slim::registerAutoloader();</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="php variable">$app</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">\Slim\Slim();</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="php comments">// User login</code></div><div class="line number14 index13 alt1"><code class="php variable">$app</code><code class="php plain">-&gt;post(</code><code class="php string">'/user/login'</code><code class="php plain">, </code><code class="php keyword">function</code><code class="php plain">() </code><code class="php keyword">use</code> <code class="php plain">(</code><code class="php variable">$app</code><code class="php plain">) {</code></div><div class="line number15 index14 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// check for required params</code></div><div class="line number16 index15 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">verifyRequiredParams(</code><code class="php keyword">array</code><code class="php plain">(</code><code class="php string">'name'</code><code class="php plain">, </code><code class="php string">'email'</code><code class="php plain">));</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// reading post params</code></div><div class="line number19 index18 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$name</code> <code class="php plain">= </code><code class="php variable">$app</code><code class="php plain">-&gt;request-&gt;post(</code><code class="php string">'name'</code><code class="php plain">);</code></div><div class="line number20 index19 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$email</code> <code class="php plain">= </code><code class="php variable">$app</code><code class="php plain">-&gt;request-&gt;post(</code><code class="php string">'email'</code><code class="php plain">);</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// validating email address</code></div><div class="line number23 index22 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">validateEmail(</code><code class="php variable">$email</code><code class="php plain">);</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$db</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">DbHandler();</code></div><div class="line number26 index25 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code> <code class="php plain">= </code><code class="php variable">$db</code><code class="php plain">-&gt;createUser(</code><code class="php variable">$name</code><code class="php plain">, </code><code class="php variable">$email</code><code class="php plain">);</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// echo json response</code></div><div class="line number29 index28 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">echoRespnse(200, </code><code class="php variable">$response</code><code class="php plain">);</code></div><div class="line number30 index29 alt1"><code class="php plain">});</code></div><div class="line number31 index30 alt2">&nbsp;</div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="php comments">/* * *</code></div><div class="line number34 index33 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">* Updating user</code></div><div class="line number35 index34 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">*&nbsp; we use this url to update user's gcm registration id</code></div><div class="line number36 index35 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">*/</code></div><div class="line number37 index36 alt2"><code class="php variable">$app</code><code class="php plain">-&gt;put(</code><code class="php string">'/user/:id'</code><code class="php plain">, </code><code class="php keyword">function</code><code class="php plain">(</code><code class="php variable">$user_id</code><code class="php plain">) </code><code class="php keyword">use</code> <code class="php plain">(</code><code class="php variable">$app</code><code class="php plain">) {</code></div><div class="line number38 index37 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">global</code> <code class="php variable">$app</code><code class="php plain">;</code></div><div class="line number39 index38 alt2">&nbsp;</div><div class="line number40 index39 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">verifyRequiredParams(</code><code class="php keyword">array</code><code class="php plain">(</code><code class="php string">'gcm_registration_id'</code><code class="php plain">));</code></div><div class="line number41 index40 alt2">&nbsp;</div><div class="line number42 index41 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$gcm_registration_id</code> <code class="php plain">= </code><code class="php variable">$app</code><code class="php plain">-&gt;request-&gt;put(</code><code class="php string">'gcm_registration_id'</code><code class="php plain">);</code></div><div class="line number43 index42 alt2">&nbsp;</div><div class="line number44 index43 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$db</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">DbHandler();</code></div><div class="line number45 index44 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code> <code class="php plain">= </code><code class="php variable">$db</code><code class="php plain">-&gt;updateGcmID(</code><code class="php variable">$user_id</code><code class="php plain">, </code><code class="php variable">$gcm_registration_id</code><code class="php plain">);</code></div><div class="line number46 index45 alt1">&nbsp;</div><div class="line number47 index46 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">echoRespnse(200, </code><code class="php variable">$response</code><code class="php plain">);</code></div><div class="line number48 index47 alt1"><code class="php plain">});</code></div><div class="line number49 index48 alt2">&nbsp;</div><div class="line number50 index49 alt1"><code class="php comments">/* * *</code></div><div class="line number51 index50 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">* fetching all chat rooms</code></div><div class="line number52 index51 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">*/</code></div><div class="line number53 index52 alt2"><code class="php variable">$app</code><code class="php plain">-&gt;get(</code><code class="php string">'/chat_rooms'</code><code class="php plain">, </code><code class="php keyword">function</code><code class="php plain">() {</code></div><div class="line number54 index53 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number55 index54 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$db</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">DbHandler();</code></div><div class="line number56 index55 alt1">&nbsp;</div><div class="line number57 index56 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// fetching all user tasks</code></div><div class="line number58 index57 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$result</code> <code class="php plain">= </code><code class="php variable">$db</code><code class="php plain">-&gt;getAllChatrooms();</code></div><div class="line number59 index58 alt2">&nbsp;</div><div class="line number60 index59 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"error"</code><code class="php plain">] = false;</code></div><div class="line number61 index60 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"chat_rooms"</code><code class="php plain">] = </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number62 index61 alt1">&nbsp;</div><div class="line number63 index62 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// pushing single chat room into array</code></div><div class="line number64 index63 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">while</code> <code class="php plain">(</code><code class="php variable">$chat_room</code> <code class="php plain">= </code><code class="php variable">$result</code><code class="php plain">-&gt;fetch_assoc()) {</code></div><div class="line number65 index64 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number66 index65 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code><code class="php plain">[</code><code class="php string">"chat_room_id"</code><code class="php plain">] = </code><code class="php variable">$chat_room</code><code class="php plain">[</code><code class="php string">"chat_room_id"</code><code class="php plain">];</code></div><div class="line number67 index66 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code><code class="php plain">[</code><code class="php string">"name"</code><code class="php plain">] = </code><code class="php variable">$chat_room</code><code class="php plain">[</code><code class="php string">"name"</code><code class="php plain">];</code></div><div class="line number68 index67 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code><code class="php plain">[</code><code class="php string">"created_at"</code><code class="php plain">] = </code><code class="php variable">$chat_room</code><code class="php plain">[</code><code class="php string">"created_at"</code><code class="php plain">];</code></div><div class="line number69 index68 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php functions">array_push</code><code class="php plain">(</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"chat_rooms"</code><code class="php plain">], </code><code class="php variable">$tmp</code><code class="php plain">);</code></div><div class="line number70 index69 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number71 index70 alt2">&nbsp;</div><div class="line number72 index71 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">echoRespnse(200, </code><code class="php variable">$response</code><code class="php plain">);</code></div><div class="line number73 index72 alt2"><code class="php plain">});</code></div><div class="line number74 index73 alt1">&nbsp;</div><div class="line number75 index74 alt2"><code class="php comments">/**</code></div><div class="line number76 index75 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">* Messaging in a chat room</code></div><div class="line number77 index76 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">* Will send push notification using Topic Messaging</code></div><div class="line number78 index77 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">*&nbsp; */</code></div><div class="line number79 index78 alt2"><code class="php variable">$app</code><code class="php plain">-&gt;post(</code><code class="php string">'/chat_rooms/:id/message'</code><code class="php plain">, </code><code class="php keyword">function</code><code class="php plain">(</code><code class="php variable">$chat_room_id</code><code class="php plain">) {</code></div><div class="line number80 index79 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">global</code> <code class="php variable">$app</code><code class="php plain">;</code></div><div class="line number81 index80 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$db</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">DbHandler();</code></div><div class="line number82 index81 alt1">&nbsp;</div><div class="line number83 index82 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">verifyRequiredParams(</code><code class="php keyword">array</code><code class="php plain">(</code><code class="php string">'user_id'</code><code class="php plain">, </code><code class="php string">'message'</code><code class="php plain">));</code></div><div class="line number84 index83 alt1">&nbsp;</div><div class="line number85 index84 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user_id</code> <code class="php plain">= </code><code class="php variable">$app</code><code class="php plain">-&gt;request-&gt;post(</code><code class="php string">'user_id'</code><code class="php plain">);</code></div><div class="line number86 index85 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$message</code> <code class="php plain">= </code><code class="php variable">$app</code><code class="php plain">-&gt;request-&gt;post(</code><code class="php string">'message'</code><code class="php plain">);</code></div><div class="line number87 index86 alt2">&nbsp;</div><div class="line number88 index87 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code> <code class="php plain">= </code><code class="php variable">$db</code><code class="php plain">-&gt;addMessage(</code><code class="php variable">$user_id</code><code class="php plain">, </code><code class="php variable">$chat_room_id</code><code class="php plain">, </code><code class="php variable">$message</code><code class="php plain">);</code></div><div class="line number89 index88 alt2">&nbsp;</div><div class="line number90 index89 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'error'</code><code class="php plain">] == false) {</code></div><div class="line number91 index90 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/gcm.php'</code><code class="php plain">;</code></div><div class="line number92 index91 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/push.php'</code><code class="php plain">;</code></div><div class="line number93 index92 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$gcm</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">GCM();</code></div><div class="line number94 index93 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">Push();</code></div><div class="line number95 index94 alt2">&nbsp;</div><div class="line number96 index95 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// get the user using userid</code></div><div class="line number97 index96 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code> <code class="php plain">= </code><code class="php variable">$db</code><code class="php plain">-&gt;getUser(</code><code class="php variable">$user_id</code><code class="php plain">);</code></div><div class="line number98 index97 alt1">&nbsp;</div><div class="line number99 index98 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number100 index99 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'user'</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">;</code></div><div class="line number101 index100 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">] = </code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">];</code></div><div class="line number102 index101 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'chat_room_id'</code><code class="php plain">] = </code><code class="php variable">$chat_room_id</code><code class="php plain">;</code></div><div class="line number103 index102 alt2">&nbsp;</div><div class="line number104 index103 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setTitle(</code><code class="php string">"Google Cloud Messaging"</code><code class="php plain">);</code></div><div class="line number105 index104 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setIsBackground(FALSE);</code></div><div class="line number106 index105 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setFlag(PUSH_FLAG_CHATROOM);</code></div><div class="line number107 index106 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setData(</code><code class="php variable">$data</code><code class="php plain">);</code></div><div class="line number108 index107 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number109 index108 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// echo json_encode($push-&gt;getPush());exit;</code></div><div class="line number110 index109 alt1">&nbsp;</div><div class="line number111 index110 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// sending push message to a topic</code></div><div class="line number112 index111 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$gcm</code><code class="php plain">-&gt;sendToTopic(</code><code class="php string">'topic_'</code> <code class="php plain">. </code><code class="php variable">$chat_room_id</code><code class="php plain">, </code><code class="php variable">$push</code><code class="php plain">-&gt;getPush());</code></div><div class="line number113 index112 alt2">&nbsp;</div><div class="line number114 index113 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'user'</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">;</code></div><div class="line number115 index114 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'error'</code><code class="php plain">] = false;</code></div><div class="line number116 index115 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number117 index116 alt2">&nbsp;</div><div class="line number118 index117 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">echoRespnse(200, </code><code class="php variable">$response</code><code class="php plain">);</code></div><div class="line number119 index118 alt2"><code class="php plain">});</code></div><div class="line number120 index119 alt1">&nbsp;</div><div class="line number121 index120 alt2">&nbsp;</div><div class="line number122 index121 alt1"><code class="php comments">/**</code></div><div class="line number123 index122 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">* Sending push notification to a single user</code></div><div class="line number124 index123 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">* We use user's gcm registration id to send the message</code></div><div class="line number125 index124 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">* * */</code></div><div class="line number126 index125 alt1"><code class="php variable">$app</code><code class="php plain">-&gt;post(</code><code class="php string">'/users/:id/message'</code><code class="php plain">, </code><code class="php keyword">function</code><code class="php plain">(</code><code class="php variable">$to_user_id</code><code class="php plain">) {</code></div><div class="line number127 index126 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">global</code> <code class="php variable">$app</code><code class="php plain">;</code></div><div class="line number128 index127 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$db</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">DbHandler();</code></div><div class="line number129 index128 alt2">&nbsp;</div><div class="line number130 index129 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">verifyRequiredParams(</code><code class="php keyword">array</code><code class="php plain">(</code><code class="php string">'message'</code><code class="php plain">));</code></div><div class="line number131 index130 alt2">&nbsp;</div><div class="line number132 index131 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$from_user_id</code> <code class="php plain">= </code><code class="php variable">$app</code><code class="php plain">-&gt;request-&gt;post(</code><code class="php string">'user_id'</code><code class="php plain">);</code></div><div class="line number133 index132 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$message</code> <code class="php plain">= </code><code class="php variable">$app</code><code class="php plain">-&gt;request-&gt;post(</code><code class="php string">'message'</code><code class="php plain">);</code></div><div class="line number134 index133 alt1">&nbsp;</div><div class="line number135 index134 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code> <code class="php plain">= </code><code class="php variable">$db</code><code class="php plain">-&gt;addMessage(</code><code class="php variable">$from_user_id</code><code class="php plain">, </code><code class="php variable">$to_user_id</code><code class="php plain">, </code><code class="php variable">$message</code><code class="php plain">);</code></div><div class="line number136 index135 alt1">&nbsp;</div><div class="line number137 index136 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'error'</code><code class="php plain">] == false) {</code></div><div class="line number138 index137 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/gcm.php'</code><code class="php plain">;</code></div><div class="line number139 index138 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/push.php'</code><code class="php plain">;</code></div><div class="line number140 index139 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$gcm</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">GCM();</code></div><div class="line number141 index140 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">Push();</code></div><div class="line number142 index141 alt1">&nbsp;</div><div class="line number143 index142 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code> <code class="php plain">= </code><code class="php variable">$db</code><code class="php plain">-&gt;getUser(</code><code class="php variable">$to_user_id</code><code class="php plain">);</code></div><div class="line number144 index143 alt1">&nbsp;</div><div class="line number145 index144 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number146 index145 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'user'</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">;</code></div><div class="line number147 index146 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">] = </code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">];</code></div><div class="line number148 index147 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'image'</code><code class="php plain">] = </code><code class="php string">''</code><code class="php plain">;</code></div><div class="line number149 index148 alt2">&nbsp;</div><div class="line number150 index149 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setTitle(</code><code class="php string">"Google Cloud Messaging"</code><code class="php plain">);</code></div><div class="line number151 index150 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setIsBackground(FALSE);</code></div><div class="line number152 index151 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setFlag(PUSH_FLAG_USER);</code></div><div class="line number153 index152 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setData(</code><code class="php variable">$data</code><code class="php plain">);</code></div><div class="line number154 index153 alt1">&nbsp;</div><div class="line number155 index154 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// sending push message to single user</code></div><div class="line number156 index155 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$gcm</code><code class="php plain">-&gt;send(</code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">'gcm_registration_id'</code><code class="php plain">], </code><code class="php variable">$push</code><code class="php plain">-&gt;getPush());</code></div><div class="line number157 index156 alt2">&nbsp;</div><div class="line number158 index157 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'user'</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">;</code></div><div class="line number159 index158 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'error'</code><code class="php plain">] = false;</code></div><div class="line number160 index159 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number161 index160 alt2">&nbsp;</div><div class="line number162 index161 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">echoRespnse(200, </code><code class="php variable">$response</code><code class="php plain">);</code></div><div class="line number163 index162 alt2"><code class="php plain">});</code></div><div class="line number164 index163 alt1">&nbsp;</div><div class="line number165 index164 alt2">&nbsp;</div><div class="line number166 index165 alt1"><code class="php comments">/**</code></div><div class="line number167 index166 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">* Sending push notification to multiple users</code></div><div class="line number168 index167 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">* We use gcm registration ids to send notification message</code></div><div class="line number169 index168 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">* At max you can send message to 1000 recipients</code></div><div class="line number170 index169 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">* * */</code></div><div class="line number171 index170 alt2"><code class="php variable">$app</code><code class="php plain">-&gt;post(</code><code class="php string">'/users/message'</code><code class="php plain">, </code><code class="php keyword">function</code><code class="php plain">() </code><code class="php keyword">use</code> <code class="php plain">(</code><code class="php variable">$app</code><code class="php plain">) {</code></div><div class="line number172 index171 alt1">&nbsp;</div><div class="line number173 index172 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number174 index173 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">verifyRequiredParams(</code><code class="php keyword">array</code><code class="php plain">(</code><code class="php string">'user_id'</code><code class="php plain">, </code><code class="php string">'to'</code><code class="php plain">, </code><code class="php string">'message'</code><code class="php plain">));</code></div><div class="line number175 index174 alt2">&nbsp;</div><div class="line number176 index175 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/gcm.php'</code><code class="php plain">;</code></div><div class="line number177 index176 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/push.php'</code><code class="php plain">;</code></div><div class="line number178 index177 alt1">&nbsp;</div><div class="line number179 index178 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$db</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">DbHandler();</code></div><div class="line number180 index179 alt1">&nbsp;</div><div class="line number181 index180 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user_id</code> <code class="php plain">= </code><code class="php variable">$app</code><code class="php plain">-&gt;request-&gt;post(</code><code class="php string">'user_id'</code><code class="php plain">);</code></div><div class="line number182 index181 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$to_user_ids</code> <code class="php plain">= </code><code class="php functions">array_filter</code><code class="php plain">(</code><code class="php functions">explode</code><code class="php plain">(</code><code class="php string">','</code><code class="php plain">, </code><code class="php variable">$app</code><code class="php plain">-&gt;request-&gt;post(</code><code class="php string">'to'</code><code class="php plain">)));</code></div><div class="line number183 index182 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$message</code> <code class="php plain">= </code><code class="php variable">$app</code><code class="php plain">-&gt;request-&gt;post(</code><code class="php string">'message'</code><code class="php plain">);</code></div><div class="line number184 index183 alt1">&nbsp;</div><div class="line number185 index184 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code> <code class="php plain">= </code><code class="php variable">$db</code><code class="php plain">-&gt;getUser(</code><code class="php variable">$user_id</code><code class="php plain">);</code></div><div class="line number186 index185 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$users</code> <code class="php plain">= </code><code class="php variable">$db</code><code class="php plain">-&gt;getUsers(</code><code class="php variable">$to_user_ids</code><code class="php plain">);</code></div><div class="line number187 index186 alt2">&nbsp;</div><div class="line number188 index187 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$registration_ids</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number189 index188 alt2">&nbsp;</div><div class="line number190 index189 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// preparing gcm registration ids array</code></div><div class="line number191 index190 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">foreach</code> <code class="php plain">(</code><code class="php variable">$users</code> <code class="php keyword">as</code> <code class="php variable">$u</code><code class="php plain">) {</code></div><div class="line number192 index191 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php functions">array_push</code><code class="php plain">(</code><code class="php variable">$registration_ids</code><code class="php plain">, </code><code class="php variable">$u</code><code class="php plain">[</code><code class="php string">'gcm_registration_id'</code><code class="php plain">]);</code></div><div class="line number193 index192 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number194 index193 alt1">&nbsp;</div><div class="line number195 index194 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// insert messages in db</code></div><div class="line number196 index195 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// send push to multiple users</code></div><div class="line number197 index196 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$gcm</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">GCM();</code></div><div class="line number198 index197 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">Push();</code></div><div class="line number199 index198 alt2">&nbsp;</div><div class="line number200 index199 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// creating tmp message, skipping database insertion</code></div><div class="line number201 index200 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$msg</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number202 index201 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$msg</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">] = </code><code class="php variable">$message</code><code class="php plain">;</code></div><div class="line number203 index202 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$msg</code><code class="php plain">[</code><code class="php string">'message_id'</code><code class="php plain">] = </code><code class="php string">''</code><code class="php plain">;</code></div><div class="line number204 index203 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$msg</code><code class="php plain">[</code><code class="php string">'chat_room_id'</code><code class="php plain">] = </code><code class="php string">''</code><code class="php plain">;</code></div><div class="line number205 index204 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$msg</code><code class="php plain">[</code><code class="php string">'created_at'</code><code class="php plain">] = </code><code class="php functions">date</code><code class="php plain">(</code><code class="php string">'Y-m-d G:i:s'</code><code class="php plain">);</code></div><div class="line number206 index205 alt1">&nbsp;</div><div class="line number207 index206 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number208 index207 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'user'</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">;</code></div><div class="line number209 index208 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">] = </code><code class="php variable">$msg</code><code class="php plain">;</code></div><div class="line number210 index209 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'image'</code><code class="php plain">] = </code><code class="php string">''</code><code class="php plain">;</code></div><div class="line number211 index210 alt2">&nbsp;</div><div class="line number212 index211 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setTitle(</code><code class="php string">"Google Cloud Messaging"</code><code class="php plain">);</code></div><div class="line number213 index212 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setIsBackground(FALSE);</code></div><div class="line number214 index213 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setFlag(PUSH_FLAG_USER);</code></div><div class="line number215 index214 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setData(</code><code class="php variable">$data</code><code class="php plain">);</code></div><div class="line number216 index215 alt1">&nbsp;</div><div class="line number217 index216 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// sending push message to multiple users</code></div><div class="line number218 index217 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$gcm</code><code class="php plain">-&gt;sendMultiple(</code><code class="php variable">$registration_ids</code><code class="php plain">, </code><code class="php variable">$push</code><code class="php plain">-&gt;getPush());</code></div><div class="line number219 index218 alt2">&nbsp;</div><div class="line number220 index219 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'error'</code><code class="php plain">] = false;</code></div><div class="line number221 index220 alt2">&nbsp;</div><div class="line number222 index221 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">echoRespnse(200, </code><code class="php variable">$response</code><code class="php plain">);</code></div><div class="line number223 index222 alt2"><code class="php plain">});</code></div><div class="line number224 index223 alt1">&nbsp;</div><div class="line number225 index224 alt2"><code class="php variable">$app</code><code class="php plain">-&gt;post(</code><code class="php string">'/users/send_to_all'</code><code class="php plain">, </code><code class="php keyword">function</code><code class="php plain">() </code><code class="php keyword">use</code> <code class="php plain">(</code><code class="php variable">$app</code><code class="php plain">) {</code></div><div class="line number226 index225 alt1">&nbsp;</div><div class="line number227 index226 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number228 index227 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">verifyRequiredParams(</code><code class="php keyword">array</code><code class="php plain">(</code><code class="php string">'user_id'</code><code class="php plain">, </code><code class="php string">'message'</code><code class="php plain">));</code></div><div class="line number229 index228 alt2">&nbsp;</div><div class="line number230 index229 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/gcm.php'</code><code class="php plain">;</code></div><div class="line number231 index230 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/push.php'</code><code class="php plain">;</code></div><div class="line number232 index231 alt1">&nbsp;</div><div class="line number233 index232 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$db</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">DbHandler();</code></div><div class="line number234 index233 alt1">&nbsp;</div><div class="line number235 index234 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user_id</code> <code class="php plain">= </code><code class="php variable">$app</code><code class="php plain">-&gt;request-&gt;post(</code><code class="php string">'user_id'</code><code class="php plain">);</code></div><div class="line number236 index235 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$message</code> <code class="php plain">= </code><code class="php variable">$app</code><code class="php plain">-&gt;request-&gt;post(</code><code class="php string">'message'</code><code class="php plain">);</code></div><div class="line number237 index236 alt2">&nbsp;</div><div class="line number238 index237 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/gcm.php'</code><code class="php plain">;</code></div><div class="line number239 index238 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/push.php'</code><code class="php plain">;</code></div><div class="line number240 index239 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$gcm</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">GCM();</code></div><div class="line number241 index240 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">Push();</code></div><div class="line number242 index241 alt1">&nbsp;</div><div class="line number243 index242 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// get the user using userid</code></div><div class="line number244 index243 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code> <code class="php plain">= </code><code class="php variable">$db</code><code class="php plain">-&gt;getUser(</code><code class="php variable">$user_id</code><code class="php plain">);</code></div><div class="line number245 index244 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number246 index245 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// creating tmp message, skipping database insertion</code></div><div class="line number247 index246 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$msg</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number248 index247 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$msg</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">] = </code><code class="php variable">$message</code><code class="php plain">;</code></div><div class="line number249 index248 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$msg</code><code class="php plain">[</code><code class="php string">'message_id'</code><code class="php plain">] = </code><code class="php string">''</code><code class="php plain">;</code></div><div class="line number250 index249 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$msg</code><code class="php plain">[</code><code class="php string">'chat_room_id'</code><code class="php plain">] = </code><code class="php string">''</code><code class="php plain">;</code></div><div class="line number251 index250 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$msg</code><code class="php plain">[</code><code class="php string">'created_at'</code><code class="php plain">] = </code><code class="php functions">date</code><code class="php plain">(</code><code class="php string">'Y-m-d G:i:s'</code><code class="php plain">);</code></div><div class="line number252 index251 alt1">&nbsp;</div><div class="line number253 index252 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number254 index253 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'user'</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">;</code></div><div class="line number255 index254 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">] = </code><code class="php variable">$msg</code><code class="php plain">;</code></div><div class="line number256 index255 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'image'</code><code class="php plain">] = </code><code class="php string">'<a href="http://www.androidhive.info/wp-content/uploads/2016/01/Air-1.png">http://www.androidhive.info/wp-content/uploads/2016/01/Air-1.png</a>'</code><code class="php plain">;</code></div><div class="line number257 index256 alt2">&nbsp;</div><div class="line number258 index257 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setTitle(</code><code class="php string">"Google Cloud Messaging"</code><code class="php plain">);</code></div><div class="line number259 index258 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setIsBackground(FALSE);</code></div><div class="line number260 index259 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setFlag(PUSH_FLAG_USER);</code></div><div class="line number261 index260 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$push</code><code class="php plain">-&gt;setData(</code><code class="php variable">$data</code><code class="php plain">);</code></div><div class="line number262 index261 alt1">&nbsp;</div><div class="line number263 index262 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// sending message to topic `global`</code></div><div class="line number264 index263 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// On the device every user should subscribe to `global` topic</code></div><div class="line number265 index264 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$gcm</code><code class="php plain">-&gt;sendToTopic(</code><code class="php string">'global'</code><code class="php plain">, </code><code class="php variable">$push</code><code class="php plain">-&gt;getPush());</code></div><div class="line number266 index265 alt1">&nbsp;</div><div class="line number267 index266 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'user'</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">;</code></div><div class="line number268 index267 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'error'</code><code class="php plain">] = false;</code></div><div class="line number269 index268 alt2">&nbsp;</div><div class="line number270 index269 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">echoRespnse(200, </code><code class="php variable">$response</code><code class="php plain">);</code></div><div class="line number271 index270 alt2"><code class="php plain">});</code></div><div class="line number272 index271 alt1">&nbsp;</div><div class="line number273 index272 alt2"><code class="php comments">/**</code></div><div class="line number274 index273 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">* Fetching single chat room including all the chat messages</code></div><div class="line number275 index274 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">*&nbsp; */</code></div><div class="line number276 index275 alt1"><code class="php variable">$app</code><code class="php plain">-&gt;get(</code><code class="php string">'/chat_rooms/:id'</code><code class="php plain">, </code><code class="php keyword">function</code><code class="php plain">(</code><code class="php variable">$chat_room_id</code><code class="php plain">) {</code></div><div class="line number277 index276 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">global</code> <code class="php variable">$app</code><code class="php plain">;</code></div><div class="line number278 index277 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$db</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">DbHandler();</code></div><div class="line number279 index278 alt2">&nbsp;</div><div class="line number280 index279 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$result</code> <code class="php plain">= </code><code class="php variable">$db</code><code class="php plain">-&gt;getChatRoom(</code><code class="php variable">$chat_room_id</code><code class="php plain">);</code></div><div class="line number281 index280 alt2">&nbsp;</div><div class="line number282 index281 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"error"</code><code class="php plain">] = false;</code></div><div class="line number283 index282 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"messages"</code><code class="php plain">] = </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number284 index283 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'chat_room'</code><code class="php plain">] = </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number285 index284 alt2">&nbsp;</div><div class="line number286 index285 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$i</code> <code class="php plain">= 0;</code></div><div class="line number287 index286 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// looping through result and preparing tasks array</code></div><div class="line number288 index287 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">while</code> <code class="php plain">(</code><code class="php variable">$chat_room</code> <code class="php plain">= </code><code class="php variable">$result</code><code class="php plain">-&gt;fetch_assoc()) {</code></div><div class="line number289 index288 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// adding chat room node</code></div><div class="line number290 index289 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$i</code> <code class="php plain">== 0) {</code></div><div class="line number291 index290 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number292 index291 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code><code class="php plain">[</code><code class="php string">"chat_room_id"</code><code class="php plain">] = </code><code class="php variable">$chat_room</code><code class="php plain">[</code><code class="php string">"chat_room_id"</code><code class="php plain">];</code></div><div class="line number293 index292 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code><code class="php plain">[</code><code class="php string">"name"</code><code class="php plain">] = </code><code class="php variable">$chat_room</code><code class="php plain">[</code><code class="php string">"name"</code><code class="php plain">];</code></div><div class="line number294 index293 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tmp</code><code class="php plain">[</code><code class="php string">"created_at"</code><code class="php plain">] = </code><code class="php variable">$chat_room</code><code class="php plain">[</code><code class="php string">"chat_room_created_at"</code><code class="php plain">];</code></div><div class="line number295 index294 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'chat_room'</code><code class="php plain">] = </code><code class="php variable">$tmp</code><code class="php plain">;</code></div><div class="line number296 index295 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number297 index296 alt2">&nbsp;</div><div class="line number298 index297 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$chat_room</code><code class="php plain">[</code><code class="php string">'user_id'</code><code class="php plain">] != NULL) {</code></div><div class="line number299 index298 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// message node</code></div><div class="line number300 index299 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$cmt</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number301 index300 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$cmt</code><code class="php plain">[</code><code class="php string">"message"</code><code class="php plain">] = </code><code class="php variable">$chat_room</code><code class="php plain">[</code><code class="php string">"message"</code><code class="php plain">];</code></div><div class="line number302 index301 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$cmt</code><code class="php plain">[</code><code class="php string">"message_id"</code><code class="php plain">] = </code><code class="php variable">$chat_room</code><code class="php plain">[</code><code class="php string">"message_id"</code><code class="php plain">];</code></div><div class="line number303 index302 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$cmt</code><code class="php plain">[</code><code class="php string">"created_at"</code><code class="php plain">] = </code><code class="php variable">$chat_room</code><code class="php plain">[</code><code class="php string">"created_at"</code><code class="php plain">];</code></div><div class="line number304 index303 alt1">&nbsp;</div><div class="line number305 index304 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// user node</code></div><div class="line number306 index305 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number307 index306 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">'user_id'</code><code class="php plain">] = </code><code class="php variable">$chat_room</code><code class="php plain">[</code><code class="php string">'user_id'</code><code class="php plain">];</code></div><div class="line number308 index307 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">'username'</code><code class="php plain">] = </code><code class="php variable">$chat_room</code><code class="php plain">[</code><code class="php string">'username'</code><code class="php plain">];</code></div><div class="line number309 index308 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$cmt</code><code class="php plain">[</code><code class="php string">'user'</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">;</code></div><div class="line number310 index309 alt1">&nbsp;</div><div class="line number311 index310 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php functions">array_push</code><code class="php plain">(</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"messages"</code><code class="php plain">], </code><code class="php variable">$cmt</code><code class="php plain">);</code></div><div class="line number312 index311 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number313 index312 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number314 index313 alt1">&nbsp;</div><div class="line number315 index314 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">echoRespnse(200, </code><code class="php variable">$response</code><code class="php plain">);</code></div><div class="line number316 index315 alt1"><code class="php plain">});</code></div><div class="line number317 index316 alt2">&nbsp;</div><div class="line number318 index317 alt1"><code class="php comments">/**</code></div><div class="line number319 index318 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">* Verifying required params posted or not</code></div><div class="line number320 index319 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">*/</code></div><div class="line number321 index320 alt2"><code class="php keyword">function</code> <code class="php plain">verifyRequiredParams(</code><code class="php variable">$required_fields</code><code class="php plain">) {</code></div><div class="line number322 index321 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$error</code> <code class="php plain">= false;</code></div><div class="line number323 index322 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$error_fields</code> <code class="php plain">= </code><code class="php string">""</code><code class="php plain">;</code></div><div class="line number324 index323 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$request_params</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number325 index324 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$request_params</code> <code class="php plain">= </code><code class="php variable">$_REQUEST</code><code class="php plain">;</code></div><div class="line number326 index325 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// Handling PUT request params</code></div><div class="line number327 index326 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$_SERVER</code><code class="php plain">[</code><code class="php string">'REQUEST_METHOD'</code><code class="php plain">] == </code><code class="php string">'PUT'</code><code class="php plain">) {</code></div><div class="line number328 index327 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$app</code> <code class="php plain">= \Slim\Slim::getInstance();</code></div><div class="line number329 index328 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php functions">parse_str</code><code class="php plain">(</code><code class="php variable">$app</code><code class="php plain">-&gt;request()-&gt;getBody(), </code><code class="php variable">$request_params</code><code class="php plain">);</code></div><div class="line number330 index329 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number331 index330 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">foreach</code> <code class="php plain">(</code><code class="php variable">$required_fields</code> <code class="php keyword">as</code> <code class="php variable">$field</code><code class="php plain">) {</code></div><div class="line number332 index331 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(!isset(</code><code class="php variable">$request_params</code><code class="php plain">[</code><code class="php variable">$field</code><code class="php plain">]) || </code><code class="php functions">strlen</code><code class="php plain">(trim(</code><code class="php variable">$request_params</code><code class="php plain">[</code><code class="php variable">$field</code><code class="php plain">])) &lt;= 0) {</code></div><div class="line number333 index332 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$error</code> <code class="php plain">= true;</code></div><div class="line number334 index333 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$error_fields</code> <code class="php plain">.= </code><code class="php variable">$field</code> <code class="php plain">. </code><code class="php string">', '</code><code class="php plain">;</code></div><div class="line number335 index334 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number336 index335 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number337 index336 alt2">&nbsp;</div><div class="line number338 index337 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$error</code><code class="php plain">) {</code></div><div class="line number339 index338 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// Required field(s) are missing or empty</code></div><div class="line number340 index339 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// echo error json and stop the app</code></div><div class="line number341 index340 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number342 index341 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$app</code> <code class="php plain">= \Slim\Slim::getInstance();</code></div><div class="line number343 index342 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"error"</code><code class="php plain">] = true;</code></div><div class="line number344 index343 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"message"</code><code class="php plain">] = </code><code class="php string">'Required field(s) '</code> <code class="php plain">. </code><code class="php functions">substr</code><code class="php plain">(</code><code class="php variable">$error_fields</code><code class="php plain">, 0, -2) . </code><code class="php string">' is missing or empty'</code><code class="php plain">;</code></div><div class="line number345 index344 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">echoRespnse(400, </code><code class="php variable">$response</code><code class="php plain">);</code></div><div class="line number346 index345 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$app</code><code class="php plain">-&gt;stop();</code></div><div class="line number347 index346 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number348 index347 alt1"><code class="php plain">}</code></div><div class="line number349 index348 alt2">&nbsp;</div><div class="line number350 index349 alt1"><code class="php comments">/**</code></div><div class="line number351 index350 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">* Validating email address</code></div><div class="line number352 index351 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">*/</code></div><div class="line number353 index352 alt2"><code class="php keyword">function</code> <code class="php plain">validateEmail(</code><code class="php variable">$email</code><code class="php plain">) {</code></div><div class="line number354 index353 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$app</code> <code class="php plain">= \Slim\Slim::getInstance();</code></div><div class="line number355 index354 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(!filter_var(</code><code class="php variable">$email</code><code class="php plain">, FILTER_VALIDATE_EMAIL)) {</code></div><div class="line number356 index355 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"error"</code><code class="php plain">] = true;</code></div><div class="line number357 index356 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">"message"</code><code class="php plain">] = </code><code class="php string">'Email address is not valid'</code><code class="php plain">;</code></div><div class="line number358 index357 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">echoRespnse(400, </code><code class="php variable">$response</code><code class="php plain">);</code></div><div class="line number359 index358 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$app</code><code class="php plain">-&gt;stop();</code></div><div class="line number360 index359 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number361 index360 alt2"><code class="php plain">}</code></div><div class="line number362 index361 alt1">&nbsp;</div><div class="line number363 index362 alt2"><code class="php keyword">function</code> <code class="php plain">IsNullOrEmptyString(</code><code class="php variable">$str</code><code class="php plain">) {</code></div><div class="line number364 index363 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php plain">(!isset(</code><code class="php variable">$str</code><code class="php plain">) || trim(</code><code class="php variable">$str</code><code class="php plain">) === </code><code class="php string">''</code><code class="php plain">);</code></div><div class="line number365 index364 alt2"><code class="php plain">}</code></div><div class="line number366 index365 alt1">&nbsp;</div><div class="line number367 index366 alt2"><code class="php comments">/**</code></div><div class="line number368 index367 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">* Echoing json response to client</code></div><div class="line number369 index368 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">* @param String $status_code Http response code</code></div><div class="line number370 index369 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">* @param Int $response Json response</code></div><div class="line number371 index370 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">*/</code></div><div class="line number372 index371 alt1"><code class="php keyword">function</code> <code class="php plain">echoRespnse(</code><code class="php variable">$status_code</code><code class="php plain">, </code><code class="php variable">$response</code><code class="php plain">) {</code></div><div class="line number373 index372 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$app</code> <code class="php plain">= \Slim\Slim::getInstance();</code></div><div class="line number374 index373 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// Http response code</code></div><div class="line number375 index374 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$app</code><code class="php plain">-&gt;status(</code><code class="php variable">$status_code</code><code class="php plain">);</code></div><div class="line number376 index375 alt1">&nbsp;</div><div class="line number377 index376 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// setting response content type to json</code></div><div class="line number378 index377 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$app</code><code class="php plain">-&gt;contentType(</code><code class="php string">'application/json'</code><code class="php plain">);</code></div><div class="line number379 index378 alt2">&nbsp;</div><div class="line number380 index379 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php functions">echo</code> <code class="php plain">json_encode(</code><code class="php variable">$response</code><code class="php plain">);</code></div><div class="line number381 index380 alt2"><code class="php plain">}</code></div><div class="line number382 index381 alt1">&nbsp;</div><div class="line number383 index382 alt2"><code class="php variable">$app</code><code class="php plain">-&gt;run();</code></div><div class="line number384 index383 alt1"><code class="php plain">?&gt;</code></div></div></td></tr></tbody></table></div></div>
<p></p>
<div id="changelog">
<strong>REST API Endpoints</strong><p></p>
<!-- Quick Adsense WordPress Plugin: http://quicksense.net/ -->
<div style="float:none;margin:10px 0 10px 0;text-align:center;">
<script async="" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/adsbygoogle.js"></script>
<!-- Middle Content Center -->
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-8479132932764602" data-ad-slot="5326974778" data-adsbygoogle-status="done"><ins id="aswift_2_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><ins id="aswift_2_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><iframe width="336" height="280" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>

<p>The <strong>index.php</strong> inside <strong>v1</strong> folder providers the below endpoints.</p>
<p>Base URL: <strong>http://localhost/gcm_chat/v1</strong></p>
<table border="0" width="100%">
<tbody>
<tr>
<td><strong>Endpoint</strong></td>
<td><strong>Params</strong></td>
<td><strong>Method</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr>
<td>/user/login</td>
<td>name, email</td>
<td>POST</td>
<td>User login or registration</td>
</tr>
<tr>
<td>/user/:id</td>
<td>gcm_registration_id</td>
<td>PUT</td>
<td>Updates user’s gcm registration id in database</td>
</tr>
<tr>
<td>/chat_rooms</td>
<td>–</td>
<td>GET</td>
<td>Fetches all chat rooms</td>
</tr>
<tr>
<td>/chat_rooms/:id</td>
<td>replace :id with actual chat room id</td>
<td>GET</td>
<td>Fetches single chat room messages</td>
</tr>
<tr>
<td>/chat_rooms/:id/message</td>
<td>replace :id with actual chat room id</td>
<td>POST</td>
<td>Posting a message in a chat room</td>
</tr>
<tr>
<td>/users/:id/message</td>
<td>replace :id with actual user id</td>
<td>POST</td>
<td>Sending a message to user</td>
</tr>
<tr>
<td>/users/message</td>
<td>user_id, to, message<br>
`to` – param is user ids separated by comma (,)
</td>
<td>POST</td>
<td>Sending a message to multiple users</td>
</tr>
<tr>
<td>/users/send_to_all</td>
<td>user_id, message</td>
<td>POST</td>
<td>Sending a message to all the users subscribed to `<strong>global</strong>` topic</td>
</tr>
</tbody>
</table>
</div>
<h2>6. Testing the REST API</h2>
<p>Before starting the android project, make sure that the php project is running without any errors. Follow the below steps to test the API.</p>
<p><strong>1</strong>. Enable apache <strong>mod_rewrite</strong> module (<a rel="nofollow" href="http://stackoverflow.com/questions/869092/how-to-enable-mod-rewrite-for-apache-2-2" target="_blank">link</a>)</p>
<p><strong>2</strong>. Enable <strong>curl</strong> extension. This allows php to make http requests from the backend (<a rel="nofollow" href="http://stackoverflow.com/questions/13021536/how-to-enable-curl-in-wamp-server" target="_blank">link</a>).</p>
<p><strong>3</strong>. Install <a rel="nofollow" href="https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop?hl=en" target="_blank">Postman</a> Chrome REST API extension. You can use any other rest api clients too.</p>
<p>The below video takes you through testing the API using Postman.</p>
<div class="yt_video">
<iframe src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/aMBdEO4nZLk.html" frameborder="0" allowfullscreen="" style="width: 719px; height: 444.7265625px;"></iframe>
</div>
<p></p>
<h2>7. Building the Admin Panel</h2>
<p>I created very simple admin panel using PHP, HTML, CSS &amp; jQuery. This admin panel might not be used in production stage, but gives you necessary functions to build a better one.</p>
<p><strong>1</strong>. Create a file named <strong>demo.php</strong> in the root directory of <strong>gcm_chat</strong>. This class contains function for the admin panel.</p>
<div><div id="highlighter_723122" class="syntaxhighlighter nogutter  php"><table border="0" cellpadding="0" cellspacing="0"><caption>demo.php</caption><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">&lt;?php</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="php comments">/**</code></div><div class="line number4 index3 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">* Class to handle all db operations</code></div><div class="line number5 index4 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">* This class will have CRUD methods for database tables</code></div><div class="line number6 index5 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">*</code></div><div class="line number7 index6 alt2"><code class="php spaces">&nbsp;</code><code class="php comments">* @author Ravi Tamada</code></div><div class="line number8 index7 alt1"><code class="php spaces">&nbsp;</code><code class="php comments">*/</code></div><div class="line number9 index8 alt2"><code class="php keyword">class</code> <code class="php plain">Demo {</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">private</code> <code class="php variable">$conn</code><code class="php plain">;</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">function</code> <code class="php plain">__construct() {</code></div><div class="line number14 index13 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">require_once</code> <code class="php plain">dirname(</code><code class="php constants">__FILE__</code><code class="php plain">) . </code><code class="php string">'/include/db_connect.php'</code><code class="php plain">;</code></div><div class="line number15 index14 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// opening db connection</code></div><div class="line number16 index15 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$db</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">DbConnect();</code></div><div class="line number17 index16 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$this</code><code class="php plain">-&gt;conn = </code><code class="php variable">$db</code><code class="php plain">-&gt;connect();</code></div><div class="line number18 index17 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">getAllChatRooms() {</code></div><div class="line number21 index20 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;conn-&gt;prepare(</code><code class="php string">"SELECT * FROM chat_rooms"</code><code class="php plain">);</code></div><div class="line number22 index21 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;execute();</code></div><div class="line number23 index22 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tasks</code> <code class="php plain">= </code><code class="php variable">$stmt</code><code class="php plain">-&gt;get_result();</code></div><div class="line number24 index23 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;close();</code></div><div class="line number25 index24 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$tasks</code><code class="php plain">;</code></div><div class="line number26 index25 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">getAllUsers() {</code></div><div class="line number29 index28 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;conn-&gt;prepare(</code><code class="php string">"SELECT * FROM users"</code><code class="php plain">);</code></div><div class="line number30 index29 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;execute();</code></div><div class="line number31 index30 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$tasks</code> <code class="php plain">= </code><code class="php variable">$stmt</code><code class="php plain">-&gt;get_result();</code></div><div class="line number32 index31 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;close();</code></div><div class="line number33 index32 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$tasks</code><code class="php plain">;</code></div><div class="line number34 index33 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number35 index34 alt2">&nbsp;</div><div class="line number36 index35 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">public</code> <code class="php keyword">function</code> <code class="php plain">getDemoUser() {</code></div><div class="line number37 index36 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$name</code> <code class="php plain">= </code><code class="php string">'AndroidHive'</code><code class="php plain">;</code></div><div class="line number38 index37 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$email</code> <code class="php plain">= </code><code class="php string">'admin@androidhive.info'</code><code class="php plain">;</code></div><div class="line number39 index38 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number40 index39 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;conn-&gt;prepare(</code><code class="php string">"SELECT user_id from users WHERE email = ?"</code><code class="php plain">);</code></div><div class="line number41 index40 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;bind_param(</code><code class="php string">"s"</code><code class="php plain">, </code><code class="php variable">$email</code><code class="php plain">);</code></div><div class="line number42 index41 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;execute();</code></div><div class="line number43 index42 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;store_result();</code></div><div class="line number44 index43 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$num_rows</code> <code class="php plain">= </code><code class="php variable">$stmt</code><code class="php plain">-&gt;num_rows;</code></div><div class="line number45 index44 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$num_rows</code> <code class="php plain">&gt; 0) {</code></div><div class="line number46 index45 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;bind_result(</code><code class="php variable">$user_id</code><code class="php plain">);</code></div><div class="line number47 index46 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;fetch();</code></div><div class="line number48 index47 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$user_id</code><code class="php plain">;</code></div><div class="line number49 index48 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">} </code><code class="php keyword">else</code> <code class="php plain">{</code></div><div class="line number50 index49 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code> <code class="php plain">= </code><code class="php variable">$this</code><code class="php plain">-&gt;conn-&gt;prepare(</code><code class="php string">"INSERT INTO users(name, email) values(?, ?)"</code><code class="php plain">);</code></div><div class="line number51 index50 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;bind_param(</code><code class="php string">"ss"</code><code class="php plain">, </code><code class="php variable">$name</code><code class="php plain">, </code><code class="php variable">$email</code><code class="php plain">);</code></div><div class="line number52 index51 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$result</code> <code class="php plain">= </code><code class="php variable">$stmt</code><code class="php plain">-&gt;execute();</code></div><div class="line number53 index52 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$user_id</code> <code class="php plain">= </code><code class="php variable">$stmt</code><code class="php plain">-&gt;insert_id;</code></div><div class="line number54 index53 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$stmt</code><code class="php plain">-&gt;close();</code></div><div class="line number55 index54 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php variable">$user_id</code><code class="php plain">;</code></div><div class="line number56 index55 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number57 index56 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number58 index57 alt1"><code class="php plain">}</code></div><div class="line number59 index58 alt2"><code class="php plain">?&gt;</code></div></div></td></tr></tbody></table></div></div>
<p><strong>2</strong>. Create a style sheet named <strong>style.css</strong> in the root directory.</p>
<div><div id="highlighter_88984" class="syntaxhighlighter nogutter  css"><table border="0" cellpadding="0" cellspacing="0"><caption>style.css</caption><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="css comments">/* </code></div><div class="line number2 index1 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css comments">Created on : 22 Jan, 2016, 10:12:06 PM</code></div><div class="line number3 index2 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css comments">Author&nbsp;&nbsp;&nbsp;&nbsp; : Ravi Tamada</code></div><div class="line number4 index3 alt1"><code class="css comments">*/</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="css plain">body{</code></div><div class="line number7 index6 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">width</code><code class="css plain">: </code><code class="css value">100%</code><code class="css plain">;</code></div><div class="line number8 index7 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">margin</code><code class="css plain">: </code><code class="css value">0</code><code class="css plain">;</code></div><div class="line number9 index8 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding</code><code class="css plain">: </code><code class="css value">0</code><code class="css plain">;&nbsp;&nbsp; </code></div><div class="line number10 index9 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-family</code><code class="css plain">: </code><code class="css string">'Raleway'</code><code class="css plain">, </code><code class="css color1">sans-serif</code><code class="css plain">;</code></div><div class="line number11 index10 alt2"><code class="css plain">}</code></div><div class="line number12 index11 alt1"><code class="css plain">.container_body{</code></div><div class="line number13 index12 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">width</code><code class="css plain">: </code><code class="css value">1000px</code><code class="css plain">;</code></div><div class="line number14 index13 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">margin</code><code class="css plain">: </code><code class="css value">0</code> <code class="css value">auto</code><code class="css plain">;</code></div><div class="line number15 index14 alt2"><code class="css plain">}</code></div><div class="line number16 index15 alt1"><code class="css plain">.header{</code></div><div class="line number17 index16 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding</code><code class="css plain">: </code><code class="css value">100px</code> <code class="css value">0</code><code class="css plain">;</code></div><div class="line number18 index17 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">text-align</code><code class="css plain">: </code><code class="css value">center</code><code class="css plain">;</code></div><div class="line number19 index18 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">color</code><code class="css plain">: </code><code class="css value">#fff</code><code class="css plain">;</code></div><div class="line number20 index19 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: -moz-radial-gradient(</code><code class="css value">center</code><code class="css plain">, ellipse cover, rgba(</code><code class="css value">227</code><code class="css plain">,</code><code class="css value">71</code><code class="css plain">,</code><code class="css value">73</code><code class="css plain">,</code><code class="css value">1</code><code class="css plain">) </code><code class="css value">0%</code><code class="css plain">, rgba(</code><code class="css value">186</code><code class="css plain">,</code><code class="css value">27</code><code class="css plain">,</code><code class="css value">31</code><code class="css plain">,</code><code class="css value">1</code><code class="css plain">) </code><code class="css value">100%</code><code class="css plain">); </code><code class="css comments">/* ff3.6+ */</code></div><div class="line number21 index20 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: -webkit-gradient(radial, </code><code class="css value">center</code> <code class="css value">center</code><code class="css plain">, </code><code class="css value">0px</code><code class="css plain">, </code><code class="css value">center</code> <code class="css value">center</code><code class="css plain">, </code><code class="css value">100%</code><code class="css plain">, color-stop(</code><code class="css value">0%</code><code class="css plain">, rgba(</code><code class="css value">227</code><code class="css plain">,</code><code class="css value">71</code><code class="css plain">,</code><code class="css value">73</code><code class="css plain">,</code><code class="css value">1</code><code class="css plain">)), color-stop(</code><code class="css value">100%</code><code class="css plain">, rgba(</code><code class="css value">186</code><code class="css plain">,</code><code class="css value">27</code><code class="css plain">,</code><code class="css value">31</code><code class="css plain">,</code><code class="css value">1</code><code class="css plain">))); </code><code class="css comments">/* safari4+,chrome */</code></div><div class="line number22 index21 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">:-webkit-radial-gradient(</code><code class="css value">center</code><code class="css plain">, ellipse cover, rgba(</code><code class="css value">227</code><code class="css plain">,</code><code class="css value">71</code><code class="css plain">,</code><code class="css value">73</code><code class="css plain">,</code><code class="css value">1</code><code class="css plain">) </code><code class="css value">0%</code><code class="css plain">, rgba(</code><code class="css value">186</code><code class="css plain">,</code><code class="css value">27</code><code class="css plain">,</code><code class="css value">31</code><code class="css plain">,</code><code class="css value">1</code><code class="css plain">) </code><code class="css value">100%</code><code class="css plain">); </code><code class="css comments">/* safari5.1+,chrome10+ */</code></div><div class="line number23 index22 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: -o-radial-gradient(</code><code class="css value">center</code><code class="css plain">, ellipse cover, rgba(</code><code class="css value">227</code><code class="css plain">,</code><code class="css value">71</code><code class="css plain">,</code><code class="css value">73</code><code class="css plain">,</code><code class="css value">1</code><code class="css plain">) </code><code class="css value">0%</code><code class="css plain">, rgba(</code><code class="css value">186</code><code class="css plain">,</code><code class="css value">27</code><code class="css plain">,</code><code class="css value">31</code><code class="css plain">,</code><code class="css value">1</code><code class="css plain">) </code><code class="css value">100%</code><code class="css plain">); </code><code class="css comments">/* opera 11.10+ */</code></div><div class="line number24 index23 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: -ms-radial-gradient(</code><code class="css value">center</code><code class="css plain">, ellipse cover, rgba(</code><code class="css value">227</code><code class="css plain">,</code><code class="css value">71</code><code class="css plain">,</code><code class="css value">73</code><code class="css plain">,</code><code class="css value">1</code><code class="css plain">) </code><code class="css value">0%</code><code class="css plain">, rgba(</code><code class="css value">186</code><code class="css plain">,</code><code class="css value">27</code><code class="css plain">,</code><code class="css value">31</code><code class="css plain">,</code><code class="css value">1</code><code class="css plain">) </code><code class="css value">100%</code><code class="css plain">); </code><code class="css comments">/* ie10+ */</code></div><div class="line number25 index24 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">:radial-gradient(ellipse at </code><code class="css value">center</code><code class="css plain">, rgba(</code><code class="css value">227</code><code class="css plain">,</code><code class="css value">71</code><code class="css plain">,</code><code class="css value">73</code><code class="css plain">,</code><code class="css value">1</code><code class="css plain">) </code><code class="css value">0%</code><code class="css plain">, rgba(</code><code class="css value">186</code><code class="css plain">,</code><code class="css value">27</code><code class="css plain">,</code><code class="css value">31</code><code class="css plain">,</code><code class="css value">1</code><code class="css plain">) </code><code class="css value">100%</code><code class="css plain">); </code><code class="css comments">/* w3c */</code></div><div class="line number26 index25 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css plain">filter: progid:DXImageTransform.Microsoft.gradient( startColorstr=</code><code class="css string">'#e34749'</code><code class="css plain">, endColorstr=</code><code class="css string">'#ba1b1f'</code><code class="css plain">,GradientType=</code><code class="css value">1</code> <code class="css plain">); </code><code class="css comments">/* ie6-9 */</code></div><div class="line number27 index26 alt2"><code class="css plain">}</code></div><div class="line number28 index27 alt1"><code class="css plain">.header .logo{</code></div><div class="line number29 index28 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-weight</code><code class="css plain">: </code><code class="css value">bold</code><code class="css plain">;</code></div><div class="line number30 index29 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">30px</code><code class="css plain">;</code></div><div class="line number31 index30 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">display</code><code class="css plain">: </code><code class="css value">block</code><code class="css plain">;</code></div><div class="line number32 index31 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">margin</code><code class="css plain">: </code><code class="css value">10px</code> <code class="css value">0</code><code class="css plain">;</code></div><div class="line number33 index32 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">letter-spacing</code><code class="css plain">: </code><code class="css value">3px</code><code class="css plain">;</code></div><div class="line number34 index33 alt1"><code class="css plain">}</code></div><div class="line number35 index34 alt2"><code class="css plain">.header h</code><code class="css value">2</code><code class="css plain">{</code></div><div class="line number36 index35 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">display</code><code class="css plain">: </code><code class="css value">block</code><code class="css plain">;</code></div><div class="line number37 index36 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">50px</code><code class="css plain">;</code></div><div class="line number38 index37 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-weight</code><code class="css plain">: </code><code class="css value">100</code><code class="css plain">;</code></div><div class="line number39 index38 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">line-height</code><code class="css plain">: </code><code class="css value">10px</code><code class="css plain">;</code></div><div class="line number40 index39 alt1"><code class="css plain">}</code></div><div class="line number41 index40 alt2"><code class="css plain">.header h</code><code class="css value">2</code><code class="css plain">.</code><code class="css value">small</code><code class="css plain">{</code></div><div class="line number42 index41 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">25px</code><code class="css plain">;</code></div><div class="line number43 index42 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-weight</code><code class="css plain">: </code><code class="css value">300</code><code class="css plain">;</code></div><div class="line number44 index43 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding-top</code><code class="css plain">: </code><code class="css value">20px</code><code class="css plain">;</code></div><div class="line number45 index44 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">letter-spacing</code><code class="css plain">: </code><code class="css value">1px</code><code class="css plain">;</code></div><div class="line number46 index45 alt1"><code class="css plain">}</code></div><div class="line number47 index46 alt2"><code class="css plain">.topics{</code></div><div class="line number48 index47 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">text-align</code><code class="css plain">: </code><code class="css value">center</code><code class="css plain">;</code></div><div class="line number49 index48 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding-top</code><code class="css plain">: </code><code class="css value">50px</code><code class="css plain">;</code></div><div class="line number50 index49 alt1"><code class="css plain">}</code></div><div class="line number51 index50 alt2"><code class="css plain">.topics h</code><code class="css value">2</code><code class="css plain">.heading{</code></div><div class="line number52 index51 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">30px</code><code class="css plain">;</code></div><div class="line number53 index52 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">color</code><code class="css plain">: </code><code class="css value">#666</code><code class="css plain">;</code></div><div class="line number54 index53 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-weight</code><code class="css plain">: </code><code class="css value">400</code><code class="css plain">;</code></div><div class="line number55 index54 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">display</code><code class="css plain">: </code><code class="css value">block</code><code class="css plain">;</code></div><div class="line number56 index55 alt1"><code class="css plain">}</code></div><div class="line number57 index56 alt2"><code class="css plain">.box{</code></div><div class="line number58 index57 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">width</code><code class="css plain">: </code><code class="css value">900px</code><code class="css plain">;</code></div><div class="line number59 index58 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">margin</code><code class="css plain">: </code><code class="css value">40px</code> <code class="css value">auto</code><code class="css plain">;</code></div><div class="line number60 index59 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">border</code><code class="css plain">: </code><code class="css value">1px</code> <code class="css value">solid</code> <code class="css value">#dedede</code><code class="css plain">;</code></div><div class="line number61 index60 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: </code><code class="css value">#f2f4f8</code><code class="css plain">;</code></div><div class="line number62 index61 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">position</code><code class="css plain">: </code><code class="css value">relative</code><code class="css plain">;</code></div><div class="line number63 index62 alt2"><code class="css plain">}</code></div><div class="line number64 index63 alt1"><code class="css plain">.box .usr_container,</code></div><div class="line number65 index64 alt2"><code class="css plain">.box .msg_container{</code></div><div class="line number66 index65 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">float</code><code class="css plain">: </code><code class="css value">left</code><code class="css plain">;</code></div><div class="line number67 index66 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">height</code><code class="css plain">: </code><code class="css value">600px</code><code class="css plain">;</code></div><div class="line number68 index67 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css plain">overflow-x: </code><code class="css value">hidden</code><code class="css plain">;</code></div><div class="line number69 index68 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css plain">overflow-y: </code><code class="css value">auto</code><code class="css plain">;</code></div><div class="line number70 index69 alt1"><code class="css plain">}</code></div><div class="line number71 index70 alt2"><code class="css plain">.box .usr_container{</code></div><div class="line number72 index71 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">width</code><code class="css plain">: </code><code class="css value">350px</code><code class="css plain">;</code></div><div class="line number73 index72 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">border-right</code><code class="css plain">: </code><code class="css value">1px</code> <code class="css value">solid</code> <code class="css value">#dedede</code><code class="css plain">;</code></div><div class="line number74 index73 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: </code><code class="css value">#fff</code><code class="css plain">;</code></div><div class="line number75 index74 alt2"><code class="css plain">}</code></div><div class="line number76 index75 alt1"><code class="css plain">.box .msg_container{</code></div><div class="line number77 index76 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">width</code><code class="css plain">: </code><code class="css value">548px</code><code class="css plain">;</code></div><div class="line number78 index77 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">position</code><code class="css plain">: </code><code class="css value">relative</code><code class="css plain">;</code></div><div class="line number79 index78 alt2"><code class="css plain">}</code></div><div class="line number80 index79 alt1"><code class="css plain">.box ul{</code></div><div class="line number81 index80 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">margin</code><code class="css plain">: </code><code class="css value">0</code><code class="css plain">;</code></div><div class="line number82 index81 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding</code><code class="css plain">: </code><code class="css value">0</code><code class="css plain">;</code></div><div class="line number83 index82 alt2"><code class="css plain">}</code></div><div class="line number84 index83 alt1"><code class="css plain">.box ul li{</code></div><div class="line number85 index84 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">margin</code><code class="css plain">: </code><code class="css value">0</code><code class="css plain">;</code></div><div class="line number86 index85 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding</code><code class="css plain">: </code><code class="css value">0</code><code class="css plain">;</code></div><div class="line number87 index86 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">list-style</code><code class="css plain">: </code><code class="css value">none</code><code class="css plain">;</code></div><div class="line number88 index87 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">text-align</code><code class="css plain">: </code><code class="css value">left</code><code class="css plain">;</code></div><div class="line number89 index88 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">cursor</code><code class="css plain">: </code><code class="css value">pointer</code><code class="css plain">;</code></div><div class="line number90 index89 alt1"><code class="css plain">}</code></div><div class="line number91 index90 alt2">&nbsp;</div><div class="line number92 index91 alt1"><code class="css plain">.box .usr_container ul li{</code></div><div class="line number93 index92 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding</code><code class="css plain">: </code><code class="css value">20px</code> <code class="css value">10px</code><code class="css plain">;</code></div><div class="line number94 index93 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: </code><code class="css value">#fff</code><code class="css plain">;</code></div><div class="line number95 index94 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">border-bottom</code><code class="css plain">: </code><code class="css value">1px</code> <code class="css value">solid</code> <code class="css value">#dedede</code><code class="css plain">;</code></div><div class="line number96 index95 alt1"><code class="css plain">}</code></div><div class="line number97 index96 alt2"><code class="css plain">.box .usr_container ul li label{</code></div><div class="line number98 index97 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">display</code><code class="css plain">: </code><code class="css value">block</code><code class="css plain">;</code></div><div class="line number99 index98 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">width</code><code class="css plain">: </code><code class="css value">100%</code><code class="css plain">;</code></div><div class="line number100 index99 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-family</code><code class="css plain">: </code><code class="css color1">arial</code><code class="css plain">;</code></div><div class="line number101 index100 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-weight</code><code class="css plain">: </code><code class="css value">400</code><code class="css plain">;</code></div><div class="line number102 index101 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">color</code><code class="css plain">: </code><code class="css value">#333</code><code class="css plain">;</code></div><div class="line number103 index102 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">18px</code><code class="css plain">;</code></div><div class="line number104 index103 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">margin-bottom</code><code class="css plain">: </code><code class="css value">5px</code><code class="css plain">;</code></div><div class="line number105 index104 alt2"><code class="css plain">}</code></div><div class="line number106 index105 alt1"><code class="css plain">.box .usr_container ul li label:hover{</code></div><div class="line number107 index106 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">cursor</code><code class="css plain">: </code><code class="css value">pointer</code><code class="css plain">;</code></div><div class="line number108 index107 alt1"><code class="css plain">}</code></div><div class="line number109 index108 alt2"><code class="css plain">.box .usr_container ul li span{</code></div><div class="line number110 index109 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">color</code><code class="css plain">: </code><code class="css value">#777</code><code class="css plain">;</code></div><div class="line number111 index110 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-family</code><code class="css plain">: </code><code class="css color1">arial</code><code class="css plain">;</code></div><div class="line number112 index111 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">14px</code><code class="css plain">;</code></div><div class="line number113 index112 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-style</code><code class="css plain">: </code><code class="css value">italic</code><code class="css plain">;</code></div><div class="line number114 index113 alt1"><code class="css plain">}</code></div><div class="line number115 index114 alt2"><code class="css plain">.box .usr_container ul li.selected{</code></div><div class="line number116 index115 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: </code><code class="css value">#f2f4f8</code><code class="css plain">;</code></div><div class="line number117 index116 alt2"><code class="css plain">}</code></div><div class="line number118 index117 alt1"><code class="css plain">.box .usr_container ul li.selected label{</code></div><div class="line number119 index118 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">color</code><code class="css plain">: </code><code class="css value">#e34749</code><code class="css plain">;</code></div><div class="line number120 index119 alt1"><code class="css plain">}</code></div><div class="line number121 index120 alt2"><code class="css plain">.box .usr_container ul li.selected span{</code></div><div class="line number122 index121 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">color</code><code class="css plain">: </code><code class="css value">#000</code><code class="css plain">;</code></div><div class="line number123 index122 alt2"><code class="css plain">}</code></div><div class="line number124 index123 alt1"><code class="css plain">.box .usr_container ul li:hover{</code></div><div class="line number125 index124 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: </code><code class="css value">#dedede</code><code class="css plain">;</code></div><div class="line number126 index125 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">cursor</code><code class="css plain">: </code><code class="css value">pointer</code><code class="css plain">;</code></div><div class="line number127 index126 alt2"><code class="css plain">}</code></div><div class="line number128 index127 alt1"><code class="css plain">.box .msg_container ul{</code></div><div class="line number129 index128 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding</code><code class="css plain">: </code><code class="css value">10px</code> <code class="css value">0</code><code class="css plain">;</code></div><div class="line number130 index129 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">margin-bottom</code><code class="css plain">: </code><code class="css value">75px</code><code class="css plain">;</code></div><div class="line number131 index130 alt2"><code class="css plain">}</code></div><div class="line number132 index131 alt1"><code class="css plain">.box .msg_container li{</code></div><div class="line number133 index132 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding</code><code class="css plain">: </code><code class="css value">10px</code> <code class="css value">0</code><code class="css plain">;</code></div><div class="line number134 index133 alt1"><code class="css plain">}</code></div><div class="line number135 index134 alt2"><code class="css plain">.box .msg_container li.others{</code></div><div class="line number136 index135 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">cursor</code><code class="css plain">: </code><code class="css value">auto</code><code class="css plain">;</code></div><div class="line number137 index136 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">text-align</code><code class="css plain">: </code><code class="css value">left</code><code class="css plain">;</code></div><div class="line number138 index137 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding-left</code><code class="css plain">: </code><code class="css value">20px</code><code class="css plain">;</code></div><div class="line number139 index138 alt2"><code class="css plain">}</code></div><div class="line number140 index139 alt1"><code class="css plain">.box .msg_container li.self{</code></div><div class="line number141 index140 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">text-align</code><code class="css plain">: </code><code class="css value">right</code><code class="css plain">;</code></div><div class="line number142 index141 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">cursor</code><code class="css plain">: </code><code class="css value">auto</code><code class="css plain">;</code></div><div class="line number143 index142 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding-right</code><code class="css plain">: </code><code class="css value">20px</code><code class="css plain">;</code></div><div class="line number144 index143 alt1"><code class="css plain">}</code></div><div class="line number145 index144 alt2"><code class="css plain">.box .msg_container li.self label{</code></div><div class="line number146 index145 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">float</code><code class="css plain">: </code><code class="css value">right</code><code class="css plain">;</code></div><div class="line number147 index146 alt2"><code class="css plain">}</code></div><div class="line number148 index147 alt1"><code class="css plain">.box .msg_container li .message{</code></div><div class="line number149 index148 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: </code><code class="css value">#fff</code><code class="css plain">;</code></div><div class="line number150 index149 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css plain">border-radius: </code><code class="css value">3px</code><code class="css plain">;</code></div><div class="line number151 index150 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding</code><code class="css plain">: </code><code class="css value">15px</code><code class="css plain">;</code></div><div class="line number152 index151 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">max-width</code><code class="css plain">: </code><code class="css value">400px</code><code class="css plain">;</code></div><div class="line number153 index152 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">15px</code><code class="css plain">;</code></div><div class="line number154 index153 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-family</code><code class="css plain">: </code><code class="css color1">arial</code><code class="css plain">;</code></div><div class="line number155 index154 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">float</code><code class="css plain">: </code><code class="css value">left</code><code class="css plain">;</code></div><div class="line number156 index155 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">line-height</code><code class="css plain">: </code><code class="css value">20px</code><code class="css plain">;</code></div><div class="line number157 index156 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">margin</code><code class="css plain">: </code><code class="css value">5px</code> <code class="css value">0</code> <code class="css value">10px</code> <code class="css value">0</code><code class="css plain">;</code></div><div class="line number158 index157 alt1"><code class="css plain">}</code></div><div class="line number159 index158 alt2"><code class="css plain">.box .msg_container li label{</code></div><div class="line number160 index159 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">float</code><code class="css plain">: </code><code class="css value">left</code><code class="css plain">;</code></div><div class="line number161 index160 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">display</code><code class="css plain">: </code><code class="css value">block</code><code class="css plain">;</code></div><div class="line number162 index161 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">width</code><code class="css plain">: </code><code class="css value">100%</code><code class="css plain">;</code></div><div class="line number163 index162 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">12px</code><code class="css plain">;</code></div><div class="line number164 index163 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">color</code><code class="css plain">: </code><code class="css value">#777</code><code class="css plain">;</code></div><div class="line number165 index164 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-family</code><code class="css plain">: </code><code class="css color1">arial</code><code class="css plain">;</code></div><div class="line number166 index165 alt1"><code class="css plain">}</code></div><div class="line number167 index166 alt2"><code class="css plain">.box .msg_container li.others .message{</code></div><div class="line number168 index167 alt1">&nbsp;</div><div class="line number169 index168 alt2"><code class="css plain">}</code></div><div class="line number170 index169 alt1"><code class="css plain">.box .msg_container li.self .message{</code></div><div class="line number171 index170 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: </code><code class="css value">#dee2ef</code><code class="css plain">;</code></div><div class="line number172 index171 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">float</code><code class="css plain">: </code><code class="css value">right</code><code class="css plain">;</code></div><div class="line number173 index172 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">display</code><code class="css plain">: inline-</code><code class="css value">block</code><code class="css plain">;</code></div><div class="line number174 index173 alt1"><code class="css plain">}</code></div><div class="line number175 index174 alt2"><code class="css plain">.clear{</code></div><div class="line number176 index175 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">clear</code><code class="css plain">:</code><code class="css value">both</code><code class="css plain">;</code></div><div class="line number177 index176 alt2"><code class="css plain">}</code></div><div class="line number178 index177 alt1"><code class="css plain">.send_container{</code></div><div class="line number179 index178 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">border-top</code><code class="css plain">: </code><code class="css value">1px</code> <code class="css value">solid</code> <code class="css value">#dedede</code><code class="css plain">;</code></div><div class="line number180 index179 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: </code><code class="css value">#f7f9fd</code><code class="css plain">;</code></div><div class="line number181 index180 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">position</code><code class="css plain">: </code><code class="css value">absolute</code><code class="css plain">;</code></div><div class="line number182 index181 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">bottom</code><code class="css plain">: </code><code class="css value">0</code><code class="css plain">;</code></div><div class="line number183 index182 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">height</code><code class="css plain">:</code><code class="css value">75px</code><code class="css plain">;</code></div><div class="line number184 index183 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">right</code><code class="css plain">: </code><code class="css value">0</code><code class="css plain">;</code></div><div class="line number185 index184 alt2"><code class="css plain">}</code></div><div class="line number186 index185 alt1"><code class="css plain">.send_container textarea{</code></div><div class="line number187 index186 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: </code><code class="css value">#f7f9fd</code><code class="css plain">;</code></div><div class="line number188 index187 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">height</code><code class="css plain">: </code><code class="css value">30px</code><code class="css plain">;</code></div><div class="line number189 index188 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">width</code><code class="css plain">: </code><code class="css value">550px</code><code class="css plain">;</code></div><div class="line number190 index189 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">15px</code><code class="css plain">;</code></div><div class="line number191 index190 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">text-align</code><code class="css plain">: </code><code class="css value">left</code><code class="css plain">;</code></div><div class="line number192 index191 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding</code><code class="css plain">: </code><code class="css value">20px</code><code class="css plain">;</code></div><div class="line number193 index192 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">border</code><code class="css plain">: </code><code class="css value">none</code><code class="css plain">;</code></div><div class="line number194 index193 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css plain">resize: </code><code class="css value">none</code><code class="css plain">;</code></div><div class="line number195 index194 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">outline</code><code class="css plain">: </code><code class="css value">none</code><code class="css plain">;</code></div><div class="line number196 index195 alt1"><code class="css plain">}</code></div><div class="line number197 index196 alt2"><code class="css plain">.send_container input[type=</code><code class="css string">"button"</code><code class="css plain">]{</code></div><div class="line number198 index197 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">position</code><code class="css plain">: </code><code class="css value">absolute</code><code class="css plain">;</code></div><div class="line number199 index198 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">top</code><code class="css plain">: </code><code class="css value">20px</code><code class="css plain">;</code></div><div class="line number200 index199 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">right</code><code class="css plain">: </code><code class="css value">20px</code><code class="css plain">;</code></div><div class="line number201 index200 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding</code><code class="css plain">: </code><code class="css value">10px</code><code class="css plain">;</code></div><div class="line number202 index201 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: </code><code class="css value">#e34749</code><code class="css plain">;</code></div><div class="line number203 index202 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">outline</code><code class="css plain">: </code><code class="css value">none</code><code class="css plain">;</code></div><div class="line number204 index203 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">border</code><code class="css plain">: </code><code class="css value">none</code><code class="css plain">;</code></div><div class="line number205 index204 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">cursor</code><code class="css plain">: </code><code class="css value">pointer</code><code class="css plain">;</code></div><div class="line number206 index205 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">color</code><code class="css plain">: </code><code class="css value">#fff</code><code class="css plain">;</code></div><div class="line number207 index206 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-weight</code><code class="css plain">: </code><code class="css value">bold</code><code class="css plain">;</code></div><div class="line number208 index207 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">15px</code><code class="css plain">;</code></div><div class="line number209 index208 alt2"><code class="css plain">}</code></div><div class="line number210 index209 alt1"><code class="css plain">.btn_send{</code></div><div class="line number211 index210 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding</code><code class="css plain">: </code><code class="css value">10px</code><code class="css plain">;</code></div><div class="line number212 index211 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: </code><code class="css value">#e34749</code><code class="css plain">;</code></div><div class="line number213 index212 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">outline</code><code class="css plain">: </code><code class="css value">none</code><code class="css plain">;</code></div><div class="line number214 index213 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">border</code><code class="css plain">: </code><code class="css value">none</code><code class="css plain">;</code></div><div class="line number215 index214 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">cursor</code><code class="css plain">: </code><code class="css value">pointer</code><code class="css plain">;</code></div><div class="line number216 index215 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">color</code><code class="css plain">: </code><code class="css value">#fff</code><code class="css plain">;</code></div><div class="line number217 index216 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-weight</code><code class="css plain">: </code><code class="css value">bold</code><code class="css plain">;</code></div><div class="line number218 index217 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">15px</code><code class="css plain">;</code></div><div class="line number219 index218 alt2"><code class="css plain">}</code></div><div class="line number220 index219 alt1"><code class="css plain">.box .msg_container li label.name{</code></div><div class="line number221 index220 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">display</code><code class="css plain">: </code><code class="css value">block</code><code class="css plain">;</code></div><div class="line number222 index221 alt1"><code class="css plain">}</code></div><div class="line number223 index222 alt2"><code class="css plain">div.container{</code></div><div class="line number224 index223 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">width</code><code class="css plain">: </code><code class="css value">900px</code><code class="css plain">;</code></div><div class="line number225 index224 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">margin</code><code class="css plain">: </code><code class="css value">0</code> <code class="css value">auto</code><code class="css plain">;</code></div><div class="line number226 index225 alt1"><code class="css plain">}</code></div><div class="line number227 index226 alt2"><code class="css plain">select.select_single{</code></div><div class="line number228 index227 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding</code><code class="css plain">: </code><code class="css value">10px</code><code class="css plain">;</code></div><div class="line number229 index228 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">16px</code><code class="css plain">;</code></div><div class="line number230 index229 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">width</code><code class="css plain">: </code><code class="css value">400px</code><code class="css plain">;</code></div><div class="line number231 index230 alt2"><code class="css plain">}</code></div><div class="line number232 index231 alt1"><code class="css plain">select.select_single option{</code></div><div class="line number233 index232 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">19px</code><code class="css plain">;</code></div><div class="line number234 index233 alt1"><code class="css plain">}</code></div><div class="line number235 index234 alt2"><code class="css plain">select.select_multiple{</code></div><div class="line number236 index235 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">15px</code><code class="css plain">;</code></div><div class="line number237 index236 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">width</code><code class="css plain">: </code><code class="css value">400px</code><code class="css plain">;</code></div><div class="line number238 index237 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">height</code><code class="css plain">: </code><code class="css value">200px</code><code class="css plain">;</code></div><div class="line number239 index238 alt2"><code class="css plain">}</code></div><div class="line number240 index239 alt1"><code class="css plain">select.select_multiple option{</code></div><div class="line number241 index240 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding</code><code class="css plain">: </code><code class="css value">5px</code><code class="css plain">;</code></div><div class="line number242 index241 alt1"><code class="css plain">}</code></div><div class="line number243 index242 alt2"><code class="css plain">textarea.textarea_msg{</code></div><div class="line number244 index243 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">width</code><code class="css plain">: </code><code class="css value">400px</code><code class="css plain">;</code></div><div class="line number245 index244 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">height</code><code class="css plain">: </code><code class="css value">120px</code><code class="css plain">;</code></div><div class="line number246 index245 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css plain">resize: </code><code class="css value">none</code><code class="css plain">;</code></div><div class="line number247 index246 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">margin</code><code class="css plain">:</code><code class="css value">20px</code> <code class="css value">auto</code><code class="css plain">;</code></div><div class="line number248 index247 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">padding</code><code class="css plain">: </code><code class="css value">15px</code><code class="css plain">;</code></div><div class="line number249 index248 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: </code><code class="css value">#f7f9fd</code><code class="css plain">;</code></div><div class="line number250 index249 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">15px</code><code class="css plain">;</code></div><div class="line number251 index250 alt2"><code class="css plain">}</code></div><div class="line number252 index251 alt1"><code class="css plain">.loader{</code></div><div class="line number253 index252 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">display</code><code class="css plain">: </code><code class="css value">none</code><code class="css plain">;</code></div><div class="line number254 index253 alt1"><code class="css plain">}</code></div><div class="line number255 index254 alt2"><code class="css value">pre</code><code class="css plain">{</code></div><div class="line number256 index255 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">width</code><code class="css plain">: </code><code class="css value">800px</code><code class="css plain">;</code></div><div class="line number257 index256 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">text-align</code><code class="css plain">: </code><code class="css value">left</code> <code class="css color3">!important</code><code class="css plain">;</code></div><div class="line number258 index257 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-size</code><code class="css plain">: </code><code class="css value">16px</code><code class="css plain">;</code></div><div class="line number259 index258 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">font-family</code><code class="css plain">: </code><code class="css color1">monospace</code><code class="css plain">;</code></div><div class="line number260 index259 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">margin</code><code class="css plain">: </code><code class="css value">0</code> <code class="css value">auto</code><code class="css plain">;</code></div><div class="line number261 index260 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">line-height</code><code class="css plain">: </code><code class="css value">20px</code><code class="css plain">;</code></div><div class="line number262 index261 alt1"><code class="css plain">}</code></div><div class="line number263 index262 alt2"><code class="css plain">.separator{</code></div><div class="line number264 index263 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">width</code><code class="css plain">: </code><code class="css value">100%</code><code class="css plain">;</code></div><div class="line number265 index264 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">height</code><code class="css plain">: </code><code class="css value">1px</code><code class="css plain">;</code></div><div class="line number266 index265 alt1"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">background</code><code class="css plain">: </code><code class="css value">#cdcdcd</code><code class="css plain">;</code></div><div class="line number267 index266 alt2"><code class="css spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="css keyword">margin</code><code class="css plain">: </code><code class="css value">50px</code> <code class="css value">0</code><code class="css plain">;</code></div><div class="line number268 index267 alt1"><code class="css plain">}</code></div></div></td></tr></tbody></table></div></div>
<p><strong>3</strong>. Paste the <a href="http://demo.androidhive.info/gcm_chat/loader.gif" target="_blank">loader.gif</a> image in the same directory.</p>
<p><strong>4</strong>. Create <strong>index.php</strong> in the root directory. Here I have written necessary php, html and jQuery code to build the admin UI.</p>
<div><div id="highlighter_519839" class="syntaxhighlighter nogutter  php"><table border="0" cellpadding="0" cellspacing="0"><caption>index.php</caption><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">&lt;?php</code></div><div class="line number2 index1 alt1"><code class="php functions">error_reporting</code><code class="php plain">(-1);</code></div><div class="line number3 index2 alt2"><code class="php functions">ini_set</code><code class="php plain">(</code><code class="php string">'display_errors'</code><code class="php plain">, </code><code class="php string">'On'</code><code class="php plain">);</code></div><div class="line number4 index3 alt1"><code class="php plain">?&gt;</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="php plain">&lt;?php</code></div><div class="line number7 index6 alt2"><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/demo.php'</code><code class="php plain">;</code></div><div class="line number8 index7 alt1"><code class="php variable">$demo</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">Demo();</code></div><div class="line number9 index8 alt2"><code class="php variable">$admin_id</code> <code class="php plain">= </code><code class="php variable">$demo</code><code class="php plain">-&gt;getDemoUser();</code></div><div class="line number10 index9 alt1"><code class="php plain">?&gt;</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="php plain">&lt;html&gt;</code></div><div class="line number13 index12 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;head&gt;</code></div><div class="line number14 index13 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;title&gt;Google Cloud Messaging 3.0 | AndroidHive&lt;/title&gt;</code></div><div class="line number15 index14 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;meta charset=</code><code class="php string">"UTF-8"</code><code class="php plain">&gt;</code></div><div class="line number16 index15 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;meta name=</code><code class="php string">"viewport"</code> <code class="php plain">content=</code><code class="php string">"width=device-width, initial-scale=1.0"</code><code class="php plain">&gt;</code></div><div class="line number17 index16 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;link href=</code><code class="php string">'<a href="https://fonts.googleapis.com/css?family=Raleway:400">https://fonts.googleapis.com/css?family=Raleway:400</a>,800,100'</code> <code class="php plain">rel=</code><code class="php string">'stylesheet'</code> <code class="php plain">type=</code><code class="php string">'text/css'</code><code class="php plain">&gt;</code></div><div class="line number18 index17 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;link href=</code><code class="php string">'style.css'</code> <code class="php plain">rel=</code><code class="php string">'stylesheet'</code> <code class="php plain">type=</code><code class="php string">'text/css'</code><code class="php plain">&gt;</code></div><div class="line number19 index18 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;link href=</code><code class="php string">'<a href="http://api.androidhive.info/gcm/styles/default.css">http://api.androidhive.info/gcm/styles/default.css</a>'</code> <code class="php plain">rel=</code><code class="php string">'stylesheet'</code> <code class="php plain">type=</code><code class="php string">'text/css'</code><code class="php plain">&gt;</code></div><div class="line number20 index19 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;script type=</code><code class="php string">"text/javascript"</code> <code class="php plain">src=</code><code class="php string">"<a href="https://code.jquery.com/jquery-2.2.0.min.js">https://code.jquery.com/jquery-2.2.0.min.js</a>"</code><code class="php plain">&gt;&lt;/script&gt;</code></div><div class="line number21 index20 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;script type=</code><code class="php string">"text/javascript"</code><code class="php plain">&gt;</code></div><div class="line number22 index21 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">var</code> <code class="php plain">user_id = </code><code class="php string">'&lt;?= $admin_id ?&gt;'</code><code class="php plain">;</code></div><div class="line number23 index22 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(document).ready(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">getChatroomMessages($(</code><code class="php string">'#topics li:first'</code><code class="php plain">).attr(</code><code class="php string">'id'</code><code class="php plain">));</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'ul#topics li'</code><code class="php plain">).on(</code><code class="php string">'click'</code><code class="php plain">, </code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number29 index28 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'ul#topics li'</code><code class="php plain">).removeClass(</code><code class="php string">'selected'</code><code class="php plain">);</code></div><div class="line number30 index29 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(this).addClass(</code><code class="php string">'selected'</code><code class="php plain">);</code></div><div class="line number31 index30 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">getChatroomMessages($(this).prop(</code><code class="php string">'id'</code><code class="php plain">))</code></div><div class="line number32 index31 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">});</code></div><div class="line number33 index32 alt2">&nbsp;</div><div class="line number34 index33 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">function</code> <code class="php plain">getChatroomMessages(id) {</code></div><div class="line number35 index34 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$.getJSON(</code><code class="php string">"v1/chat_rooms/"</code> <code class="php plain">+ id, </code><code class="php keyword">function</code> <code class="php plain">(data) {</code></div><div class="line number36 index35 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">var</code> <code class="php plain">li = </code><code class="php string">''</code><code class="php plain">;</code></div><div class="line number37 index36 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$.each(data.messages, </code><code class="php keyword">function</code> <code class="php plain">(i, message) {</code></div><div class="line number38 index37 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">li += </code><code class="php string">'&lt;li class="others"&gt;&lt;label class="name"&gt;'</code> <code class="php plain">+ message.user.username + </code><code class="php string">'&lt;/label&gt;&lt;div class="message"&gt;'</code> <code class="php plain">+ message.message + </code><code class="php string">'&lt;/div&gt;&lt;div class="clear"&gt;&lt;/div&gt;&lt;/li&gt;'</code><code class="php plain">;</code></div><div class="line number39 index38 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">});</code></div><div class="line number40 index39 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'ul#topic_messages'</code><code class="php plain">).html(li);</code></div><div class="line number41 index40 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(data.messages.length &gt; 0) {</code></div><div class="line number42 index41 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">scrollToBottom(</code><code class="php string">'msg_container_topic'</code><code class="php plain">);</code></div><div class="line number43 index42 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number44 index43 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}).done(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number45 index44 alt2">&nbsp;</div><div class="line number46 index45 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}).fail(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number47 index46 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Sorry! Unable to fetch topic messages'</code><code class="php plain">);</code></div><div class="line number48 index47 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}).always(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number49 index48 alt2">&nbsp;</div><div class="line number50 index49 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">});</code></div><div class="line number51 index50 alt2">&nbsp;</div><div class="line number52 index51 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// attaching the chatroom id to send button</code></div><div class="line number53 index52 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#send_to_topic'</code><code class="php plain">).attr(</code><code class="php string">'chat_room'</code><code class="php plain">, id);</code></div><div class="line number54 index53 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number55 index54 alt2">&nbsp;</div><div class="line number56 index55 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#send_to_topic'</code><code class="php plain">).on(</code><code class="php string">'click'</code><code class="php plain">, </code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number57 index56 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">var</code> <code class="php plain">msg = $(</code><code class="php string">'#send_to_topic_message'</code><code class="php plain">).val();</code></div><div class="line number58 index57 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(msg.trim().length === 0) {</code></div><div class="line number59 index58 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Enter a message'</code><code class="php plain">);</code></div><div class="line number60 index59 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code><code class="php plain">;</code></div><div class="line number61 index60 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number62 index61 alt1">&nbsp;</div><div class="line number63 index62 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#send_to_topic_message'</code><code class="php plain">).val(</code><code class="php string">''</code><code class="php plain">);</code></div><div class="line number64 index63 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#loader_topic'</code><code class="php plain">).show();</code></div><div class="line number65 index64 alt2">&nbsp;</div><div class="line number66 index65 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$.post(</code><code class="php string">"v1/chat_rooms/"</code> <code class="php plain">+ $(this).attr(</code><code class="php string">'chat_room'</code><code class="php plain">) + </code><code class="php string">'/message'</code><code class="php plain">,</code></div><div class="line number67 index66 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">{user_id: user_id, message: msg},</code></div><div class="line number68 index67 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">function</code> <code class="php plain">(data) {</code></div><div class="line number69 index68 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(data.error === false) {</code></div><div class="line number70 index69 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">var</code> <code class="php plain">li = </code><code class="php string">'&lt;li class="self" tabindex="1"&gt;&lt;label class="name"&gt;'</code> <code class="php plain">+ data.user.name + </code><code class="php string">'&lt;/label&gt;&lt;div class="message"&gt;'</code> <code class="php plain">+ data.message.message + </code><code class="php string">'&lt;/div&gt;&lt;div class="clear"&gt;&lt;/div&gt;&lt;/li&gt;'</code><code class="php plain">;</code></div><div class="line number71 index70 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'ul#topic_messages'</code><code class="php plain">).append(li);</code></div><div class="line number72 index71 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">scrollToBottom(</code><code class="php string">'msg_container_topic'</code><code class="php plain">);</code></div><div class="line number73 index72 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">} </code><code class="php keyword">else</code> <code class="php plain">{</code></div><div class="line number74 index73 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Sorry! Unable to send message'</code><code class="php plain">);</code></div><div class="line number75 index74 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number76 index75 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}).done(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number77 index76 alt2">&nbsp;</div><div class="line number78 index77 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}).fail(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number79 index78 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Sorry! Unable to send message'</code><code class="php plain">);</code></div><div class="line number80 index79 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}).always(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number81 index80 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#loader_topic'</code><code class="php plain">).hide();</code></div><div class="line number82 index81 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">});</code></div><div class="line number83 index82 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">});</code></div><div class="line number84 index83 alt1">&nbsp;</div><div class="line number85 index84 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'input#send_to_single_user'</code><code class="php plain">).on(</code><code class="php string">'click'</code><code class="php plain">, </code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number86 index85 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">var</code> <code class="php plain">msg = $(</code><code class="php string">'#send_to_single'</code><code class="php plain">).val();</code></div><div class="line number87 index86 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">var</code> <code class="php plain">to = $(</code><code class="php string">'.select_single'</code><code class="php plain">).val();</code></div><div class="line number88 index87 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(msg.trim().length === 0) {</code></div><div class="line number89 index88 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Enter a message'</code><code class="php plain">);</code></div><div class="line number90 index89 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code><code class="php plain">;</code></div><div class="line number91 index90 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number92 index91 alt1">&nbsp;</div><div class="line number93 index92 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#send_to_single'</code><code class="php plain">).val(</code><code class="php string">''</code><code class="php plain">);</code></div><div class="line number94 index93 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#loader_single'</code><code class="php plain">).show();</code></div><div class="line number95 index94 alt2">&nbsp;</div><div class="line number96 index95 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$.post(</code><code class="php string">"v1/users/"</code> <code class="php plain">+ to + </code><code class="php string">'/message'</code><code class="php plain">,</code></div><div class="line number97 index96 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">{user_id: user_id, message: msg},</code></div><div class="line number98 index97 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">function</code> <code class="php plain">(data) {</code></div><div class="line number99 index98 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(data.error === false) {</code></div><div class="line number100 index99 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#loader_single'</code><code class="php plain">).hide();</code></div><div class="line number101 index100 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Push notification sent successfully! You should see a Toast message on device.'</code><code class="php plain">);</code></div><div class="line number102 index101 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">} </code><code class="php keyword">else</code> <code class="php plain">{</code></div><div class="line number103 index102 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Sorry! Unable to post message'</code><code class="php plain">);</code></div><div class="line number104 index103 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number105 index104 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}).done(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number106 index105 alt1">&nbsp;</div><div class="line number107 index106 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}).fail(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number108 index107 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Sorry! Unable to send message'</code><code class="php plain">);</code></div><div class="line number109 index108 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}).always(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number110 index109 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#loader_single'</code><code class="php plain">).hide();</code></div><div class="line number111 index110 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">});</code></div><div class="line number112 index111 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">});</code></div><div class="line number113 index112 alt2">&nbsp;</div><div class="line number114 index113 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'input#send_to_multiple_users'</code><code class="php plain">).on(</code><code class="php string">'click'</code><code class="php plain">, </code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number115 index114 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">var</code> <code class="php plain">msg = $(</code><code class="php string">'#send_to_multiple'</code><code class="php plain">).val();</code></div><div class="line number116 index115 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">var</code> <code class="php plain">to = $(</code><code class="php string">'.select_multiple'</code><code class="php plain">).val();</code></div><div class="line number117 index116 alt2">&nbsp;</div><div class="line number118 index117 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(to === null) {</code></div><div class="line number119 index118 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">"Please select the users!"</code><code class="php plain">);</code></div><div class="line number120 index119 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code><code class="php plain">;</code></div><div class="line number121 index120 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number122 index121 alt1">&nbsp;</div><div class="line number123 index122 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(msg.trim().length === 0) {</code></div><div class="line number124 index123 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Enter a message'</code><code class="php plain">);</code></div><div class="line number125 index124 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code><code class="php plain">;</code></div><div class="line number126 index125 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number127 index126 alt2">&nbsp;</div><div class="line number128 index127 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#send_to_multiple'</code><code class="php plain">).val(</code><code class="php string">''</code><code class="php plain">);</code></div><div class="line number129 index128 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#loader_multiple'</code><code class="php plain">).show();</code></div><div class="line number130 index129 alt1">&nbsp;</div><div class="line number131 index130 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">var</code> <code class="php plain">selMulti = $.map($(</code><code class="php string">".select_multiple option:selected"</code><code class="php plain">), </code><code class="php keyword">function</code> <code class="php plain">(el, i) {</code></div><div class="line number132 index131 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code> <code class="php plain">$(el).val();</code></div><div class="line number133 index132 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">});</code></div><div class="line number134 index133 alt1">&nbsp;</div><div class="line number135 index134 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">to = selMulti.join(</code><code class="php string">","</code><code class="php plain">);</code></div><div class="line number136 index135 alt1">&nbsp;</div><div class="line number137 index136 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$.post(</code><code class="php string">"v1/users/message"</code><code class="php plain">,</code></div><div class="line number138 index137 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">{user_id: user_id, to: to, message: msg},</code></div><div class="line number139 index138 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">function</code> <code class="php plain">(data) {</code></div><div class="line number140 index139 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(data.error === false) {</code></div><div class="line number141 index140 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#loader_multiple'</code><code class="php plain">).hide();</code></div><div class="line number142 index141 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Push notification sent successfully to multiple users'</code><code class="php plain">);</code></div><div class="line number143 index142 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">} </code><code class="php keyword">else</code> <code class="php plain">{</code></div><div class="line number144 index143 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Sorry! Unable to send message'</code><code class="php plain">);</code></div><div class="line number145 index144 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number146 index145 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}).done(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number147 index146 alt2">&nbsp;</div><div class="line number148 index147 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}).fail(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number149 index148 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Sorry! Unable to send message'</code><code class="php plain">);</code></div><div class="line number150 index149 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}).always(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number151 index150 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#loader_multiple'</code><code class="php plain">).hide();</code></div><div class="line number152 index151 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">});</code></div><div class="line number153 index152 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">});</code></div><div class="line number154 index153 alt1">&nbsp;</div><div class="line number155 index154 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'input#send_to_multiple_users_with_image'</code><code class="php plain">).on(</code><code class="php string">'click'</code><code class="php plain">, </code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number156 index155 alt1">&nbsp;</div><div class="line number157 index156 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">var</code> <code class="php plain">msg = $(</code><code class="php string">'#send_to_multiple_with_image'</code><code class="php plain">).val();</code></div><div class="line number158 index157 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(msg.trim().length === 0) {</code></div><div class="line number159 index158 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Enter a message'</code><code class="php plain">);</code></div><div class="line number160 index159 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">return</code><code class="php plain">;</code></div><div class="line number161 index160 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number162 index161 alt1">&nbsp;</div><div class="line number163 index162 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#send_to_multiple_with_image'</code><code class="php plain">).val(</code><code class="php string">''</code><code class="php plain">);</code></div><div class="line number164 index163 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#loader_multiple_with_image'</code><code class="php plain">).show();</code></div><div class="line number165 index164 alt2">&nbsp;</div><div class="line number166 index165 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$.post(</code><code class="php string">"v1/users/send_to_all"</code><code class="php plain">,</code></div><div class="line number167 index166 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">{user_id: user_id, message: msg},</code></div><div class="line number168 index167 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">function</code> <code class="php plain">(data) {</code></div><div class="line number169 index168 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">if</code> <code class="php plain">(data.error === false) {</code></div><div class="line number170 index169 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#loader_multiple_with_image'</code><code class="php plain">).hide();</code></div><div class="line number171 index170 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Push notification sent successfully to multiple users'</code><code class="php plain">);</code></div><div class="line number172 index171 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">} </code><code class="php keyword">else</code> <code class="php plain">{</code></div><div class="line number173 index172 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Sorry! Unable to send message'</code><code class="php plain">);</code></div><div class="line number174 index173 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number175 index174 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}).done(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number176 index175 alt1">&nbsp;</div><div class="line number177 index176 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}).fail(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number178 index177 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">alert(</code><code class="php string">'Sorry! Unable to send message'</code><code class="php plain">);</code></div><div class="line number179 index178 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}).always(</code><code class="php keyword">function</code> <code class="php plain">() {</code></div><div class="line number180 index179 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'#loader_topic_with_image'</code><code class="php plain">).hide();</code></div><div class="line number181 index180 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">});</code></div><div class="line number182 index181 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">});</code></div><div class="line number183 index182 alt2">&nbsp;</div><div class="line number184 index183 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">function</code> <code class="php plain">scrollToBottom(cls) {</code></div><div class="line number185 index184 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">$(</code><code class="php string">'.'</code> <code class="php plain">+ cls).scrollTop($(</code><code class="php string">'.'</code> <code class="php plain">+ cls + </code><code class="php string">' ul li'</code><code class="php plain">).last().position().top + $(</code><code class="php string">'.'</code> <code class="php plain">+ cls + </code><code class="php string">' ul li'</code><code class="php plain">).last().height());</code></div><div class="line number186 index185 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number187 index186 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">});</code></div><div class="line number188 index187 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/script&gt;</code></div><div class="line number189 index188 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/head&gt;</code></div><div class="line number190 index189 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;body&gt;</code></div><div class="line number191 index190 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"header"</code><code class="php plain">&gt;</code></div><div class="line number192 index191 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;label </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"logo"</code><code class="php plain">&gt;ANDROIDHIVE&lt;/label&gt;</code></div><div class="line number193 index192 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;h2&gt;Google Cloud Messaging&lt;/h2&gt;</code></div><div class="line number194 index193 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;h2 </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"small"</code><code class="php plain">&gt;Sending push notifications using Android, PHP &amp; MySQL&lt;/h2&gt;</code></div><div class="line number195 index194 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/div&gt;</code></div><div class="line number196 index195 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"container_body"</code><code class="php plain">&gt;</code></div><div class="line number197 index196 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"topics"</code><code class="php plain">&gt;</code></div><div class="line number198 index197 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;h2 </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"heading"</code><code class="php plain">&gt;Download &amp; Install the GCM apk&lt;/h2&gt;</code></div><div class="line number199 index198 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">Download &amp; Install the Google Cloud Messaging &lt;a href=</code><code class="php string">"#"</code><code class="php plain">&gt;apk&lt;/a&gt; before trying the demos. &lt;br/&gt;&lt;br/&gt;Once installed, refresh this page </code></div><div class="line number200 index199 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">to see your name, email in the recipients list.</code></div><div class="line number201 index200 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/div&gt;</code></div><div class="line number202 index201 alt1">&nbsp;</div><div class="line number203 index202 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"topics"</code><code class="php plain">&gt;</code></div><div class="line number204 index203 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"separator"</code><code class="php plain">&gt;&lt;/div&gt;</code></div><div class="line number205 index204 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;h2 </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"heading"</code><code class="php plain">&gt;Sending message to a `topic`&lt;/h2&gt;</code></div><div class="line number206 index205 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">Select any of the topics below </code><code class="php keyword">and</code> <code class="php plain">send a message.&lt;br/&gt;&lt;br/&gt;</code></div><div class="line number207 index206 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"box"</code><code class="php plain">&gt;</code></div><div class="line number208 index207 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"usr_container"</code><code class="php plain">&gt;</code></div><div class="line number209 index208 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;ul id=</code><code class="php string">"topics"</code><code class="php plain">&gt;</code></div><div class="line number210 index209 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;?php</code></div><div class="line number211 index210 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$chatrooms</code> <code class="php plain">= </code><code class="php variable">$demo</code><code class="php plain">-&gt;getAllChatRooms();</code></div><div class="line number212 index211 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">foreach</code> <code class="php plain">(</code><code class="php variable">$chatrooms</code> <code class="php keyword">as</code> <code class="php variable">$key</code> <code class="php plain">=&gt; </code><code class="php variable">$chatroom</code><code class="php plain">) {</code></div><div class="line number213 index212 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$cls</code> <code class="php plain">= </code><code class="php variable">$key</code> <code class="php plain">== 0 ? </code><code class="php string">'selected'</code> <code class="php plain">: </code><code class="php string">''</code><code class="php plain">;</code></div><div class="line number214 index213 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">?&gt;</code></div><div class="line number215 index214 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;li id=</code><code class="php string">"&lt;?= $chatroom['chat_room_id'] ?&gt;"</code> <code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"&lt;?= $cls ?&gt;"</code><code class="php plain">&gt;</code></div><div class="line number216 index215 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;label&gt;&lt;?= </code><code class="php variable">$chatroom</code><code class="php plain">[</code><code class="php string">'name'</code><code class="php plain">] ?&gt;&lt;/label&gt;</code></div><div class="line number217 index216 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;span&gt;topic_&lt;?= </code><code class="php variable">$chatroom</code><code class="php plain">[</code><code class="php string">'chat_room_id'</code><code class="php plain">] ?&gt;&lt;/span&gt;</code></div><div class="line number218 index217 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/li&gt;</code></div><div class="line number219 index218 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;?php</code></div><div class="line number220 index219 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number221 index220 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">?&gt;</code></div><div class="line number222 index221 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/ul&gt;</code></div><div class="line number223 index222 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/div&gt;</code></div><div class="line number224 index223 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"msg_container msg_container_topic"</code><code class="php plain">&gt;</code></div><div class="line number225 index224 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;ul id=</code><code class="php string">"topic_messages"</code><code class="php plain">&gt;&lt;/ul&gt;</code></div><div class="line number226 index225 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/div&gt;</code></div><div class="line number227 index226 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"send_container"</code><code class="php plain">&gt;</code></div><div class="line number228 index227 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;textarea placeholder=</code><code class="php string">"Type a message here"</code> <code class="php plain">id=</code><code class="php string">"send_to_topic_message"</code><code class="php plain">&gt;&lt;/textarea&gt;</code></div><div class="line number229 index228 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;input id=</code><code class="php string">"send_to_topic"</code> <code class="php plain">type=</code><code class="php string">"button"</code> <code class="php plain">value=</code><code class="php string">"Send to Topic"</code><code class="php plain">/&gt;</code></div><div class="line number230 index229 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;img src=</code><code class="php string">"loader.gif"</code> <code class="php plain">id=</code><code class="php string">"loader_topic"</code> <code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"loader"</code><code class="php plain">/&gt;</code></div><div class="line number231 index230 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/div&gt;</code></div><div class="line number232 index231 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"clear"</code><code class="php plain">&gt;&lt;/div&gt;</code></div><div class="line number233 index232 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/div&gt;</code></div><div class="line number234 index233 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;br/&gt;</code></div><div class="line number235 index234 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"separator"</code><code class="php plain">&gt;&lt;/div&gt;</code></div><div class="line number236 index235 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;h2 </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"heading"</code><code class="php plain">&gt;Sending message to `Single User`&lt;/h2&gt;</code></div><div class="line number237 index236 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">Select your name from the below recipients </code><code class="php keyword">and</code> <code class="php plain">send a message&lt;br/&gt;&lt;br/&gt;</code></div><div class="line number238 index237 alt1">&nbsp;</div><div class="line number239 index238 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"container"</code><code class="php plain">&gt;</code></div><div class="line number240 index239 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;select </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"select_single"</code><code class="php plain">&gt;</code></div><div class="line number241 index240 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;?php</code></div><div class="line number242 index241 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$users</code> <code class="php plain">= </code><code class="php variable">$demo</code><code class="php plain">-&gt;getAllUsers();</code></div><div class="line number243 index242 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">foreach</code> <code class="php plain">(</code><code class="php variable">$users</code> <code class="php keyword">as</code> <code class="php variable">$key</code> <code class="php plain">=&gt; </code><code class="php variable">$user</code><code class="php plain">) {</code></div><div class="line number244 index243 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">?&gt;</code></div><div class="line number245 index244 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;option value=</code><code class="php string">"&lt;?= $user['user_id'] ?&gt;"</code><code class="php plain">&gt;&lt;?= </code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">'name'</code><code class="php plain">] ?&gt; (&lt;?= </code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">'email'</code><code class="php plain">] ?&gt;)&lt;/option&gt;</code></div><div class="line number246 index245 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;?php</code></div><div class="line number247 index246 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number248 index247 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">?&gt;</code></div><div class="line number249 index248 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/select&gt;&lt;br/&gt;</code></div><div class="line number250 index249 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;textarea id=</code><code class="php string">"send_to_single"</code> <code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"textarea_msg"</code> <code class="php plain">placeholder=</code><code class="php string">"Type a message"</code><code class="php plain">&gt;&lt;/textarea&gt;&lt;br/&gt;</code></div><div class="line number251 index250 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;input id=</code><code class="php string">"send_to_single_user"</code> <code class="php plain">type=</code><code class="php string">"button"</code> <code class="php plain">value=</code><code class="php string">"Send to single user"</code> <code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"btn_send"</code><code class="php plain">/&gt;</code></div><div class="line number252 index251 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;img src=</code><code class="php string">"loader.gif"</code> <code class="php plain">id=</code><code class="php string">"loader_single"</code> <code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"loader"</code><code class="php plain">/&gt;</code></div><div class="line number253 index252 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/div&gt;</code></div><div class="line number254 index253 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;br/&gt;</code></div><div class="line number255 index254 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"separator"</code><code class="php plain">&gt;&lt;/div&gt;</code></div><div class="line number256 index255 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;h2 </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"heading"</code><code class="php plain">&gt;Sending message to `Multiple Users`&lt;/h2&gt;</code></div><div class="line number257 index256 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">Select multiple recipients </code><code class="php keyword">and</code> <code class="php plain">send a message. You can </code><code class="php keyword">use</code> <code class="php plain">ctrl </code><code class="php keyword">or</code> <code class="php plain">shift to select multiple users&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;</code></div><div class="line number258 index257 alt1">&nbsp;</div><div class="line number259 index258 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"container"</code><code class="php plain">&gt;</code></div><div class="line number260 index259 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;select multiple </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"select_multiple"</code><code class="php plain">&gt;</code></div><div class="line number261 index260 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;?php</code></div><div class="line number262 index261 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">foreach</code> <code class="php plain">(</code><code class="php variable">$users</code> <code class="php keyword">as</code> <code class="php variable">$key</code> <code class="php plain">=&gt; </code><code class="php variable">$user</code><code class="php plain">) {</code></div><div class="line number263 index262 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">?&gt;</code></div><div class="line number264 index263 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;option value=</code><code class="php string">"&lt;?= $user['user_id'] ?&gt;"</code><code class="php plain">&gt;&lt;?= </code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">'name'</code><code class="php plain">] ?&gt; (&lt;?= </code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">'email'</code><code class="php plain">] ?&gt;)&lt;/option&gt;</code></div><div class="line number265 index264 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;?php</code></div><div class="line number266 index265 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">}</code></div><div class="line number267 index266 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">?&gt;</code></div><div class="line number268 index267 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/select&gt;</code></div><div class="line number269 index268 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;br/&gt;</code></div><div class="line number270 index269 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;textarea id=</code><code class="php string">"send_to_multiple"</code> <code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"textarea_msg"</code> <code class="php plain">placeholder=</code><code class="php string">"Type a message"</code><code class="php plain">&gt;&lt;/textarea&gt;&lt;br/&gt;</code></div><div class="line number271 index270 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;input id=</code><code class="php string">"send_to_multiple_users"</code> <code class="php plain">type=</code><code class="php string">"button"</code> <code class="php plain">value=</code><code class="php string">"Send to multiple users"</code> <code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"btn_send"</code><code class="php plain">/&gt;</code></div><div class="line number272 index271 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;img src=</code><code class="php string">"loader.gif"</code> <code class="php plain">id=</code><code class="php string">"loader_multiple"</code> <code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"loader"</code><code class="php plain">/&gt;</code></div><div class="line number273 index272 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/div&gt;</code></div><div class="line number274 index273 alt1">&nbsp;</div><div class="line number275 index274 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;br/&gt;</code></div><div class="line number276 index275 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"separator"</code><code class="php plain">&gt;&lt;/div&gt;</code></div><div class="line number277 index276 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;h2 </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"heading"</code><code class="php plain">&gt;Sending push notification with an `Image`&lt;/h2&gt;</code></div><div class="line number278 index277 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">A message with an image attachment will be sent to every user. You have to minimize </code><code class="php keyword">or</code> <code class="php plain">close the app in order to see</code></div><div class="line number279 index278 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">it in action.&lt;br/&gt;&lt;br/&gt;</code></div><div class="line number280 index279 alt1">&nbsp;</div><div class="line number281 index280 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;div </code><code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"container"</code><code class="php plain">&gt;</code></div><div class="line number282 index281 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;textarea id=</code><code class="php string">"send_to_multiple_with_image"</code> <code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"textarea_msg"</code> <code class="php plain">placeholder=</code><code class="php string">"Type a message"</code><code class="php plain">&gt;&lt;/textarea&gt;&lt;br/&gt;</code></div><div class="line number283 index282 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;input id=</code><code class="php string">"send_to_multiple_users_with_image"</code> <code class="php plain">type=</code><code class="php string">"button"</code> <code class="php plain">value=</code><code class="php string">"Send with image"</code> <code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"btn_send"</code><code class="php plain">/&gt;</code></div><div class="line number284 index283 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;img src=</code><code class="php string">"loader.gif"</code> <code class="php plain">id=</code><code class="php string">"loader_multiple_with_image"</code> <code class="php keyword">class</code><code class="php plain">=</code><code class="php string">"loader"</code><code class="php plain">/&gt;</code></div><div class="line number285 index284 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/div&gt;</code></div><div class="line number286 index285 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/div&gt;</code></div><div class="line number287 index286 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;br/&gt;&lt;br/&gt;</code></div><div class="line number288 index287 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;br/&gt;&lt;br/&gt;</code></div><div class="line number289 index288 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;br/&gt;&lt;br/&gt;</code></div><div class="line number290 index289 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/div&gt;</code></div><div class="line number291 index290 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php plain">&lt;/body&gt;</code></div><div class="line number292 index291 alt1"><code class="php plain">&lt;/html&gt;</code></div></div></td></tr></tbody></table></div></div>
<p><strong>5</strong>. Finally access the admin panel by going to <a rel="nofollow" href="http://localhost/gcm_chat/" target="_blank">http://localhost/gcm_chat/</a> (If your apache is running under a port, add the port number to localhost)</p>
<p>You should able to see the below admin panel which provides options to send the messages to devices from admin panel. Here the <a href="http://demo.androidhive.info/gcm_chat/" target="_blank">Live Demo</a> of the admin app.</p>
<div class="image">
<img src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/android-gcm-chat-app-admin-panel.png" alt="android-gcm-chat-app-admin-panel" width="719" height="1000" class="alignnone size-full wp-image-38998" srcset="http://www.androidhive.info/wp-content/uploads/2016/02/android-gcm-chat-app-admin-panel-216x300.png 216w, http://www.androidhive.info/wp-content/uploads/2016/02/android-gcm-chat-app-admin-panel.png 719w" sizes="(max-width: 719px) 100vw, 719px">
</div>
<p>With this we have completed 1s part of the article, but before moving to <a href="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-2" target="_blank">2nd Part</a>, quickly go through below code snippets which are very useful if you want to extend the server app functionality.</p>
<p></p>
<h2>7. Quick Code Snippets</h2>
<p></p>
<h3>Sending Push To Single User</h3>
<div><div id="highlighter_244357" class="syntaxhighlighter nogutter  php"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/gcm.php'</code><code class="php plain">;</code></div><div class="line number2 index1 alt1"><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/push.php'</code><code class="php plain">;</code></div><div class="line number3 index2 alt2"><code class="php variable">$gcm</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">GCM();</code></div><div class="line number4 index3 alt1"><code class="php variable">$push</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">Push();</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="php variable">$data</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number7 index6 alt2"><code class="php comments">// user node</code></div><div class="line number8 index7 alt1"><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'user'</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">;</code></div><div class="line number9 index8 alt2"><code class="php comments">// message node</code></div><div class="line number10 index9 alt1"><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">] = </code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">];</code></div><div class="line number11 index10 alt2"><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'image'</code><code class="php plain">] = </code><code class="php string">''</code><code class="php plain">;</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="php variable">$push</code><code class="php plain">-&gt;setTitle(</code><code class="php string">"Google Cloud Messaging"</code><code class="php plain">);</code></div><div class="line number14 index13 alt1"><code class="php variable">$push</code><code class="php plain">-&gt;setIsBackground(FALSE);</code></div><div class="line number15 index14 alt2"><code class="php variable">$push</code><code class="php plain">-&gt;setFlag(PUSH_FLAG_USER);</code></div><div class="line number16 index15 alt1"><code class="php variable">$push</code><code class="php plain">-&gt;setData(</code><code class="php variable">$data</code><code class="php plain">);</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="php comments">// Pass the receiver gcm registration token</code></div><div class="line number19 index18 alt2"><code class="php variable">$gcm_registration_id</code> <code class="php plain">= </code><code class="php string">'fnFAQ_BA7pY:APA91bFOwrCw9LHhJKatfvMx-2XA7-NdUMUMF5c9RS0....'</code><code class="php plain">;</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="php comments">// sending push message to single user</code></div><div class="line number22 index21 alt1"><code class="php variable">$gcm</code><code class="php plain">-&gt;send(</code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">'gcm_registration_id'</code><code class="php plain">], </code><code class="php variable">$push</code><code class="php plain">-&gt;getPush());</code></div></div></td></tr></tbody></table></div></div>
<p></p>
<h3>Sending Push To Multiple Users</h3>
<div><div id="highlighter_199810" class="syntaxhighlighter nogutter  php"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/gcm.php'</code><code class="php plain">;</code></div><div class="line number2 index1 alt1"><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/push.php'</code><code class="php plain">;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="php variable">$gcm</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">GCM();</code></div><div class="line number5 index4 alt2"><code class="php variable">$push</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">Push();</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="php variable">$msg</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number8 index7 alt1"><code class="php variable">$msg</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">] = </code><code class="php variable">$message</code><code class="php plain">;</code></div><div class="line number9 index8 alt2"><code class="php variable">$msg</code><code class="php plain">[</code><code class="php string">'message_id'</code><code class="php plain">] = </code><code class="php string">''</code><code class="php plain">;</code></div><div class="line number10 index9 alt1"><code class="php variable">$msg</code><code class="php plain">[</code><code class="php string">'chat_room_id'</code><code class="php plain">] = </code><code class="php string">''</code><code class="php plain">;</code></div><div class="line number11 index10 alt2"><code class="php variable">$msg</code><code class="php plain">[</code><code class="php string">'created_at'</code><code class="php plain">] = </code><code class="php functions">date</code><code class="php plain">(</code><code class="php string">'Y-m-d G:i:s'</code><code class="php plain">);</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="php variable">$data</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number14 index13 alt1"><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'user'</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">;</code></div><div class="line number15 index14 alt2"><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">] = </code><code class="php variable">$msg</code><code class="php plain">;</code></div><div class="line number16 index15 alt1"><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'image'</code><code class="php plain">] = </code><code class="php string">''</code><code class="php plain">;</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="php variable">$push</code><code class="php plain">-&gt;setTitle(</code><code class="php string">"Google Cloud Messaging"</code><code class="php plain">);</code></div><div class="line number19 index18 alt2"><code class="php variable">$push</code><code class="php plain">-&gt;setIsBackground(FALSE);</code></div><div class="line number20 index19 alt1"><code class="php variable">$push</code><code class="php plain">-&gt;setFlag(PUSH_FLAG_USER);</code></div><div class="line number21 index20 alt2"><code class="php variable">$push</code><code class="php plain">-&gt;setData(</code><code class="php variable">$data</code><code class="php plain">);</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="php comments">// Keep all the recipients gcm tokens in an array </code></div><div class="line number24 index23 alt1"><code class="php variable">$registration_ids</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">(</code><code class="php string">'fnFAQ_BA7pY:APA91bFOwrCw9LHhJKatfvMx-2XA7-NdUMUMF5c9RS0....'</code><code class="php plain">, </code><code class="php string">'fnFAQ_BA7pY:APA91bFOwrCw9LHhJKatfvMx-2XA7-NdUMUMF5c9RS0....'</code><code class="php plain">);</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="php comments">// sending push message to multiple users</code></div><div class="line number27 index26 alt2"><code class="php variable">$gcm</code><code class="php plain">-&gt;sendMultiple(</code><code class="php variable">$registration_ids</code><code class="php plain">, </code><code class="php variable">$push</code><code class="php plain">-&gt;getPush());</code></div></div></td></tr></tbody></table></div></div>
<p></p>
<h3>Sending Push To a Topic</h3>
<div><div id="highlighter_168540" class="syntaxhighlighter nogutter  php"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/gcm.php'</code><code class="php plain">;</code></div><div class="line number2 index1 alt1"><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/push.php'</code><code class="php plain">;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="php variable">$gcm</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">GCM();</code></div><div class="line number5 index4 alt2"><code class="php variable">$push</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">Push();</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="php variable">$data</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number8 index7 alt1"><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'user'</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">;</code></div><div class="line number9 index8 alt2"><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">] = </code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">];</code></div><div class="line number10 index9 alt1"><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'chat_room_id'</code><code class="php plain">] = </code><code class="php variable">$chat_room_id</code><code class="php plain">;</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="php variable">$push</code><code class="php plain">-&gt;setTitle(</code><code class="php string">"Google Cloud Messaging"</code><code class="php plain">);</code></div><div class="line number13 index12 alt2"><code class="php variable">$push</code><code class="php plain">-&gt;setIsBackground(FALSE);</code></div><div class="line number14 index13 alt1"><code class="php variable">$push</code><code class="php plain">-&gt;setFlag(PUSH_FLAG_CHATROOM);</code></div><div class="line number15 index14 alt2"><code class="php variable">$push</code><code class="php plain">-&gt;setData(</code><code class="php variable">$data</code><code class="php plain">);</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="php comments">// the topic you want to send notification</code></div><div class="line number18 index17 alt1"><code class="php variable">$topic</code> <code class="php plain">= </code><code class="php string">'your_topic_name'</code><code class="php plain">;</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="php comments">// sending push message to a topic</code></div><div class="line number21 index20 alt2"><code class="php variable">$gcm</code><code class="php plain">-&gt;sendToTopic(</code><code class="php variable">$topic</code><code class="php plain">, </code><code class="php variable">$push</code><code class="php plain">-&gt;getPush());</code></div></div></td></tr></tbody></table></div></div>
<p></p>
<h3>Sending Push with an Image</h3>
<div><div id="highlighter_594688" class="syntaxhighlighter nogutter  php"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/gcm.php'</code><code class="php plain">;</code></div><div class="line number2 index1 alt1"><code class="php keyword">require_once</code> <code class="php plain">__DIR__ . </code><code class="php string">'/../libs/gcm/push.php'</code><code class="php plain">;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="php variable">$gcm</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">GCM();</code></div><div class="line number5 index4 alt2"><code class="php variable">$push</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">Push();</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="php comments">// keep the notification image url here</code></div><div class="line number8 index7 alt1"><code class="php variable">$image</code> <code class="php plain">= </code><code class="php string">'<a href="http://api.androidhive.info/gcm/panda.jpg">http://api.androidhive.info/gcm/panda.jpg</a>'</code><code class="php plain">;</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="php variable">$data</code> <code class="php plain">= </code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number11 index10 alt2"><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'user'</code><code class="php plain">] = </code><code class="php variable">$user</code><code class="php plain">;</code></div><div class="line number12 index11 alt1"><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">] = </code><code class="php variable">$response</code><code class="php plain">[</code><code class="php string">'message'</code><code class="php plain">];</code></div><div class="line number13 index12 alt2"><code class="php variable">$data</code><code class="php plain">[</code><code class="php string">'image'</code><code class="php plain">] = </code><code class="php variable">$image</code><code class="php plain">;</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="php variable">$push</code><code class="php plain">-&gt;setTitle(</code><code class="php string">"Google Cloud Messaging"</code><code class="php plain">);</code></div><div class="line number16 index15 alt1"><code class="php variable">$push</code><code class="php plain">-&gt;setIsBackground(FALSE);</code></div><div class="line number17 index16 alt2"><code class="php variable">$push</code><code class="php plain">-&gt;setFlag(PUSH_FLAG_USER);</code></div><div class="line number18 index17 alt1"><code class="php variable">$push</code><code class="php plain">-&gt;setData(</code><code class="php variable">$data</code><code class="php plain">);</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="php variable">$gcm_registration_id</code> <code class="php plain">= </code><code class="php string">'fnFAQ_BA7pY:APA91bFOwrCw9LHhJKatfvMx-2XA7-NdUMUMF5c9RS0....'</code><code class="php plain">;</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="php comments">// sending push message to single user</code></div><div class="line number23 index22 alt2"><code class="php variable">$gcm</code><code class="php plain">-&gt;send(</code><code class="php variable">$user</code><code class="php plain">[</code><code class="php string">'gcm_registration_id'</code><code class="php plain">], </code><code class="php variable">$push</code><code class="php plain">-&gt;getPush());</code></div></div></td></tr></tbody></table></div></div>
<p>By far we have successfully built the proper REST API client and a simple admin panel. Now let’s start building the android app in <a href="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-2" target="_blank">2nd Part</a>. If you are facing any issue in this part, please comment in below discussions.</p>

<!-- Quick Adsense WordPress Plugin: http://quicksense.net/ -->
<div style="float:none;margin:10px 0 10px 0;text-align:center;">
<hr><div class="tve-leads-shortcode tve-tl-anim tl-anim-instant tve-leads-track-shortcode_39261 tve-leads-triggered"><div class="tl-style" id="tve_27_set" data-state="7"><div class="tve-leads-conversion-object" data-tl-type="shortcode_39261"><div class="tve_flt"><div class="thrv-leads-form-box tve_no_drag tve_no_icons tve_element_hover thrv_wrapper tve_editor_main_content tve_27_set tve_brdr_solid tve_blue"><div class="thrv_wrapper thrv_columns tve_clearfix" style="margin-top: 0;margin-bottom: 0;"><div class="tve_colm tve_oth"><div style="width: 198px;margin-top: 30px;" class="thrv_wrapper tve_image_caption aligncenter"><span class="tve_image_frame"><img class="tve_image" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/set_27_icon.png" style="width: 198px;"></span></div></div><div class="tve_colm tve_tth tve_lst"><div class="thrv_wrapper thrv_contentbox_shortcode" data-tve-style="5"><div class="tve_cb tve_cb5 tve_blue" style="margin: -20px -20px -20px 0;"><div class="tve_cb_cnt"><h2 style="color: #fff; font-size: 32px; margin-top: 25px;margin-bottom: 20px;" class="rft">Subscribe to our Newsletter!</h2><p style="color: #fff; font-size: 18px; margin-top: 0;">Join our 746,498 subscribers and get instant access to the latest android tutorials, app reviews and much more!</p><div data-tve-style="1" class="thrv_wrapper thrv_lead_generation tve_clearfix tve_red tve_12 thrv_lead_generation_horizontal" data-inputs-count="12" style="margin-top: 0;margin-bottom: 20px;" data-tve-version="1" data-connection="api"><div style="display: none;" class="thrv_lead_generation_code"></div><input type="hidden" class="tve-lg-err-msg" value="{&quot;email&quot;:&quot;Please enter a valid email address&quot;,&quot;phone&quot;:&quot;Please enter a valid phone number&quot;,&quot;required&quot;:&quot;Name and Email fields are required&quot;}"><div class="thrv_lead_generation_container tve_clearfix"><form action="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-1/#" method="post"><input type="hidden" class="tve-f-a-hidden" value="#"><div class="tve_lead_generated_inputs_container tve_clearfix"><div class="tve_lead_fields_overlay"></div><div class="tve_lg_input_container tve_lg_input tve_lg_2"><input type="email" data-field="email" data-required="1" data-validation="email" name="email" placeholder="Email" data-placeholder="Email" style="padding-right: 20px;"></div><input id="__tcb_lg_fc" type="hidden" name="__tcb_lg_fc" value="YToxOntzOjk6Im1haWxjaGltcCI7czoxMDoiMzU2YjVlNmVjYiI7fQ=="><input id="_asset_group" type="hidden" name="_asset_group" value=""><input id="_asset_option" type="hidden" name="_asset_option" value=""><input id="_back_url" type="hidden" name="_back_url" value="http://www.androidhive.info/subscription-successful/"><input id="_submit_option" type="hidden" name="_submit_option" value="redirect"><input id="_use_captcha" type="hidden" name="_use_captcha" value=""><input id="_captcha_theme" type="hidden" name="_captcha_theme" value="light"><input id="_captcha_type" type="hidden" name="_captcha_type" value="image"><input id="_captcha_size" type="hidden" name="_captcha_size" value="normal"><input id="mailchimp_optin" type="hidden" name="mailchimp_optin" class="tve-api-extra" value="s"><div style="display: none"></div><div class="tve_lg_input_container tve_submit_container tve_lg_submit tve_lg_2"><button type="Submit">SUBSCRIBE</button></div></div></form></div></div></div></div></div></div></div></div></div></div></div></div><hr><script id="mNCC" language="javascript">  medianet_width='600';  medianet_height= '250';  medianet_crid='473688907';  </script>  <script id="mNSC" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/nmedianet.js" language="javascript"></script><script language="javascript" type="text/javascript" id="_mN_dy_473688907" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/fcmdynet(2).js"></script><script async="" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/adsbygoogle.js"></script>
<!-- Before Comment Center -->
<ins class="adsbygoogle" style="display: inline-block; width: 300px; height: 250px;" data-ad-client="ca-pub-8479132932764602" data-ad-slot="9757174378" data-adsbygoogle-status="done"><ins id="aswift_3_expand" style="display:inline-table;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:300px;background-color:transparent"><ins id="aswift_3_anchor" style="display:block;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:300px;background-color:transparent"><iframe width="300" height="250" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_3" name="aswift_3" style="left:0;position:absolute;top:0;"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

</div>

<div style="font-size:0px;height:0px;line-height:0px;margin:0;padding:0;clear:both"></div><span id="tve_leads_end_content" style="display: block; visibility: hidden; border: 1px solid red;"></span>
<script type="text/javascript">
jQuery(document).ready(function($) {
    $.post('http://www.androidhive.info/wp-admin/admin-ajax.php', {action: 'mts_view_count', id: '38919'});
});
</script>										</div>
																				 
																			</div><!--.post-single-content-->
								</div><!--.single_post-->
																<div class="postauthor">
									<h4>About The Author</h4>
									<img alt="" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/9578184c8f454a148b0b59dd1d21dfaf" srcset="http://0.gravatar.com/avatar/9578184c8f454a148b0b59dd1d21dfaf?s=200&amp;d=mm&amp;r=g 2x" class="avatar avatar-100 photo" height="100" width="100">									<h5 class="vcard"><a href="http://www.androidhive.info/author/admin/" rel="nofollow" class="fn">Ravi Tamada</a></h5>
									<p>Ravi is hardcore Android programmer and Android programming has been his passion since he compiled his first hello-world program. Solving real problems of Android developers through tutorials has always been interesting part for him.</p>
								</div>
									
    		<!-- Start Related Posts -->
    		<div class="related-posts"><h4>Related Posts</h4><div class="clear">    			<article class="latestPost excerpt  ">
					<a href="http://www.androidhive.info/2012/01/android-login-and-registration-with-php-mysql-and-sqlite/" title="Android Login and Registration with PHP, MySQL and SQLite" rel="nofollow" id="featured-thumbnail">
					    <div class="featured-thumbnail"><img width="270" height="165" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/android-login-and-registration-screen-design-270x165.jpg" class="attachment-featured size-featured wp-post-image" alt="android login and registration screen design" title=""></div>                        					</a>
                    <header>
                        <h2 class="title front-view-title"><a href="http://www.androidhive.info/2012/01/android-login-and-registration-with-php-mysql-and-sqlite/" title="Android Login and Registration with PHP, MySQL and SQLite">Android Login and Registration with PHP, MySQL and SQLite</a></h2>
                        <div class="post-info">
                            <span class="theauthor">by <span itemprop="author"><a rel="nofollow" href="http://www.androidhive.info/author/ravi8x/" title="Posts by Ravi Tamada">Ravi Tamada</a><span class="divider1">/</span>
                       </span></span></div>
                    </header>
                </article><!--.post.excerpt-->
    			    			<article class="latestPost excerpt  ">
					<a href="http://www.androidhive.info/2013/12/android-populating-spinner-data-from-mysql-database/" title="Android Populating Spinner data from MySQL Database" rel="nofollow" id="featured-thumbnail">
					    <div class="featured-thumbnail"><img width="270" height="165" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/android-populating-spinner-from-mysql-270x165.jpg" class="attachment-featured size-featured wp-post-image" alt="android populating spinner mysql database" title=""></div>                        					</a>
                    <header>
                        <h2 class="title front-view-title"><a href="http://www.androidhive.info/2013/12/android-populating-spinner-data-from-mysql-database/" title="Android Populating Spinner data from MySQL Database">Android Populating Spinner data from MySQL Database</a></h2>
                        <div class="post-info">
                            <span class="theauthor">by <span itemprop="author"><a rel="nofollow" href="http://www.androidhive.info/author/admin/" title="Posts by Ravi Tamada">Ravi Tamada</a><span class="divider1">/</span>
                       </span></span></div>
                    </header>
                </article><!--.post.excerpt-->
    			    			<article class="latestPost excerpt  last">
					<a href="http://www.androidhive.info/2014/10/android-building-group-chat-app-using-sockets-part-2/" title="Android Building Group Chat App using Sockets – Part 2" rel="nofollow" id="featured-thumbnail">
					    <div class="featured-thumbnail"><img width="270" height="165" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/android-chat-app-part-2-270x165.png" class="attachment-featured size-featured wp-post-image" alt="android building chat app" title=""></div>                        					</a>
                    <header>
                        <h2 class="title front-view-title"><a href="http://www.androidhive.info/2014/10/android-building-group-chat-app-using-sockets-part-2/" title="Android Building Group Chat App using Sockets – Part 2">Android Building Group Chat App using Sockets – Part 2</a></h2>
                        <div class="post-info">
                            <span class="theauthor">by <span itemprop="author"><a rel="nofollow" href="http://www.androidhive.info/author/admin/" title="Posts by Ravi Tamada">Ravi Tamada</a><span class="divider1">/</span>
                       </span></span></div>
                    </header>
                </article><!--.post.excerpt-->
    			    			<article class="latestPost excerpt  ">
					<a href="http://www.androidhive.info/2012/01/android-json-parsing-tutorial/" title="Android JSON Parsing Tutorial" rel="nofollow" id="featured-thumbnail">
					    <div class="featured-thumbnail"><img width="270" height="165" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/banner_json_parsing-270x165.png" class="attachment-featured size-featured wp-post-image" alt="android json parsing" title=""></div>                        					</a>
                    <header>
                        <h2 class="title front-view-title"><a href="http://www.androidhive.info/2012/01/android-json-parsing-tutorial/" title="Android JSON Parsing Tutorial">Android JSON Parsing Tutorial</a></h2>
                        <div class="post-info">
                            <span class="theauthor">by <span itemprop="author"><a rel="nofollow" href="http://www.androidhive.info/author/ravi8x/" title="Posts by Ravi Tamada">Ravi Tamada</a><span class="divider1">/</span>
                       </span></span></div>
                    </header>
                </article><!--.post.excerpt-->
    			</div></div>    		<!-- .related-posts -->
    					</div><!--.g post-->
				<div id="disqus_thread" data-disqus-shortname="androidhive"><iframe id="dsq-app2" name="dsq-app2" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/saved_resource.html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 6573px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe><iframe id="indicator-north" name="indicator-north" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width: 801px !important; border: none !important; overflow: hidden !important; top: 0px !important; min-width: 801px !important; max-width: 801px !important; position: fixed !important; z-index: 2147483646 !important; height: 29px !important; min-height: 29px !important; max-height: 29px !important; display: none !important;"></iframe><iframe id="indicator-south" name="indicator-south" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" style="width: 801px !important; border: none !important; overflow: hidden !important; bottom: 0px !important; min-width: 801px !important; max-width: 801px !important; position: fixed !important; z-index: 2147483646 !important; height: 29px !important; min-height: 29px !important; max-height: 29px !important; display: none !important;"></iframe></div>
					</div>
	</article>
	<aside id="sidebar" class="sidebar c-4-12 " role="complementary" itemscope="" itemtype="http://schema.org/WPSideBar">
	<div id="search-2" class="widget widget_search"><h3 class="widget-title">SEARCH HERE</h3><form method="get" id="searchform" class="search-form" action="http://www.androidhive.info/" _lpchecked="1">
	<fieldset>
		<input type="text" name="s" id="s" value="" placeholder="Search the site">
		<button id="search-image" class="sbutton" type="submit" value="">
    		<i class="fa fa-search"></i>
    	</button>
	</fieldset>
</form>
</div><div id="text-9" class="widget widget_text">			<div class="textwidget"><a href="http://www.androidhive.info/reviews"><img src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/reviews_banner.jpg"></a></div>
		</div><div id="text-6" class="widget widget_text"><h3 class="widget-title">WE’RE SOCIAL</h3>			<div class="textwidget"><div class="fb-page fb_iframe_widget" data-href="https://www.facebook.com/AndroidHive/" data-width="340" data-hide-cover="false" data-show-facepile="true" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=&amp;container_width=300&amp;hide_cover=false&amp;href=https%3A%2F%2Fwww.facebook.com%2FAndroidHive%2F&amp;locale=en_US&amp;sdk=joey&amp;show_facepile=true&amp;width=340"><span style="vertical-align: bottom; width: 300px; height: 214px;"><iframe name="f28e55ead00d44" width="340px" height="1000px" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:page Facebook Social Plugin" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/page.html" style="border: none; visibility: visible; width: 300px; height: 214px;" class=""></iframe></span></div></div>
		</div><div id="text-8" class="widget widget_text">			<div class="textwidget"><div class="tve-leads-shortcode tve-tl-anim tl-anim-instant tve-leads-track-shortcode_39260 tve-leads-triggered"><div class="tl-style" id="tve_36_set" data-state="6"><div class="tve-leads-conversion-object" data-tl-type="shortcode_39260"><div class="tve_flt"><div class="thrv-leads-form-box tve_no_drag tve_no_icons tve_element_hover thrv_wrapper tve_editor_main_content tve_36_set tve_brdr_solid tve_blue"><h2 class="tve_p_center" style="font-size: 17px;">Subscribe to Newsletter</h2><p class="tve_p_center" style="font-size: 14px;">Join our 746,498 subscribers and get access to the latest android tutorials, freebies, scripts and much more!</p><div class="thrv_wrapper thrv_lead_generation tve_clearfix tve_red tve_12 thrv_lead_generation_vertical" data-tve-style="1" data-tve-version="1" data-inputs-count="12" data-connection="api"><input type="hidden" class="tve-lg-err-msg" value="{&quot;email&quot;:&quot;Please enter a valid email address&quot;,&quot;phone&quot;:&quot;Please enter a valid phone number&quot;,&quot;required&quot;:&quot;Highlighted fields are required&quot;}"><div class="thrv_lead_generation_code" style="display: none;"></div><div class="thrv_lead_generation_container tve_clearfix"><form action="http://www.androidhive.info/2016/02/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-1/#" method="post"><input type="hidden" class="tve-f-a-hidden" value="#"><div class="tve_lead_generated_inputs_container tve_clearfix"><div class="tve_lead_fields_overlay"></div><div class="tve_lg_input_container tve_lg_input tve_lg_2"><input type="email" data-field="email" data-required="1" data-validation="email" name="email" placeholder="Email" data-placeholder="Email" style="padding-right: 20px;"></div><input id="__tcb_lg_fc" type="hidden" name="__tcb_lg_fc" value="YToxOntzOjk6Im1haWxjaGltcCI7czoxMDoiMzU2YjVlNmVjYiI7fQ=="><input id="_asset_group" type="hidden" name="_asset_group" value=""><input id="_asset_option" type="hidden" name="_asset_option" value=""><input id="_back_url" type="hidden" name="_back_url" value="http://www.androidhive.info/subscription-successful/"><input id="_submit_option" type="hidden" name="_submit_option" value="redirect"><input id="_use_captcha" type="hidden" name="_use_captcha" value=""><input id="_captcha_theme" type="hidden" name="_captcha_theme" value="light"><input id="_captcha_type" type="hidden" name="_captcha_type" value="image"><input id="_captcha_size" type="hidden" name="_captcha_size" value="normal"><input id="mailchimp_optin" type="hidden" name="mailchimp_optin" class="tve-api-extra" value="s"><div style="display: none"></div><div class="tve_lg_input_container tve_submit_container tve_lg_submit tve_lg_2" tve-data-style="1"><button type="Submit">Sign Up</button></div></div></form></div></div><p class="tve_p_center" style="font-size: 14px;">We strictly care about your privacy!</p></div></div></div></div></div></div>
		</div><div id="views-2" class="widget widget_views"><h3 class="widget-title">POPULAR ANDROID TUTORIALS</h3><ul>
<li class="postviews"><a href="http://www.androidhive.info/2011/11/android-sqlite-database-tutorial/" title="Android SQLite Database Tutorial">Android SQLite Database Tutorial - 1,365,649 views</a> </li><li class="postviews"><a href="http://www.androidhive.info/2012/05/how-to-connect-android-with-php-mysql/" title="How to connect Android with PHP, MySQL">How to connect Android with PHP, MySQL - 1,341,801 views</a> </li><li class="postviews"><a href="http://www.androidhive.info/2012/01/android-json-parsing-tutorial/" title="Android JSON Parsing Tutorial">Android JSON Parsing Tutorial - 1,198,679 views</a> </li><li class="postviews"><a href="http://www.androidhive.info/2012/10/android-push-notifications-using-google-cloud-messaging-gcm-php-and-mysql/" title="Android Push Notifications using Google Cloud Messaging (GCM), PHP and MySQL">Android Push Notifications using Google Cloud Messaging (GCM), PHP and MySQL - 1,127,263 views</a> </li><li class="postviews"><a href="http://www.androidhive.info/2013/11/android-sliding-menu-using-navigation-drawer/" title="Android Sliding Menu using Navigation Drawer">Android Sliding Menu using Navigation Drawer - 1,028,444 views</a> </li><li class="postviews"><a href="http://www.androidhive.info/2012/02/android-custom-listview-with-image-and-text/" title="Android Custom ListView with Image and Text">Android Custom ListView with Image and Text - 947,732 views</a> </li><li class="postviews"><a href="http://www.androidhive.info/2012/01/android-login-and-registration-with-php-mysql-and-sqlite/" title="Android Login and Registration with PHP, MySQL and SQLite">Android Login and Registration with PHP, MySQL and SQLite - 899,207 views</a> </li><li class="postviews"><a href="http://www.androidhive.info/2012/07/android-gps-location-manager-tutorial/" title="Android GPS, Location Manager Tutorial">Android GPS, Location Manager Tutorial - 685,600 views</a> </li><li class="postviews"><a href="http://www.androidhive.info/2013/10/android-tab-layout-with-swipeable-views-1/" title="Android Tab Layout with Swipeable Views">Android Tab Layout with Swipeable Views - 654,365 views</a> </li><li class="postviews"><a href="http://www.androidhive.info/2011/08/android-tab-layout-tutorial/" title="Android Tab Layout Tutorial">Android Tab Layout Tutorial - 579,924 views</a> </li></ul>
</div></aside><!--#sidebar-->
	</div><!--#page-->
	<footer id="site-footer" role="contentinfo" itemscope="" itemtype="http://schema.org/WPFooter">
		<div class="container">
            
                            <div class="footer-widgets first-footer-widgets widgets-num-3">
                                    <div class="f-widget f-widget-1">
                        <div id="nav_menu-2" class="widget widget_nav_menu toggle-menu"><h3 class="widget-title">QUICK CONTACT</h3><div class="menu-quick-contact-container"><ul id="menu-quick-contact" class="menu"><li id="menu-item-39273" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-39273"><a href="http://www.androidhive.info/advertise-with-us/">Advertise with us</a></li>
<li id="menu-item-39244" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-39244"><a href="http://www.androidhive.info/privacy-policy/">Privacy Policy</a></li>
<li id="menu-item-39245" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-39245"><a href="http://www.androidhive.info/terms-of-service/">Terms of Service</a></li>
<li id="menu-item-39266" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-39266"><a href="http://www.androidhive.info/sitemap/">Sitemap</a></li>
</ul></div></div>                    </div>
                                        <div class="f-widget f-widget-2">
                                            </div>
                                        <div class="f-widget last f-widget-3">
                        <div id="text-7" class="widget widget_text"><h3 class="widget-title">ABOUT ANDROIDHIVE</h3>			<div class="textwidget">AndroidHive is beginner's paradise for android tutorials, tips &amp; tricks, games, app reviews, hacks and super cool advanced topics.</div>
		</div>                    </div>
                                    </div><!--.first-footer-widgets-->
            
            <div class="copyrights">
				<!--start copyrights-->
<div class="row" id="copyright-note">
<span>Copyright © 2016 Droid5 Informatics Pvt Ltd.</span>
<div class="to-top"></div>
</div>
<!--end copyrights-->
			</div> 
		</div><!--.container-->
	</footer><!--#site-footer-->
</div><!--.main-container-->
<!--start footer code-->
<div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_http" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_http" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/xd_arbiter.html" style="border: none;"></iframe><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/xd_arbiter(1).html" style="border: none;"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&version=v2.6";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<script id="dsq-count-scr" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/count.js" async=""></script>
<script>
/**************************************************************/
/*AM22 Named Function to load Disqus - START*/
jQuery(document).ready(function(){
var disqus_identifier = window.location.url; //Use current page URL as Disqus_URL_Identifier. You can change it as per your requirement.
var ds_loaded = false; //To track loading only once on a page.
function loadDisqus()
{
    var disqus_div = jQuery("#disqus_thread"); //The ID of the Disqus DIV tag
    var top = disqus_div.offset().top;
    var disqus_data = disqus_div.data();
    if ( !ds_loaded && jQuery(window).scrollTop() + jQuery(window).height() > top ) 
    {
        ds_loaded = true;
        for (var key in disqus_data) 
        {
            if (key.substr(0,6) == 'disqus') 
            {
                window['disqus_' + key.replace('disqus','').toLowerCase()] = disqus_data[key];
            }
        }
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = 'http://' + window.disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }  
}
/*AM22 Named Function to load Disqus - END*/
/*AM22 Disqus lazy load - START*/
jQuery(function () 
{
    var disqus_div = jQuery("#disqus_thread");
    if (disqus_div.size() > 0) 
    {
        jQuery(window).scroll(loadDisqus);      
    }  
}
);
/*AM22 Disqus lazy load - END*/
});
</script><!--end footer code-->
<div id="tve_notification_box"></div><script type="text/javascript" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/shCore.js"></script>
<script type="text/javascript" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/shBrushSql.js"></script>
<script type="text/javascript" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/shBrushPhp.js"></script>
<script type="text/javascript" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/shBrushCss.js"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://www.androidhive.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://www.androidhive.info/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<link rel="stylesheet" id="tve_style_family_tve_flt-css" href="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/thrive_flat.css" type="text/css" media="all">
<link rel="stylesheet" id="tve_leads_forms-css" href="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/frontend.css" type="text/css" media="all">
<link rel="stylesheet" id="tve-leads-font-273e5a04440549b4af13b50a0afd3966-css" href="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/css(1)" type="text/css" media="all">
<link rel="stylesheet" id="tve-leads-27_set-css" href="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/27_set.css" type="text/css" media="all">
<link rel="stylesheet" id="tve-leads-font-9062833c9baa57b288ba47a7993dc1c0-css" href="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/css(2)" type="text/css" media="all">
<link rel="stylesheet" id="tve-leads-36_set-css" href="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/36_set.css" type="text/css" media="all">
<script type="text/javascript">
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":"http:\/\/www.androidhive.info\/wp-admin\/admin-ajax.php","post_id":"38919"};
/* ]]> */
</script>
<script type="text/javascript" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/postviews-cache.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var tve_dash_front = {"ajaxurl":"http:\/\/www.androidhive.info\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/frontend.min.js"></script>
<script type="text/javascript" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/wp-embed.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var tve_frontend_options = {"is_editor_page":"","page_events":[],"is_single":"1","ajaxurl":"http:\/\/www.androidhive.info\/wp-admin\/admin-ajax.php","social_fb_app_id":""};
/* ]]> */
</script>
<script type="text/javascript" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/thrive_content_builder_frontend.min.js"></script>
<script type="text/javascript" src="./Android Building Realtime Chat App using GCM, PHP &amp; MySQL - Part 1_files/frontend.min(1).js"></script>
<script type="text/javascript">/*<![CDATA[*/var TL_Const={"security":"0f78a5b8ba","ajax_url":"\/\/www.androidhive.info\/wp-admin\/admin-ajax.php","forms":{"shortcode_39261":{"_key":"7","trigger":"page_load","trigger_config":{},"form_type_id":"39261","main_group_id":"39261","active_test_id":""},"shortcode_39260":{"_key":"6","trigger":"page_load","trigger_config":{},"form_type_id":"39260","main_group_id":"39260","active_test_id":""}},"action_conversion":"tve_leads_ajax_conversion","action_impression":"tve_leads_ajax_impression","ajax_load":0,"shortcode_ids":["39261","39260"],"custom_post_data":{"get_data":{"q":"\/2016\/02\/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-1\/"},"http_referrer":"http:\/\/www.androidhive.info\/2016\/02\/android-push-notifications-using-gcm-php-mysql-realtime-chat-app-part-1\/"},"current_screen":{"screen_type":4,"screen_id":38919},"ignored_fields":["email","_captcha_size","_captcha_theme","_captcha_type","_submit_option","_use_captcha","g-recaptcha-response","__tcb_lg_fc","_back_url","_submit_option","url","_asset_group","_asset_option","mailchimp_optin"]}/*]]> */</script><script type="text/javascript">var TL_Front = TL_Front || {}; TL_Front.impressions_data = TL_Front.impressions_data || {};TL_Front.impressions_data.shortcode_39261 = {"group_id":"39261","form_type_id":"39261","variation_key":"7","active_test_id":null,"output_js":true};TL_Front.impressions_data.shortcode_39260 = {"group_id":"39260","form_type_id":"39260","variation_key":"6","active_test_id":null,"output_js":true};</script><script type="text/javascript">
	(function ($) {
	$(function () {
		var event_data = {"form_id":"tve-leads-track-shortcode_39261","form_type":"shortcode"};
		event_data.source = 'page_load';
		setTimeout(function () {
			ThriveGlobal.$j(TL_Front).trigger('showform.thriveleads', event_data);
			}, 200);
		});
	})
(ThriveGlobal.$j);
</script><script type="text/javascript">
	(function ($) {
	$(function () {
		var event_data = {"form_id":"tve-leads-track-shortcode_39260","form_type":"shortcode"};
		event_data.source = 'page_load';
		setTimeout(function () {
			ThriveGlobal.$j(TL_Front).trigger('showform.thriveleads', event_data);
			}, 200);
		});
	})
(ThriveGlobal.$j);
</script>
</body></html>